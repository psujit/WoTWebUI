webpackJsonp([2],{16:function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},17:function(module,exports,__webpack_require__){(function(global){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,require,require,_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){if("object"===_typeof(exports)&&void 0!==module)module.exports=e();else{__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_FACTORY__=e,void 0!==(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof __WEBPACK_AMD_DEFINE_FACTORY__?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}}(function(){var define,module,exports;return function e(t,n,r){function o(s,a){if(!n[s]){if(!t[s]){var p="function"==typeof require&&require;if(!a&&p)return require(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[s]={exports:{}};t[s][0].call(u.exports,function(e){var n=t[s][1][e];return o(n||e)},u,u.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){(function(e){!function(r){function o(e){throw new RangeError(I[e])}function i(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function s(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(S,"."),r+i(e.split("."),t).join(".")}function a(e){for(var t,n,r=[],o=0,i=e.length;o<i;)t=e.charCodeAt(o++),t>=55296&&t<=56319&&o<i?(n=e.charCodeAt(o++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--)):r.push(t);return r}function p(e){return i(e,function(e){var t="";return e>65535&&(e-=65536,t+=q(e>>>10&1023|55296),e=56320|1023&e),t+=q(e)}).join("")}function c(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:w}function u(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function f(e,t,n){var r=0;for(e=n?x(e/A):e>>1,e+=x(e/t);e>P*O>>1;r+=w)e=x(e/P);return x(r+(P+1)*e/(e+E))}function l(e){var t,n,r,i,s,a,u,l,h,y,d=[],m=e.length,b=0,v=H,g=M;for(n=e.lastIndexOf(D),n<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&o("not-basic"),d.push(e.charCodeAt(r));for(i=n>0?n+1:0;i<m;){for(s=b,a=1,u=w;i>=m&&o("invalid-input"),l=c(e.charCodeAt(i++)),(l>=w||l>x((_-b)/a))&&o("overflow"),b+=l*a,h=u<=g?j:u>=g+O?O:u-g,!(l<h);u+=w)y=w-h,a>x(_/y)&&o("overflow"),a*=y;t=d.length+1,g=f(b-s,t,0==s),x(b/t)>_-v&&o("overflow"),v+=x(b/t),b%=t,d.splice(b++,0,v)}return p(d)}function h(e){var t,n,r,i,s,p,c,l,h,y,d,m,b,v,g,T=[];for(e=a(e),m=e.length,t=H,n=0,s=M,p=0;p<m;++p)(d=e[p])<128&&T.push(q(d));for(r=i=T.length,i&&T.push(D);r<m;){for(c=_,p=0;p<m;++p)(d=e[p])>=t&&d<c&&(c=d);for(b=r+1,c-t>x((_-n)/b)&&o("overflow"),n+=(c-t)*b,t=c,p=0;p<m;++p)if(d=e[p],d<t&&++n>_&&o("overflow"),d==t){for(l=n,h=w;y=h<=s?j:h>=s+O?O:h-s,!(l<y);h+=w)g=l-y,v=w-y,T.push(q(u(y+g%v,0))),l=x(g/v);T.push(q(u(l,0))),s=f(n,b,r==i),n=0,++r}++n,++t}return T.join("")}function y(e){return s(e,function(e){return N.test(e)?l(e.slice(4).toLowerCase()):e})}function d(e){return s(e,function(e){return J.test(e)?"xn--"+h(e):e})}var m="object"==(void 0===n?"undefined":_typeof(n))&&n&&!n.nodeType&&n,b="object"==(void 0===t?"undefined":_typeof(t))&&t&&!t.nodeType&&t,v="object"==(void 0===e?"undefined":_typeof(e))&&e;v.global!==v&&v.window!==v&&v.self!==v||(r=v);var g,T,_=2147483647,w=36,j=1,O=26,E=38,A=700,M=72,H=128,D="-",N=/^xn--/,J=/[^\x20-\x7E]/,S=/[\x2E\u3002\uFF0E\uFF61]/g,I={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},P=w-j,x=Math.floor,q=String.fromCharCode;if(g={version:"1.4.1",ucs2:{decode:a,encode:p},decode:l,encode:h,toASCII:d,toUnicode:y},"function"==typeof define&&"object"==_typeof(define.amd)&&define.amd)define("punycode",function(){return g});else if(m&&b)if(t.exports==m)b.exports=g;else for(T in g)g.hasOwnProperty(T)&&(m[T]=g[T]);else r.punycode=g}(this)}).call(this,void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,n,i){t=t||"&",n=n||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t);var p=1e3;i&&"number"==typeof i.maxKeys&&(p=i.maxKeys);var c=e.length;p>0&&c>p&&(c=p);for(var u=0;u<c;++u){var f,l,h,y,d=e[u].replace(a,"%20"),m=d.indexOf(n);m>=0?(f=d.substr(0,m),l=d.substr(m+1)):(f=d,l=""),h=decodeURIComponent(f),y=decodeURIComponent(l),r(s,h)?o(s[h])?s[h].push(y):s[h]=[s[h],y]:s[h]=y}return s};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],3:[function(e,t,n){"use strict";function r(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var o=function(e){switch(void 0===e?"undefined":_typeof(e)){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"===(void 0===e?"undefined":_typeof(e))?r(s(e),function(s){var a=encodeURIComponent(o(s))+n;return i(e[s])?r(e[s],function(e){return a+encodeURIComponent(o(e))}).join(t):a+encodeURIComponent(o(e[s]))}).join(t):a?encodeURIComponent(o(a))+n+encodeURIComponent(o(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},{}],4:[function(e,t,n){"use strict";n.decode=n.parse=e("./decode"),n.encode=n.stringify=e("./encode")},{"./decode":2,"./encode":3}],5:[function(e,t,n){"use strict";function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(e,t,n){if(e&&c.isObject(e)&&e instanceof r)return e;var o=new r;return o.parse(e,t,n),o}function i(e){return c.isString(e)&&(e=o(e)),e instanceof r?e.format():r.prototype.format.call(e)}function s(e,t){return o(e,!1,!0).resolve(t)}function a(e,t){return e?o(e,!1,!0).resolveObject(t):t}var p=e("punycode"),c=e("./util");n.parse=o,n.resolve=s,n.resolveObject=a,n.format=i,n.Url=r;var u=/^([a-z0-9.+-]+:)/i,f=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,h=["<",">",'"',"`"," ","\r","\n","\t"],y=["{","}","|","\\","^","`"].concat(h),d=["'"].concat(y),m=["%","/","?",";","#"].concat(d),b=["/","?","#"],v=/^[+a-z0-9A-Z_-]{0,63}$/,g=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,T={javascript:!0,"javascript:":!0},_={javascript:!0,"javascript:":!0},w={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},j=e("querystring");r.prototype.parse=function(e,t,n){if(!c.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+(void 0===e?"undefined":_typeof(e)));var r=e.indexOf("?"),o=-1!==r&&r<e.indexOf("#")?"?":"#",i=e.split(o),s=/\\/g;i[0]=i[0].replace(s,"/"),e=i.join(o);var a=e;if(a=a.trim(),!n&&1===e.split("#").length){var f=l.exec(a);if(f)return this.path=a,this.href=a,this.pathname=f[1],f[2]?(this.search=f[2],this.query=t?j.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var h=u.exec(a);if(h){h=h[0];var y=h.toLowerCase();this.protocol=y,a=a.substr(h.length)}if(n||h||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var O="//"===a.substr(0,2);!O||h&&_[h]||(a=a.substr(2),this.slashes=!0)}if(!_[h]&&(O||h&&!w[h])){for(var E=-1,A=0;A<b.length;A++){var M=a.indexOf(b[A]);-1!==M&&(-1===E||M<E)&&(E=M)}var H,D;D=-1===E?a.lastIndexOf("@"):a.lastIndexOf("@",E),-1!==D&&(H=a.slice(0,D),a=a.slice(D+1),this.auth=decodeURIComponent(H)),E=-1;for(var A=0;A<m.length;A++){var M=a.indexOf(m[A]);-1!==M&&(-1===E||M<E)&&(E=M)}-1===E&&(E=a.length),this.host=a.slice(0,E),a=a.slice(E),this.parseHost(),this.hostname=this.hostname||"";var N="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!N)for(var J=this.hostname.split(/\./),A=0,S=J.length;A<S;A++){var I=J[A];if(I&&!I.match(v)){for(var P="",x=0,q=I.length;x<q;x++)I.charCodeAt(x)>127?P+="x":P+=I[x];if(!P.match(v)){var C=J.slice(0,A),k=J.slice(A+1),K=I.match(g);K&&(C.push(K[1]),k.unshift(K[2])),k.length&&(a="/"+k.join(".")+a),this.hostname=C.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),N||(this.hostname=p.toASCII(this.hostname));var F=this.port?":"+this.port:"",R=this.hostname||"";this.host=R+F,this.href+=this.host,N&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!T[y])for(var A=0,S=d.length;A<S;A++){var L=d[A];if(-1!==a.indexOf(L)){var Y=encodeURIComponent(L);Y===L&&(Y=escape(L)),a=a.split(L).join(Y)}}var U=a.indexOf("#");-1!==U&&(this.hash=a.substr(U),a=a.slice(0,U));var z=a.indexOf("?");if(-1!==z?(this.search=a.substr(z),this.query=a.substr(z+1),t&&(this.query=j.parse(this.query)),a=a.slice(0,z)):t&&(this.search="",this.query={}),a&&(this.pathname=a),w[y]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var F=this.pathname||"",B=this.search||"";this.path=F+B}return this.href=this.format(),this},r.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,i="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&c.isObject(this.query)&&Object.keys(this.query).length&&(i=j.stringify(this.query));var s=this.search||i&&"?"+i||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||w[t])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),s=s.replace("#","%23"),t+o+n+s+r},r.prototype.resolve=function(e){return this.resolveObject(o(e,!1,!0)).format()},r.prototype.resolveObject=function(e){if(c.isString(e)){var t=new r;t.parse(e,!1,!0),e=t}for(var n=new r,o=Object.keys(this),i=0;i<o.length;i++){var s=o[i];n[s]=this[s]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var a=Object.keys(e),p=0;p<a.length;p++){var u=a[p];"protocol"!==u&&(n[u]=e[u])}return w[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!w[e.protocol]){for(var f=Object.keys(e),l=0;l<f.length;l++){var h=f[l];n[h]=e[h]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||_[e.protocol])n.pathname=e.pathname;else{for(var y=(e.pathname||"").split("/");y.length&&!(e.host=y.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==y[0]&&y.unshift(""),y.length<2&&y.unshift(""),n.pathname=y.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var d=n.pathname||"",m=n.search||"";n.path=d+m}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var b=n.pathname&&"/"===n.pathname.charAt(0),v=e.host||e.pathname&&"/"===e.pathname.charAt(0),g=v||b||n.host&&e.pathname,T=g,j=n.pathname&&n.pathname.split("/")||[],y=e.pathname&&e.pathname.split("/")||[],O=n.protocol&&!w[n.protocol];if(O&&(n.hostname="",n.port=null,n.host&&(""===j[0]?j[0]=n.host:j.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===y[0]?y[0]=e.host:y.unshift(e.host)),e.host=null),g=g&&(""===y[0]||""===j[0])),v)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,j=y;else if(y.length)j||(j=[]),j.pop(),j=j.concat(y),n.search=e.search,n.query=e.query;else if(!c.isNullOrUndefined(e.search)){if(O){n.hostname=n.host=j.shift();var E=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");E&&(n.auth=E.shift(),n.host=n.hostname=E.shift())}return n.search=e.search,n.query=e.query,c.isNull(n.pathname)&&c.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!j.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var A=j.slice(-1)[0],M=(n.host||e.host||j.length>1)&&("."===A||".."===A)||""===A,H=0,D=j.length;D>=0;D--)A=j[D],"."===A?j.splice(D,1):".."===A?(j.splice(D,1),H++):H&&(j.splice(D,1),H--);if(!g&&!T)for(;H--;H)j.unshift("..");!g||""===j[0]||j[0]&&"/"===j[0].charAt(0)||j.unshift(""),M&&"/"!==j.join("/").substr(-1)&&j.push("");var N=""===j[0]||j[0]&&"/"===j[0].charAt(0);if(O){n.hostname=n.host=N?"":j.length?j.shift():"";var E=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");E&&(n.auth=E.shift(),n.host=n.hostname=E.shift())}return g=g||n.host&&j.length,g&&!N&&j.unshift(""),j.length?n.pathname=j.join("/"):(n.pathname=null,n.path=null),c.isNull(n.pathname)&&c.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var e=this.host,t=f.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{"./util":6,punycode:1,querystring:4}],6:[function(e,t,n){"use strict";t.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"===(void 0===e?"undefined":_typeof(e))&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},{}],7:[function(e,t,n){"use strict";function r(e){return o(p.TypedJSON.stringify(e,{enableTypeHints:!1}))}function o(t){console.log("parseTDString() parsing\n```\n"+t+"\n```");var n=p.TypedJSON.parse(t,s.default);console.log("parseTDString() found "+n.interaction.length+" Interaction"+(1===n.interaction.length?"":"s"));for(var r=0,o=n.interaction;r<o.length;r++){var i=o[r];if(-1!==i.semanticTypes.indexOf(a.InteractionPattern.Property.toString())?(console.log(" * Property '"+i.name+"'"),i.pattern=a.InteractionPattern.Property):-1!==i.semanticTypes.indexOf(a.InteractionPattern.Action.toString())?(console.log(" * Action '"+i.name+"'"),i.pattern=a.InteractionPattern.Action):-1!==i.semanticTypes.indexOf(a.InteractionPattern.Event.toString())?(console.log(" * Event '"+i.name+"'"),i.pattern=a.InteractionPattern.Event):console.error("parseTDString() found unknown Interaction pattern '"+i.semanticTypes+"'"),void 0!==n.base){console.log("parseTDString() applying base '"+n.base+"' to href '"+i.link[0].href+"'");var c=i.link[0].href,u=e("url"),f=n.base.indexOf(":"),l=n.base.substr(0,f+1),h=n.base.replace(l,"http:");h=u.resolve(h,c),h=h.replace("http:",l),i.link[0].href=h}}return n}function i(e){p.TypedJSON.config({enableTypeHints:!1});var t=p.TypedJSON.stringify(e),n=JSON.parse(t);null!==e.base&&void 0!==e.base||delete n.base;for(var r=0,o=n.interaction;r<o.length;r++){var i=o[r];if(null===i.inputData&&delete i.inputData,null===i.outputData&&delete i.outputData,null===i.writable&&delete i.writable,i.outputData&&void 0!==i.outputData.required){console.log("### HOTFIX for TypedJSON ###");var s=[];for(var a in i.outputData.required)s.push(i.outputData.required[a]);i.outputData.required=s}}return t=JSON.stringify(n),console.log("serializeTD() produced\n```\n"+t+"\n```"),t}Object.defineProperty(n,"__esModule",{value:!0});var s=e("./thing-description"),a=e("./thing-description"),p=e("typedjson-npm");n.parseTDObject=r,n.parseTDString=o,n.serializeTD=i},{"./thing-description":8,"typedjson-npm":9,url:5}],8:[function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":_typeof(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var o=e("typedjson-npm");!function(e){e[e.Property="Property"]="Property",e[e.Action="Action"]="Action",e[e.Event="Event"]="Event"}(n.InteractionPattern||(n.InteractionPattern={}));var i=function(){function e(){}return e}();r([o.JsonMember({isRequired:!0,type:String})],i.prototype,"href",void 0),r([o.JsonMember({isRequired:!0,type:String})],i.prototype,"mediaType",void 0),i=r([o.JsonObject()],i),n.InteractionLink=i;var s=function(){function e(){this.semanticTypes=[],this.link=[]}return e}();r([o.JsonMember({name:"@type",isRequired:!0,elements:String})],s.prototype,"semanticTypes",void 0),r([o.JsonMember({isRequired:!0,type:String})],s.prototype,"name",void 0),r([o.JsonMember({isRequired:!0,elements:i})],s.prototype,"link",void 0),r([o.JsonMember({type:Boolean})],s.prototype,"writable",void 0),r([o.JsonMember({type:Object})],s.prototype,"inputData",void 0),r([o.JsonMember({type:Object})],s.prototype,"outputData",void 0),s=r([o.JsonObject({knownTypes:[i]})],s),n.Interaction=s;var a=function(){function e(){this.context=["http://w3c.github.io/wot/w3c-wot-td-context.jsonld"],this.semanticType=["Thing"],this.interaction=[]}return e}();r([o.JsonMember({name:"@type",elements:String})],a.prototype,"semanticType",void 0),r([o.JsonMember({isRequired:!0,type:String})],a.prototype,"name",void 0),r([o.JsonMember({type:String})],a.prototype,"base",void 0),r([o.JsonMember({isRequired:!0,elements:s})],a.prototype,"interaction",void 0),r([o.JsonMember({name:"@context",elements:String})],a.prototype,"context",void 0),a=r([o.JsonObject({knownTypes:[s]})],a),n.default=a},{"typedjson-npm":9}],9:[function(require,module,exports){/*!
            TypedJSON v0.2.0 - https://github.com/JohnWhiteTB/TypedJSON
            
            Typed JSON parsing and serializing that preserves type information. Parse JSON into actual class instances. Recommended (but not required)
            to be used with reflect-metadata (global installation): https://github.com/rbuckton/ReflectDecorators.
            
            
            The MIT License (MIT)
            Copyright (c) 2016 John White
            
            Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the
            "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish,
            distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to
            the following conditions:
            
            The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
            
            THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
            MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
            CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
            SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
            */
!function(e){if("object"===(void 0===module?"undefined":_typeof(module))&&"object"===_typeof(module.exports)){var t=e(require,exports);void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define(["require","exports"],e)}(function(require,exports){"use strict";function JsonObject(e){var t;t="function"==typeof e?{}:e||{};var n=t.initializer,r=t.serializer,o=function(e){var o,i,s;if(e.prototype.hasOwnProperty(METADATA_FIELD_KEY)?o=e.prototype[METADATA_FIELD_KEY]:(o=new JsonObjectMetadata,(i=e.prototype[METADATA_FIELD_KEY])&&(Object.keys(i.dataMembers).forEach(function(e){o.dataMembers[e]=i.dataMembers[e]}),Object.keys(i.knownTypes).forEach(function(e){o.setKnownType(i.knownTypes[e])})),Object.defineProperty(e.prototype,METADATA_FIELD_KEY,{enumerable:!1,configurable:!1,writable:!1,value:o})),o.classType=e,o.isExplicitlyMarked=!0,t.name&&(o.className=t.name),t.knownTypes){s=0;try{t.knownTypes.forEach(function(e){if(void 0===e)throw new TypeError("Known type #"+s+++" is undefined.");o.setKnownType(e)})}catch(t){Helpers.error(new TypeError("@JsonObject: "+t.message+" (on '"+Helpers.getClassName(e)+"')"))}}"function"==typeof n&&(o.initializer=n),"function"==typeof r&&(o.serializer=r)};return"function"==typeof e?o(e):o}function jsonMemberTypeInit(e,t,n){if(void 0===n&&(n=!1),e.elements&&("function"==typeof e.elements&&(e.elements={type:e.elements}),e.type||(e.type=Array)),e.type===Array)if(e.elements)jsonMemberTypeInit(e.elements,t+"[]",!0);else{if(!n)throw new Error("No valid 'elements' option was specified for '"+t+"'.");Helpers.warn("No valid 'elements' option was specified for '"+t+"'.")}if("function"!=typeof e.type)throw new Error("No valid 'type' option was specified for '"+t+"'.")}function jsonMemberKnownTypes(e){var t=new Array;return t.push(e.type),e.elements&&(t=t.concat(jsonMemberKnownTypes(e.elements))),t}function JsonMember(e,t){var n,r,o=new JsonMemberMetadata;return n="string"==typeof t||"symbol"===(void 0===t?"undefined":_typeof(t))?{}:e||{},r=function(e,t){var r,i,s,a=(Object.getOwnPropertyDescriptor(e,t.toString()),Helpers.getPropertyDisplayName(e,t));if("function"==typeof e)throw new TypeError("@JsonMember cannot be used on a static property ('"+a+"').");if("function"==typeof e[t])throw new TypeError("@JsonMember cannot be used on a method property ('"+a+"').");if(n.hasOwnProperty("elementType")&&(Helpers.warn(a+": the 'elementType' option is deprecated, use 'elements' instead."),n.elements=n.elementType,n.elementType===Array&&(o.forceEnableTypeHinting=!0)),o=Helpers.assign(o,n),o.key=t.toString(),o.name=n.name||t.toString(),Helpers.isReservedMemberName(o.name))throw new Error("@JsonMember: '"+o.name+"' is a reserved name.");if(n.hasOwnProperty("type")&&void 0===n.type)throw new TypeError("@JsonMember: 'type' of '"+a+"' is undefined.");if("object"===("undefined"==typeof Reflect?"undefined":_typeof(Reflect))&&"function"==typeof Reflect.getMetadata){if(void 0===(s=Reflect.getMetadata("design:type",e,t)))throw new TypeError("@JsonMember: type detected for '"+a+"' is undefined.");o.type&&"function"==typeof o.type?o.type!==s&&Helpers.warn("@JsonMember: 'type' specified for '"+a+"' does not match detected type."):o.type=s}jsonMemberTypeInit(o,a),e.hasOwnProperty(METADATA_FIELD_KEY)?r=e[METADATA_FIELD_KEY]:(r=new JsonObjectMetadata,(i=e[METADATA_FIELD_KEY])&&Object.keys(i.dataMembers).forEach(function(e){r.dataMembers[e]=i.dataMembers[e]}),Object.defineProperty(e,METADATA_FIELD_KEY,{enumerable:!1,configurable:!1,writable:!1,value:r})),jsonMemberKnownTypes(o).forEach(function(e){r.setKnownType(e)});try{r.addMember(o)}catch(e){throw new Error("Member '"+o.name+"' already exists on '"+Helpers.getClassName(r.classType)+"'.")}},"string"==typeof t||"symbol"===(void 0===t?"undefined":_typeof(t))?r(e,t):r}var METADATA_FIELD_KEY="__typedJsonJsonObjectMetadataInformation__",JSON;JSON||(JSON={parse:function parse(sJSON){var returnval=sJSON;return"object"===(void 0===returnval?"undefined":_typeof(returnval))?returnval:eval("("+sJSON+")")},stringify:function(){var e=Object.prototype.toString,t=Array.isArray||function(t){return"[object Array]"===e.call(t)},n={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"},r=function(e){return n[e]||"\\u"+(e.charCodeAt(0)+65536).toString(16).substr(1)},o=/[\\"\u0000-\u001F\u2028\u2029]/g;return function n(i){if(null==i)return"null";if("number"==typeof i)return isFinite(i)?i.toString():"null";if("boolean"==typeof i)return i.toString();if("object"===(void 0===i?"undefined":_typeof(i))){if("function"==typeof i.toJSON)return n(i.toJSON());if(t(i)){for(var s="[",a=0;a<i.length;a++)s+=(a?", ":"")+n(i[a]);return s+"]"}if("[object Object]"===e.call(i)){var p=[];for(var c in i)i.hasOwnProperty(c)&&p.push(n(c)+": "+n(i[c]));return"{"+p.join(", ")+"}"}}return'"'+i.toString().replace(o,r)+'"'}}()});var Helpers;!function(e){function t(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r,o;if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");r=Object(e);for(var i=1;i<arguments.length;i++)if(void 0!==(o=arguments[i])&&null!==o)for(var s in o)o.hasOwnProperty(s)&&(r[s]=o[s]);return r}function n(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];"object"===("undefined"==typeof console?"undefined":_typeof(console))&&"function"==typeof console.error?console.error.apply(console,[e].concat(t)):"object"===("undefined"==typeof console?"undefined":_typeof(console))&&"function"==typeof console.log&&console.log.apply(console,["ERROR: "+e].concat(t))}function r(e){var t;return"function"==typeof e?t=e:"object"===(void 0===e?"undefined":_typeof(e))&&(t=e.constructor),t?"name"in t&&"string"==typeof t.name?t.name:t.toString().match(/function (\w*)/)[1]:"undefined"}function o(e){switch(e){case Number:return 0;case String:return"";case Boolean:return!1;case Array:return[];default:return null}}function i(e,t){return r(e)+"."+t.toString()}function s(e){return"function"==typeof Array.isArray?Array.isArray(e):e instanceof Array}function a(e){switch(void 0===e?"undefined":_typeof(e)){case"string":case"number":case"boolean":return!0}return e instanceof String||e===String||e instanceof Number||e===Number||e instanceof Boolean||e===Boolean}function p(e){return e===METADATA_FIELD_KEY}function c(e,t){var n=e.prototype;if(e===t)return!0;for(;n;){if(n instanceof t)return!0;n=n.prototype}return!1}function u(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];"object"===("undefined"==typeof console?"undefined":_typeof(console))&&"function"==typeof console.log&&console.log.apply(console,[e].concat(t))}function f(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r,o;if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");r={},Object.keys(e).forEach(function(t){r[t]=e[t]});for(var i=1;i<arguments.length;i++)if(void 0!==(o=arguments[i])&&null!==o)for(var s in o)o.hasOwnProperty(s)&&(r[s]=o[s]);return r}function l(e){return void 0!==e&&null!==e}function h(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];"object"===("undefined"==typeof console?"undefined":_typeof(console))&&"function"==typeof console.warn?console.warn.apply(console,[e].concat(t)):"object"===("undefined"==typeof console?"undefined":_typeof(console))&&"function"==typeof console.log&&console.log.apply(console,["WARNING: "+e].concat(t))}e.assign=t,e.error=n,e.getClassName=r,e.getDefaultValue=o,e.getPropertyDisplayName=i,e.isArray=s,e.isPrimitive=a,e.isReservedMemberName=p,e.isSubtypeOf=c,e.log=u,e.merge=f,e.valueIsDefined=l,e.warn=h}(Helpers||(Helpers={}));var JsonMemberMetadata=function(){function e(){}return e}(),JsonObjectMetadata=function(){function e(){this._dataMembers={},this._knownTypes=[],this._knownTypeCache=null,this.isExplicitlyMarked=!1}return e.getJsonObjectName=function(e,t){void 0===t&&(t=!0);var n=this.getFromType(e,t);return null!==n?n.className:Helpers.getClassName(e)},e.getFromType=function(e,t){void 0===t&&(t=!0);var n,r;return(n="function"==typeof e?e.prototype:e)?(n.hasOwnProperty(METADATA_FIELD_KEY)?r=n[METADATA_FIELD_KEY]:t&&n[METADATA_FIELD_KEY]&&(r=n[METADATA_FIELD_KEY]),r&&r.isExplicitlyMarked?r:null):null},e.getFromInstance=function(e,t){return void 0===t&&(t=!0),this.getFromType(Object.getPrototypeOf(e),t)},e.getKnownTypeNameFromType=function(e){var t=this.getFromType(e,!1);return t?t.className:Helpers.getClassName(e)},e.getKnownTypeNameFromInstance=function(e){var t=this.getFromInstance(e,!1);return t?t.className:Helpers.getClassName(e.constructor)},Object.defineProperty(e.prototype,"dataMembers",{get:function(){return this._dataMembers},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return"string"==typeof this._className?this._className:Helpers.getClassName(this.classType)},set:function(e){this._className=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"knownTypes",{get:function(){var t,n;return t={},this._knownTypes.forEach(function(r){n=e.getKnownTypeNameFromType(r),t[n]=r}),this._knownTypeCache=t,t},enumerable:!0,configurable:!0}),e.prototype.setKnownType=function(e){-1===this._knownTypes.indexOf(e)&&(this._knownTypes.push(e),this._knownTypeCache=null)},e.prototype.addMember=function(e){var t=this;Object.keys(this._dataMembers).forEach(function(n){if(t._dataMembers[n].name===e.name)throw new Error("A member with the name '"+e.name+"' already exists.")}),this._dataMembers[e.key]=e},e.prototype.sortMembers=function(){var e=this,t=[];Object.keys(this._dataMembers).forEach(function(n){t.push(e._dataMembers[n])}),t=t.sort(this.sortMembersCompare),this._dataMembers={},t.forEach(function(t){e._dataMembers[t.key]=t})},e.prototype.sortMembersCompare=function(e,t){if("number"!=typeof e.order&&"number"!=typeof t.order){if(e.name<t.name)return-1;if(e.name>t.name)return 1}else{if("number"!=typeof e.order)return 1;if("number"!=typeof t.order)return-1;if(e.order<t.order)return-1;if(e.order>t.order)return 1;if(e.name<t.name)return-1;if(e.name>t.name)return 1}return 0},e}();exports.JsonObject=JsonObject,exports.JsonMember=JsonMember;var Serializer=function(){function e(){}return e.writeObject=function(e,t){var n,r=JsonObjectMetadata.getFromInstance(e);return n=r?r.classType:e.constructor,JSON.stringify(this.writeToJsonObject(e,{objectType:n,enableTypeHints:t.enableTypeHints,typeHintPropertyKey:t.typeHintPropertyKey}),t.replacer)},e.writeToJsonObject=function(e,t){var n,r,o=this;if(null===e||void 0===e)n=t.emitDefault?Helpers.getDefaultValue(t.objectType):e;else if(Helpers.isPrimitive(e)||e instanceof Date)n=e;else if(e instanceof Array){n=[];for(var i=0,s=e.length;i<s;i++)n.push(this.writeToJsonObject(e[i],{elements:t.elements?t.elements.elements:null,enableTypeHints:t.enableTypeHints,objectType:t.elements?t.elements.type:Object,requireTypeHints:t.requireTypeHints,typeHintPropertyKey:t.typeHintPropertyKey}))}else r=JsonObjectMetadata.getFromInstance(e),r&&"function"==typeof r.serializer?n=r.serializer(e):(n={},t.enableTypeHints&&(t.requireTypeHints||e.constructor!==t.objectType)&&(n[t.typeHintPropertyKey]=JsonObjectMetadata.getKnownTypeNameFromInstance(e)),r?(r.sortMembers(),Object.keys(r.dataMembers).forEach(function(i){var s=r.dataMembers[i];n[s.name]=o.writeToJsonObject(e[i],{elements:s.elements,emitDefault:s.emitDefaultValue,enableTypeHints:t.enableTypeHints,name:s.name,objectType:s.type,requireTypeHints:t.requireTypeHints,typeHintPropertyKey:t.typeHintPropertyKey})})):Object.keys(e).forEach(function(r){n[r]=o.writeToJsonObject(e[r],{enableTypeHints:t.enableTypeHints,objectType:Object,requireTypeHints:t.requireTypeHints,typeHintPropertyKey:t.typeHintPropertyKey})}));return n},e}(),Deserializer=function(){function e(){}return e.readObject=function(e,t,n){var r,o=JsonObjectMetadata.getFromType(t);if(r="Object"==typeof e?e:JSON.parse(e,n.reviver),"number"==typeof n.maxObjects&&this.countObjects(r)>n.maxObjects)throw new Error("JSON exceeds object count limit ("+n.maxObjects+").");return this.readJsonToInstance(r,{objectType:t,typeHintPropertyKey:n.typeHintPropertyKey,enableTypeHints:n.enableTypeHints,strictTypeHintMode:!0,knownTypes:o?o.knownTypes:{}})},e.countObjects=function(e){var t=this;switch(void 0===e?"undefined":_typeof(e)){case"object":if(null===e)return 0;if(Helpers.isArray(e)){var n=0;return e.forEach(function(e){n+=t.countObjects(e)}),n}var r=0;return Object.keys(e).forEach(function(n){r+=t.countObjects(e[n])}),r;case"undefined":return 0;default:return 1}},e.readJsonToInstance=function(e,t){var n,r,o,i,s,a=this;if(void 0===e||null===e){if(t.isRequired)throw new Error("Missing required member.")}else if(Helpers.isPrimitive(t.objectType)){if(e.constructor!==t.objectType){var p=Helpers.getClassName(t.objectType).toLowerCase(),c=Helpers.getClassName(e.constructor).toLowerCase();throw new TypeError("Expected value to be of type '"+p+"', got '"+c+"'.")}n=e}else if(t.objectType===Array){if(!Helpers.isArray(e))throw new TypeError("Expected value to be of type 'Array', got '"+Helpers.getClassName(e.constructor)+"'.");n=[],e.forEach(function(e){n.push(a.readJsonToInstance(e,{elements:t.elements?t.elements.elements:null,enableTypeHints:t.enableTypeHints,knownTypes:t.knownTypes,objectType:t.elements?t.elements.type:e.constructor,requireTypeHints:t.requireTypeHints,strictTypeHintMode:t.strictTypeHintMode,typeHintPropertyKey:t.typeHintPropertyKey}))})}else if(t.objectType===Date)if("string"==typeof e)n=new Date(e);else{if(!(e instanceof Date))throw new TypeError("Expected value to be of type 'string', got '"+(void 0===e?"undefined":_typeof(e))+"'.");n=e}else{if((i=e[t.typeHintPropertyKey])&&t.enableTypeHints){if("string"!=typeof i)throw new TypeError("Type-hint ("+t.typeHintPropertyKey+") must be a string.");if(!t.knownTypes[i])throw new Error("'"+i+"' is not a known type.");if(t.strictTypeHintMode&&!Helpers.isSubtypeOf(t.knownTypes[i],t.objectType))throw new Error("'"+i+"' is not a subtype of '"+Helpers.getClassName(t.objectType)+"'.");o=t.knownTypes[i],r=JsonObjectMetadata.getFromType(o)}else{if(t.enableTypeHints&&t.requireTypeHints)throw new Error("Missing required type-hint.");o=t.objectType,r=JsonObjectMetadata.getFromType(t.objectType)}r?"function"==typeof r.initializer?n=r.initializer(e)||null:(r.sortMembers(),n=new o,Object.keys(r.dataMembers).forEach(function(o){var i=r.dataMembers[o];s=a.readJsonToInstance(e[i.name],{elements:i.elements,enableTypeHints:t.enableTypeHints,isRequired:i.isRequired,knownTypes:Helpers.merge(t.knownTypes,r.knownTypes||{}),objectType:i.type,requireTypeHints:t.requireTypeHints,strictTypeHintMode:t.strictTypeHintMode,typeHintPropertyKey:t.typeHintPropertyKey}),Helpers.valueIsDefined(s)&&(n[o]=s)})):(n={},Object.keys(e).forEach(function(r){e[r]&&r!==t.typeHintPropertyKey&&(n[r]=a.readJsonToInstance(e[r],{enableTypeHints:t.enableTypeHints,knownTypes:t.knownTypes,objectType:e[r].constructor,requireTypeHints:t.requireTypeHints,typeHintPropertyKey:t.typeHintPropertyKey}))}))}return n},e}(),configSettings={enableTypeHints:!0,typeHintPropertyKey:"__type"},TypedJSON={config:function(e){configSettings=Helpers.merge(configSettings,e)},stringify:function(e,t){return Serializer.writeObject(e,Helpers.merge(configSettings,t||{}))},parse:function(e,t,n){return JsonObjectMetadata.getFromType(t)?Deserializer.readObject(e,t,Helpers.merge(configSettings,n||{})):JSON.parse.apply(JSON,arguments)}};exports.TypedJSON=TypedJSON})},{}]},{},[7])(7)})}).call(exports,__webpack_require__(16))}},[17]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcGFyc2VyLmQwNzA0MDFkNzYzYTU5ZDI0YTlkLmpzIiwid2VicGFjazovLy8od2VicGFjaykvYnVpbGRpbi9nbG9iYWwuanMiLCJ3ZWJwYWNrOi8vLy4vcGFyc2VyL2J1bmRsZS1wYXJzZXIuanMiXSwibmFtZXMiOlsid2VicGFja0pzb25wIiwiMTYiLCJtb2R1bGUiLCJleHBvcnRzIiwiZyIsInRoaXMiLCJGdW5jdGlvbiIsImV2YWwiLCJlIiwid2luZG93IiwiMTciLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiZ2xvYmFsIiwiX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fIiwiX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyIsIl9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fIiwicmVxdWlyZSIsIl90eXBlb2YiLCJTeW1ib2wiLCJpdGVyYXRvciIsIm9iaiIsImNvbnN0cnVjdG9yIiwicHJvdG90eXBlIiwiZiIsInVuZGVmaW5lZCIsImFwcGx5IiwiZGVmaW5lIiwidCIsIm4iLCJyIiwicyIsIm8iLCJ1IiwiYSIsImkiLCJFcnJvciIsImNvZGUiLCJsIiwiY2FsbCIsImxlbmd0aCIsIjEiLCJyb290IiwiZXJyb3IiLCJ0eXBlIiwiUmFuZ2VFcnJvciIsImVycm9ycyIsIm1hcCIsImFycmF5IiwiZm4iLCJyZXN1bHQiLCJtYXBEb21haW4iLCJzdHJpbmciLCJwYXJ0cyIsInNwbGl0IiwicmVwbGFjZSIsInJlZ2V4U2VwYXJhdG9ycyIsImpvaW4iLCJ1Y3MyZGVjb2RlIiwidmFsdWUiLCJleHRyYSIsIm91dHB1dCIsImNvdW50ZXIiLCJjaGFyQ29kZUF0IiwicHVzaCIsInVjczJlbmNvZGUiLCJzdHJpbmdGcm9tQ2hhckNvZGUiLCJiYXNpY1RvRGlnaXQiLCJjb2RlUG9pbnQiLCJiYXNlIiwiZGlnaXRUb0Jhc2ljIiwiZGlnaXQiLCJmbGFnIiwiYWRhcHQiLCJkZWx0YSIsIm51bVBvaW50cyIsImZpcnN0VGltZSIsImsiLCJmbG9vciIsImRhbXAiLCJiYXNlTWludXNUTWluIiwidE1heCIsInNrZXciLCJkZWNvZGUiLCJpbnB1dCIsIm91dCIsImJhc2ljIiwiaiIsImluZGV4Iiwib2xkaSIsInciLCJiYXNlTWludXNUIiwiaW5wdXRMZW5ndGgiLCJpbml0aWFsTiIsImJpYXMiLCJpbml0aWFsQmlhcyIsImxhc3RJbmRleE9mIiwiZGVsaW1pdGVyIiwibWF4SW50IiwidE1pbiIsInNwbGljZSIsImVuY29kZSIsImhhbmRsZWRDUENvdW50IiwiYmFzaWNMZW5ndGgiLCJtIiwicSIsImN1cnJlbnRWYWx1ZSIsImhhbmRsZWRDUENvdW50UGx1c09uZSIsInFNaW51c1QiLCJ0b1VuaWNvZGUiLCJyZWdleFB1bnljb2RlIiwidGVzdCIsInNsaWNlIiwidG9Mb3dlckNhc2UiLCJ0b0FTQ0lJIiwicmVnZXhOb25BU0NJSSIsImZyZWVFeHBvcnRzIiwibm9kZVR5cGUiLCJmcmVlTW9kdWxlIiwiZnJlZUdsb2JhbCIsInNlbGYiLCJwdW55Y29kZSIsImtleSIsIm92ZXJmbG93Iiwibm90LWJhc2ljIiwiaW52YWxpZC1pbnB1dCIsIk1hdGgiLCJTdHJpbmciLCJmcm9tQ2hhckNvZGUiLCJ2ZXJzaW9uIiwidWNzMiIsImFtZCIsImhhc093blByb3BlcnR5IiwiMiIsInByb3AiLCJPYmplY3QiLCJxcyIsInNlcCIsImVxIiwib3B0aW9ucyIsInJlZ2V4cCIsIm1heEtleXMiLCJsZW4iLCJrc3RyIiwidnN0ciIsInYiLCJ4IiwiaWR4IiwiaW5kZXhPZiIsInN1YnN0ciIsImRlY29kZVVSSUNvbXBvbmVudCIsImlzQXJyYXkiLCJBcnJheSIsInhzIiwidG9TdHJpbmciLCIzIiwicmVzIiwic3RyaW5naWZ5UHJpbWl0aXZlIiwiaXNGaW5pdGUiLCJuYW1lIiwib2JqZWN0S2V5cyIsImtzIiwiZW5jb2RlVVJJQ29tcG9uZW50Iiwia2V5cyIsIjQiLCJwYXJzZSIsInN0cmluZ2lmeSIsIi4vZGVjb2RlIiwiLi9lbmNvZGUiLCI1IiwiVXJsIiwicHJvdG9jb2wiLCJzbGFzaGVzIiwiYXV0aCIsImhvc3QiLCJwb3J0IiwiaG9zdG5hbWUiLCJoYXNoIiwic2VhcmNoIiwicXVlcnkiLCJwYXRobmFtZSIsInBhdGgiLCJocmVmIiwidXJsUGFyc2UiLCJ1cmwiLCJwYXJzZVF1ZXJ5U3RyaW5nIiwic2xhc2hlc0Rlbm90ZUhvc3QiLCJ1dGlsIiwiaXNPYmplY3QiLCJ1cmxGb3JtYXQiLCJpc1N0cmluZyIsImZvcm1hdCIsInVybFJlc29sdmUiLCJzb3VyY2UiLCJyZWxhdGl2ZSIsInJlc29sdmUiLCJ1cmxSZXNvbHZlT2JqZWN0IiwicmVzb2x2ZU9iamVjdCIsInByb3RvY29sUGF0dGVybiIsInBvcnRQYXR0ZXJuIiwic2ltcGxlUGF0aFBhdHRlcm4iLCJkZWxpbXMiLCJ1bndpc2UiLCJjb25jYXQiLCJhdXRvRXNjYXBlIiwibm9uSG9zdENoYXJzIiwiaG9zdEVuZGluZ0NoYXJzIiwiaG9zdG5hbWVQYXJ0UGF0dGVybiIsImhvc3RuYW1lUGFydFN0YXJ0IiwidW5zYWZlUHJvdG9jb2wiLCJqYXZhc2NyaXB0IiwiamF2YXNjcmlwdDoiLCJob3N0bGVzc1Byb3RvY29sIiwic2xhc2hlZFByb3RvY29sIiwiaHR0cCIsImh0dHBzIiwiZnRwIiwiZ29waGVyIiwiZmlsZSIsImh0dHA6IiwiaHR0cHM6IiwiZnRwOiIsImdvcGhlcjoiLCJmaWxlOiIsInF1ZXJ5c3RyaW5nIiwiVHlwZUVycm9yIiwicXVlcnlJbmRleCIsInNwbGl0dGVyIiwidVNwbGl0Iiwic2xhc2hSZWdleCIsInJlc3QiLCJ0cmltIiwic2ltcGxlUGF0aCIsImV4ZWMiLCJwcm90byIsImxvd2VyUHJvdG8iLCJtYXRjaCIsImhvc3RFbmQiLCJoZWMiLCJhdFNpZ24iLCJwYXJzZUhvc3QiLCJpcHY2SG9zdG5hbWUiLCJob3N0cGFydHMiLCJwYXJ0IiwibmV3cGFydCIsInZhbGlkUGFydHMiLCJub3RIb3N0IiwiYml0IiwidW5zaGlmdCIsInAiLCJoIiwiYWUiLCJlc2MiLCJlc2NhcGUiLCJxbSIsImNoYXJBdCIsInJlbCIsInRrZXlzIiwidGsiLCJ0a2V5IiwicmtleXMiLCJyayIsInJrZXkiLCJyZWxQYXRoIiwic2hpZnQiLCJpc1NvdXJjZUFicyIsImlzUmVsQWJzIiwibXVzdEVuZEFicyIsInJlbW92ZUFsbERvdHMiLCJzcmNQYXRoIiwicHN5Y2hvdGljIiwicG9wIiwiaXNOdWxsT3JVbmRlZmluZWQiLCJhdXRoSW5Ib3N0IiwiaXNOdWxsIiwibGFzdCIsImhhc1RyYWlsaW5nU2xhc2giLCJ1cCIsImlzQWJzb2x1dGUiLCIuL3V0aWwiLCI2IiwiYXJnIiwiNyIsInBhcnNlVERPYmplY3QiLCJ0ZCIsInBhcnNlVERTdHJpbmciLCJ0eXBlZGpzb25fbnBtXzEiLCJUeXBlZEpTT04iLCJlbmFibGVUeXBlSGludHMiLCJqc29uIiwiY29uc29sZSIsImxvZyIsInRoaW5nX2Rlc2NyaXB0aW9uXzEiLCJkZWZhdWx0IiwiaW50ZXJhY3Rpb24iLCJfaSIsIl9hIiwic2VtYW50aWNUeXBlcyIsIlREIiwiSW50ZXJhY3Rpb25QYXR0ZXJuIiwiUHJvcGVydHkiLCJwYXR0ZXJuIiwiQWN0aW9uIiwiRXZlbnQiLCJsaW5rIiwicHIiLCJ1cmlUZW1wIiwic2VyaWFsaXplVEQiLCJjb25maWciLCJyYXciLCJKU09OIiwiaW5wdXREYXRhIiwib3V0cHV0RGF0YSIsIndyaXRhYmxlIiwicmVxdWlyZWQiLCJyZXFzIiwicmVxIiwiZGVmaW5lUHJvcGVydHkiLCIuL3RoaW5nLWRlc2NyaXB0aW9uIiwidHlwZWRqc29uLW5wbSIsIjgiLCJfX2RlY29yYXRlIiwiZGVjb3JhdG9ycyIsInRhcmdldCIsImRlc2MiLCJkIiwiYyIsImFyZ3VtZW50cyIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsIlJlZmxlY3QiLCJkZWNvcmF0ZSIsIkludGVyYWN0aW9uTGluayIsIkpzb25NZW1iZXIiLCJpc1JlcXVpcmVkIiwiSnNvbk9iamVjdCIsIkludGVyYWN0aW9uIiwiZWxlbWVudHMiLCJCb29sZWFuIiwia25vd25UeXBlcyIsIlRoaW5nRGVzY3JpcHRpb24iLCJjb250ZXh0Iiwic2VtYW50aWNUeXBlIiwiOSIsImZhY3RvcnkiLCJvcHRpb25zT3JUYXJnZXQiLCJpbml0aWFsaXplciIsInNlcmlhbGl6ZXIiLCJkZWNvcmF0b3IiLCJvYmplY3RNZXRhZGF0YSIsInBhcmVudE1ldGFkYXRhIiwiTUVUQURBVEFfRklFTERfS0VZIiwiSnNvbk9iamVjdE1ldGFkYXRhIiwiZGF0YU1lbWJlcnMiLCJmb3JFYWNoIiwibWVtYmVyUHJvcGVydHlLZXkiLCJzZXRLbm93blR5cGUiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwiY2xhc3NUeXBlIiwiaXNFeHBsaWNpdGx5TWFya2VkIiwiY2xhc3NOYW1lIiwia25vd25UeXBlIiwiSGVscGVycyIsIm1lc3NhZ2UiLCJnZXRDbGFzc05hbWUiLCJqc29uTWVtYmVyVHlwZUluaXQiLCJtZXRhZGF0YSIsInByb3BlcnR5TmFtZSIsIndhcm5BcnJheSIsIndhcm4iLCJqc29uTWVtYmVyS25vd25UeXBlcyIsInByb3BlcnR5S2V5IiwibWVtYmVyTWV0YWRhdGEiLCJKc29uTWVtYmVyTWV0YWRhdGEiLCJyZWZsZWN0VHlwZSIsImdldFByb3BlcnR5RGlzcGxheU5hbWUiLCJlbGVtZW50VHlwZSIsImZvcmNlRW5hYmxlVHlwZUhpbnRpbmciLCJhc3NpZ24iLCJpc1Jlc2VydmVkTWVtYmVyTmFtZSIsImdldE1ldGFkYXRhIiwiYWRkTWVtYmVyIiwic0pTT04iLCJyZXR1cm52YWwiLCJlc2NNYXAiLCJcIiIsIlxcIiwiXGIiLCJcZiIsIlxuIiwiXHIiLCJcdCIsImVzY0Z1bmMiLCJlc2NSRSIsInRvSlNPTiIsInRtcCIsInNvdXJjZXMiLCJuZXh0S2V5Iiwib3B0aW9uYWxQYXJhbXMiLCJ0YXJnZXRUeXBlIiwiZ2V0RGVmYXVsdFZhbHVlIiwiTnVtYmVyIiwib2JqZWN0IiwiaXNQcmltaXRpdmUiLCJpc1N1YnR5cGVPZiIsIkEiLCJCIiwiYVByb3RvdHlwZSIsIm1lcmdlIiwidmFsdWVJc0RlZmluZWQiLCJfZGF0YU1lbWJlcnMiLCJfa25vd25UeXBlcyIsIl9rbm93blR5cGVDYWNoZSIsImdldEpzb25PYmplY3ROYW1lIiwiaW5oZXJpdGVkIiwiZ2V0RnJvbVR5cGUiLCJ0YXJnZXRQcm90b3R5cGUiLCJnZXRGcm9tSW5zdGFuY2UiLCJnZXRQcm90b3R5cGVPZiIsImdldEtub3duVHlwZU5hbWVGcm9tVHlwZSIsImdldEtub3duVHlwZU5hbWVGcm9tSW5zdGFuY2UiLCJnZXQiLCJfY2xhc3NOYW1lIiwic2V0Iiwia25vd25UeXBlTmFtZSIsIm1lbWJlciIsIl90aGlzIiwic29ydE1lbWJlcnMiLCJtZW1iZXJBcnJheSIsInNvcnQiLCJzb3J0TWVtYmVyc0NvbXBhcmUiLCJkYXRhTWVtYmVyIiwiYiIsIm9yZGVyIiwiU2VyaWFsaXplciIsIndyaXRlT2JqZWN0Iiwic2V0dGluZ3MiLCJPYmplY3RUeXBlIiwid3JpdGVUb0pzb25PYmplY3QiLCJvYmplY3RUeXBlIiwidHlwZUhpbnRQcm9wZXJ0eUtleSIsInJlcGxhY2VyIiwiZW1pdERlZmF1bHQiLCJEYXRlIiwicmVxdWlyZVR5cGVIaW50cyIsInByb3BlcnR5TWV0YWRhdGEiLCJlbWl0RGVmYXVsdFZhbHVlIiwiRGVzZXJpYWxpemVyIiwicmVhZE9iamVjdCIsInJldml2ZXIiLCJtYXhPYmplY3RzIiwiY291bnRPYmplY3RzIiwicmVhZEpzb25Ub0luc3RhbmNlIiwic3RyaWN0VHlwZUhpbnRNb2RlIiwiY291bnRfMSIsIml0ZW0iLCJjb3VudF8yIiwidHlwZUhpbnQiLCJ0ZW1wIiwiZXhwZWN0ZWRUeXBlTmFtZSIsImZvdW5kVHlwZU5hbWUiLCJlbGVtZW50IiwiY29uZmlnU2V0dGluZ3MiXSwibWFwcGluZ3MiOiJBQUFBQSxjQUFjLElBRVJDLEdBQ0EsU0FBVUMsRUFBUUMsR0NIeEIsR0FBQUMsRUFHQUEsR0FBQSxXQUNBLE1BQUFDLFFBR0EsS0FFQUQsS0FBQUUsU0FBQSxxQkFBQUMsTUFBQSxRQUNDLE1BQUFDLEdBRUQsZ0JBQUFDLFVBQ0FM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VixnQkFDOURxRyxXQUFZTSxFQUFpQmpaLEtBQzdCZ1osaUJBQWtCUixFQUFTUSxpQkFDM0JTLG1CQUFvQmpCLEVBQVNpQixtQkFDN0JiLG9CQUFxQkosRUFBU0ksc0JBRTlCOUUsUUFBUStDLGVBQWVpRCxLQUN2QnhELEVBQU8vQixHQUFldUYsT0FNbEN4RCxLQUNBM1EsT0FBTzRCLEtBQUs4SCxHQUFNZ0UsUUFBUSxTQUFVa0IsR0FDNUJsRixFQUFLa0YsSUFBZ0JBLElBQWdCaUUsRUFBU0ksc0JBQzlDdEMsRUFBTy9CLEdBQWV1RCxFQUFNMEIsbUJBQW1CbkssRUFBS2tGLElBQ2hEbkYsZ0JBQWlCb0osRUFBU3BKLGdCQUMxQmtELFdBQVlrRyxFQUFTbEcsV0FDckJxRyxXQUFZdEosRUFBS2tGLEdBQWE3VixZQUM5QnNhLGlCQUFrQlIsRUFBU1EsaUJBQzNCSixvQkFBcUJKLEVBQVNJLDBCQU1sRCxNQUFPdEMsSUFFSjZDLEtBRVBlLGdCQUNBOUssaUJBQWlCLEVBQ2pCd0osb0JBQXFCLFVBRXJCekosV0FDQXFCLE9BQVEsU0FBVWdJLEdBQ2QwQixlQUFpQnBHLFFBQVE4QyxNQUFNc0QsZUFBZ0IxQixJQUVuRDlRLFVBQVcsU0FBVTNHLEVBQU95WCxHQUN4QixNQUFPRixZQUFXQyxZQUFZeFgsRUFBTytTLFFBQVE4QyxNQUFNc0QsZUFBZ0IxQixTQUV2RS9RLE1BQU8sU0FBVTRILEVBQU1yUCxFQUFNd1ksR0FDekIsTUFBSXJGLG9CQUFtQmdFLFlBQVluWCxHQUN4Qm1aLGFBQWFDLFdBQVcvSixFQUFNclAsRUFBTThULFFBQVE4QyxNQUFNc0QsZUFBZ0IxQixRQUdsRTlILEtBQUtqSixNQUFNM0ksTUFBTTRSLEtBQU1pQixZQUkxQ25VLFNBQVEyUixVQUFZQSxzQkFHYixJQUFJLE9GdkRjeFAsS0FBS25DLFFBQVNRLG9CQUFvQixRQUk1RCIsImZpbGUiOiJwYXJzZXIuZDA3MDQwMWQ3NjNhNTlkMjRhOWQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ3ZWJwYWNrSnNvbnAoWzJdLHtcblxuLyoqKi8gMTY6XG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cbnZhciBnO1xyXG5cclxuLy8gVGhpcyB3b3JrcyBpbiBub24tc3RyaWN0IG1vZGVcclxuZyA9IChmdW5jdGlvbigpIHtcclxuXHRyZXR1cm4gdGhpcztcclxufSkoKTtcclxuXHJcbnRyeSB7XHJcblx0Ly8gVGhpcyB3b3JrcyBpZiBldmFsIGlzIGFsbG93ZWQgKHNlZSBDU1ApXHJcblx0ZyA9IGcgfHwgRnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpIHx8ICgxLGV2YWwpKFwidGhpc1wiKTtcclxufSBjYXRjaChlKSB7XHJcblx0Ly8gVGhpcyB3b3JrcyBpZiB0aGUgd2luZG93IHJlZmVyZW5jZSBpcyBhdmFpbGFibGVcclxuXHRpZih0eXBlb2Ygd2luZG93ID09PSBcIm9iamVjdFwiKVxyXG5cdFx0ZyA9IHdpbmRvdztcclxufVxyXG5cclxuLy8gZyBjYW4gc3RpbGwgYmUgdW5kZWZpbmVkLCBidXQgbm90aGluZyB0byBkbyBhYm91dCBpdC4uLlxyXG4vLyBXZSByZXR1cm4gdW5kZWZpbmVkLCBpbnN0ZWFkIG9mIG5vdGhpbmcgaGVyZSwgc28gaXQnc1xyXG4vLyBlYXNpZXIgdG8gaGFuZGxlIHRoaXMgY2FzZS4gaWYoIWdsb2JhbCkgeyAuLi59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGc7XHJcblxuXG4vKioqLyB9KSxcblxuLyoqKi8gMTc6XG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cbi8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihnbG9iYWwpIHt2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzt2YXIgcmVxdWlyZTt2YXIgcmVxdWlyZTt2YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cbihmdW5jdGlvbiAoZikge1xuICAgIGlmICgoIGZhbHNlID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2YoZXhwb3J0cykpID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBtb2R1bGUgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmKCk7XG4gICAgfSBlbHNlIGlmICh0cnVlKSB7XG4gICAgICAgICEoX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyA9IFtdLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18gPSAoZiksXG5cdFx0XHRcdF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gKHR5cGVvZiBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18gPT09ICdmdW5jdGlvbicgP1xuXHRcdFx0XHQoX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fLmFwcGx5KGV4cG9ydHMsIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18pKSA6IF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXyksXG5cdFx0XHRcdF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgZztpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgZyA9IHdpbmRvdztcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICBnID0gZ2xvYmFsO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICBnID0gc2VsZjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGcgPSB0aGlzO1xuICAgICAgICB9Zy5wYXJzZXIgPSBmKCk7XG4gICAgfVxufSkoZnVuY3Rpb24gKCkge1xuICAgIHZhciBkZWZpbmUsIG1vZHVsZSwgZXhwb3J0cztyZXR1cm4gZnVuY3Rpb24gZSh0LCBuLCByKSB7XG4gICAgICAgIGZ1bmN0aW9uIHMobywgdSkge1xuICAgICAgICAgICAgaWYgKCFuW29dKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0W29dKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhID0gdHlwZW9mIHJlcXVpcmUgPT0gXCJmdW5jdGlvblwiICYmIHJlcXVpcmU7aWYgKCF1ICYmIGEpIHJldHVybiByZXF1aXJlKG8sICEwKTtpZiAoaSkgcmV0dXJuIGkobywgITApO3ZhciBmID0gbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIiArIG8gKyBcIidcIik7dGhyb3cgZi5jb2RlID0gXCJNT0RVTEVfTk9UX0ZPVU5EXCIsIGY7XG4gICAgICAgICAgICAgICAgfXZhciBsID0gbltvXSA9IHsgZXhwb3J0czoge30gfTt0W29dWzBdLmNhbGwobC5leHBvcnRzLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IHRbb11bMV1bZV07cmV0dXJuIHMobiA/IG4gOiBlKTtcbiAgICAgICAgICAgICAgICB9LCBsLCBsLmV4cG9ydHMsIGUsIHQsIG4sIHIpO1xuICAgICAgICAgICAgfXJldHVybiBuW29dLmV4cG9ydHM7XG4gICAgICAgIH12YXIgaSA9IHR5cGVvZiByZXF1aXJlID09IFwiZnVuY3Rpb25cIiAmJiByZXF1aXJlO2ZvciAodmFyIG8gPSAwOyBvIDwgci5sZW5ndGg7IG8rKykge1xuICAgICAgICAgICAgcyhyW29dKTtcbiAgICAgICAgfXJldHVybiBzO1xuICAgIH0oeyAxOiBbZnVuY3Rpb24gKHJlcXVpcmUsIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgICAgICAgKGZ1bmN0aW9uIChnbG9iYWwpIHtcbiAgICAgICAgICAgICAgICAvKiEgaHR0cHM6Ly9tdGhzLmJlL3B1bnljb2RlIHYxLjQuMSBieSBAbWF0aGlhcyAqL1xuICAgICAgICAgICAgICAgIDsoZnVuY3Rpb24gKHJvb3QpIHtcblxuICAgICAgICAgICAgICAgICAgICAvKiogRGV0ZWN0IGZyZWUgdmFyaWFibGVzICovXG4gICAgICAgICAgICAgICAgICAgIHZhciBmcmVlRXhwb3J0cyA9ICh0eXBlb2YgZXhwb3J0cyA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKGV4cG9ydHMpKSA9PSAnb2JqZWN0JyAmJiBleHBvcnRzICYmICFleHBvcnRzLm5vZGVUeXBlICYmIGV4cG9ydHM7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmcmVlTW9kdWxlID0gKHR5cGVvZiBtb2R1bGUgPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZihtb2R1bGUpKSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUgJiYgIW1vZHVsZS5ub2RlVHlwZSAmJiBtb2R1bGU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmcmVlR2xvYmFsID0gKHR5cGVvZiBnbG9iYWwgPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZihnbG9iYWwpKSA9PSAnb2JqZWN0JyAmJiBnbG9iYWw7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmcmVlR2xvYmFsLmdsb2JhbCA9PT0gZnJlZUdsb2JhbCB8fCBmcmVlR2xvYmFsLndpbmRvdyA9PT0gZnJlZUdsb2JhbCB8fCBmcmVlR2xvYmFsLnNlbGYgPT09IGZyZWVHbG9iYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvb3QgPSBmcmVlR2xvYmFsO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAqIFRoZSBgcHVueWNvZGVgIG9iamVjdC5cbiAgICAgICAgICAgICAgICAgICAgICogQG5hbWUgcHVueWNvZGVcbiAgICAgICAgICAgICAgICAgICAgICogQHR5cGUgT2JqZWN0XG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHVueWNvZGUsXG5cblxuICAgICAgICAgICAgICAgICAgICAvKiogSGlnaGVzdCBwb3NpdGl2ZSBzaWduZWQgMzItYml0IGZsb2F0IHZhbHVlICovXG4gICAgICAgICAgICAgICAgICAgIG1heEludCA9IDIxNDc0ODM2NDcsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBha2EuIDB4N0ZGRkZGRkYgb3IgMl4zMS0xXG5cbiAgICAgICAgICAgICAgICAgICAgLyoqIEJvb3RzdHJpbmcgcGFyYW1ldGVycyAqL1xuICAgICAgICAgICAgICAgICAgICBiYXNlID0gMzYsXG4gICAgICAgICAgICAgICAgICAgICAgICB0TWluID0gMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRNYXggPSAyNixcbiAgICAgICAgICAgICAgICAgICAgICAgIHNrZXcgPSAzOCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhbXAgPSA3MDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBpbml0aWFsQmlhcyA9IDcyLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5pdGlhbE4gPSAxMjgsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAweDgwXG4gICAgICAgICAgICAgICAgICAgIGRlbGltaXRlciA9ICctJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICdcXHgyRCdcblxuICAgICAgICAgICAgICAgICAgICAvKiogUmVndWxhciBleHByZXNzaW9ucyAqL1xuICAgICAgICAgICAgICAgICAgICByZWdleFB1bnljb2RlID0gL154bi0tLyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2V4Tm9uQVNDSUkgPSAvW15cXHgyMC1cXHg3RV0vLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdW5wcmludGFibGUgQVNDSUkgY2hhcnMgKyBub24tQVNDSUkgY2hhcnNcbiAgICAgICAgICAgICAgICAgICAgcmVnZXhTZXBhcmF0b3JzID0gL1tcXHgyRVxcdTMwMDJcXHVGRjBFXFx1RkY2MV0vZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJGQyAzNDkwIHNlcGFyYXRvcnNcblxuICAgICAgICAgICAgICAgICAgICAvKiogRXJyb3IgbWVzc2FnZXMgKi9cbiAgICAgICAgICAgICAgICAgICAgZXJyb3JzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ292ZXJmbG93JzogJ092ZXJmbG93OiBpbnB1dCBuZWVkcyB3aWRlciBpbnRlZ2VycyB0byBwcm9jZXNzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdub3QtYmFzaWMnOiAnSWxsZWdhbCBpbnB1dCA+PSAweDgwIChub3QgYSBiYXNpYyBjb2RlIHBvaW50KScsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaW52YWxpZC1pbnB1dCc6ICdJbnZhbGlkIGlucHV0J1xuICAgICAgICAgICAgICAgICAgICB9LFxuXG5cbiAgICAgICAgICAgICAgICAgICAgLyoqIENvbnZlbmllbmNlIHNob3J0Y3V0cyAqL1xuICAgICAgICAgICAgICAgICAgICBiYXNlTWludXNUTWluID0gYmFzZSAtIHRNaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICBmbG9vciA9IE1hdGguZmxvb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmdGcm9tQ2hhckNvZGUgPSBTdHJpbmcuZnJvbUNoYXJDb2RlLFxuXG5cbiAgICAgICAgICAgICAgICAgICAgLyoqIFRlbXBvcmFyeSB2YXJpYWJsZSAqL1xuICAgICAgICAgICAgICAgICAgICBrZXk7XG5cbiAgICAgICAgICAgICAgICAgICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAqIEEgZ2VuZXJpYyBlcnJvciB1dGlsaXR5IGZ1bmN0aW9uLlxuICAgICAgICAgICAgICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gdHlwZSBUaGUgZXJyb3IgdHlwZS5cbiAgICAgICAgICAgICAgICAgICAgICogQHJldHVybnMge0Vycm9yfSBUaHJvd3MgYSBgUmFuZ2VFcnJvcmAgd2l0aCB0aGUgYXBwbGljYWJsZSBlcnJvciBtZXNzYWdlLlxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZXJyb3IodHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoZXJyb3JzW3R5cGVdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgKiBBIGdlbmVyaWMgYEFycmF5I21hcGAgdXRpbGl0eSBmdW5jdGlvbi5cbiAgICAgICAgICAgICAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICAgICAgICAgICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgICAgICAgICAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRoYXQgZ2V0cyBjYWxsZWQgZm9yIGV2ZXJ5IGFycmF5XG4gICAgICAgICAgICAgICAgICAgICAqIGl0ZW0uXG4gICAgICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtBcnJheX0gQSBuZXcgYXJyYXkgb2YgdmFsdWVzIHJldHVybmVkIGJ5IHRoZSBjYWxsYmFjayBmdW5jdGlvbi5cbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIG1hcChhcnJheSwgZm4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsZW5ndGggPSBhcnJheS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAobGVuZ3RoLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbbGVuZ3RoXSA9IGZuKGFycmF5W2xlbmd0aF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgKiBBIHNpbXBsZSBgQXJyYXkjbWFwYC1saWtlIHdyYXBwZXIgdG8gd29yayB3aXRoIGRvbWFpbiBuYW1lIHN0cmluZ3Mgb3IgZW1haWxcbiAgICAgICAgICAgICAgICAgICAgICogYWRkcmVzc2VzLlxuICAgICAgICAgICAgICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gZG9tYWluIFRoZSBkb21haW4gbmFtZSBvciBlbWFpbCBhZGRyZXNzLlxuICAgICAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBUaGUgZnVuY3Rpb24gdGhhdCBnZXRzIGNhbGxlZCBmb3IgZXZlcnlcbiAgICAgICAgICAgICAgICAgICAgICogY2hhcmFjdGVyLlxuICAgICAgICAgICAgICAgICAgICAgKiBAcmV0dXJucyB7QXJyYXl9IEEgbmV3IHN0cmluZyBvZiBjaGFyYWN0ZXJzIHJldHVybmVkIGJ5IHRoZSBjYWxsYmFja1xuICAgICAgICAgICAgICAgICAgICAgKiBmdW5jdGlvbi5cbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIG1hcERvbWFpbihzdHJpbmcsIGZuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFydHMgPSBzdHJpbmcuc3BsaXQoJ0AnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSW4gZW1haWwgYWRkcmVzc2VzLCBvbmx5IHRoZSBkb21haW4gbmFtZSBzaG91bGQgYmUgcHVueWNvZGVkLiBMZWF2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBsb2NhbCBwYXJ0IChpLmUuIGV2ZXJ5dGhpbmcgdXAgdG8gYEBgKSBpbnRhY3QuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gcGFydHNbMF0gKyAnQCc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nID0gcGFydHNbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBdm9pZCBgc3BsaXQocmVnZXgpYCBmb3IgSUU4IGNvbXBhdGliaWxpdHkuIFNlZSAjMTcuXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmcgPSBzdHJpbmcucmVwbGFjZShyZWdleFNlcGFyYXRvcnMsICdcXHgyRScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhYmVscyA9IHN0cmluZy5zcGxpdCgnLicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVuY29kZWQgPSBtYXAobGFiZWxzLCBmbikuam9pbignLicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdCArIGVuY29kZWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICogQ3JlYXRlcyBhbiBhcnJheSBjb250YWluaW5nIHRoZSBudW1lcmljIGNvZGUgcG9pbnRzIG9mIGVhY2ggVW5pY29kZVxuICAgICAgICAgICAgICAgICAgICAgKiBjaGFyYWN0ZXIgaW4gdGhlIHN0cmluZy4gV2hpbGUgSmF2YVNjcmlwdCB1c2VzIFVDUy0yIGludGVybmFsbHksXG4gICAgICAgICAgICAgICAgICAgICAqIHRoaXMgZnVuY3Rpb24gd2lsbCBjb252ZXJ0IGEgcGFpciBvZiBzdXJyb2dhdGUgaGFsdmVzIChlYWNoIG9mIHdoaWNoXG4gICAgICAgICAgICAgICAgICAgICAqIFVDUy0yIGV4cG9zZXMgYXMgc2VwYXJhdGUgY2hhcmFjdGVycykgaW50byBhIHNpbmdsZSBjb2RlIHBvaW50LFxuICAgICAgICAgICAgICAgICAgICAgKiBtYXRjaGluZyBVVEYtMTYuXG4gICAgICAgICAgICAgICAgICAgICAqIEBzZWUgYHB1bnljb2RlLnVjczIuZW5jb2RlYFxuICAgICAgICAgICAgICAgICAgICAgKiBAc2VlIDxodHRwczovL21hdGhpYXNieW5lbnMuYmUvbm90ZXMvamF2YXNjcmlwdC1lbmNvZGluZz5cbiAgICAgICAgICAgICAgICAgICAgICogQG1lbWJlck9mIHB1bnljb2RlLnVjczJcbiAgICAgICAgICAgICAgICAgICAgICogQG5hbWUgZGVjb2RlXG4gICAgICAgICAgICAgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzdHJpbmcgVGhlIFVuaWNvZGUgaW5wdXQgc3RyaW5nIChVQ1MtMikuXG4gICAgICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtBcnJheX0gVGhlIG5ldyBhcnJheSBvZiBjb2RlIHBvaW50cy5cbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHVjczJkZWNvZGUoc3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3V0cHV0ID0gW10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRlciA9IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRyYTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChjb3VudGVyIDwgbGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBzdHJpbmcuY2hhckNvZGVBdChjb3VudGVyKyspO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA+PSAweEQ4MDAgJiYgdmFsdWUgPD0gMHhEQkZGICYmIGNvdW50ZXIgPCBsZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaGlnaCBzdXJyb2dhdGUsIGFuZCB0aGVyZSBpcyBhIG5leHQgY2hhcmFjdGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhID0gc3RyaW5nLmNoYXJDb2RlQXQoY291bnRlcisrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChleHRyYSAmIDB4RkMwMCkgPT0gMHhEQzAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBsb3cgc3Vycm9nYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQucHVzaCgoKHZhbHVlICYgMHgzRkYpIDw8IDEwKSArIChleHRyYSAmIDB4M0ZGKSArIDB4MTAwMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdW5tYXRjaGVkIHN1cnJvZ2F0ZTsgb25seSBhcHBlbmQgdGhpcyBjb2RlIHVuaXQsIGluIGNhc2UgdGhlIG5leHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvZGUgdW5pdCBpcyB0aGUgaGlnaCBzdXJyb2dhdGUgb2YgYSBzdXJyb2dhdGUgcGFpclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0LnB1c2godmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRlci0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0LnB1c2godmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICogQ3JlYXRlcyBhIHN0cmluZyBiYXNlZCBvbiBhbiBhcnJheSBvZiBudW1lcmljIGNvZGUgcG9pbnRzLlxuICAgICAgICAgICAgICAgICAgICAgKiBAc2VlIGBwdW55Y29kZS51Y3MyLmRlY29kZWBcbiAgICAgICAgICAgICAgICAgICAgICogQG1lbWJlck9mIHB1bnljb2RlLnVjczJcbiAgICAgICAgICAgICAgICAgICAgICogQG5hbWUgZW5jb2RlXG4gICAgICAgICAgICAgICAgICAgICAqIEBwYXJhbSB7QXJyYXl9IGNvZGVQb2ludHMgVGhlIGFycmF5IG9mIG51bWVyaWMgY29kZSBwb2ludHMuXG4gICAgICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBuZXcgVW5pY29kZSBzdHJpbmcgKFVDUy0yKS5cbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHVjczJlbmNvZGUoYXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXAoYXJyYXksIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvdXRwdXQgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPiAweEZGRkYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgLT0gMHgxMDAwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0ICs9IHN0cmluZ0Zyb21DaGFyQ29kZSh2YWx1ZSA+Pj4gMTAgJiAweDNGRiB8IDB4RDgwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gMHhEQzAwIHwgdmFsdWUgJiAweDNGRjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0ICs9IHN0cmluZ0Zyb21DaGFyQ29kZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmpvaW4oJycpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAqIENvbnZlcnRzIGEgYmFzaWMgY29kZSBwb2ludCBpbnRvIGEgZGlnaXQvaW50ZWdlci5cbiAgICAgICAgICAgICAgICAgICAgICogQHNlZSBgZGlnaXRUb0Jhc2ljKClgXG4gICAgICAgICAgICAgICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAgICAgICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjb2RlUG9pbnQgVGhlIGJhc2ljIG51bWVyaWMgY29kZSBwb2ludCB2YWx1ZS5cbiAgICAgICAgICAgICAgICAgICAgICogQHJldHVybnMge051bWJlcn0gVGhlIG51bWVyaWMgdmFsdWUgb2YgYSBiYXNpYyBjb2RlIHBvaW50IChmb3IgdXNlIGluXG4gICAgICAgICAgICAgICAgICAgICAqIHJlcHJlc2VudGluZyBpbnRlZ2VycykgaW4gdGhlIHJhbmdlIGAwYCB0byBgYmFzZSAtIDFgLCBvciBgYmFzZWAgaWZcbiAgICAgICAgICAgICAgICAgICAgICogdGhlIGNvZGUgcG9pbnQgZG9lcyBub3QgcmVwcmVzZW50IGEgdmFsdWUuXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBiYXNpY1RvRGlnaXQoY29kZVBvaW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29kZVBvaW50IC0gNDggPCAxMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb2RlUG9pbnQgLSAyMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2RlUG9pbnQgLSA2NSA8IDI2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvZGVQb2ludCAtIDY1O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvZGVQb2ludCAtIDk3IDwgMjYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29kZVBvaW50IC0gOTc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYmFzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgKiBDb252ZXJ0cyBhIGRpZ2l0L2ludGVnZXIgaW50byBhIGJhc2ljIGNvZGUgcG9pbnQuXG4gICAgICAgICAgICAgICAgICAgICAqIEBzZWUgYGJhc2ljVG9EaWdpdCgpYFxuICAgICAgICAgICAgICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gZGlnaXQgVGhlIG51bWVyaWMgdmFsdWUgb2YgYSBiYXNpYyBjb2RlIHBvaW50LlxuICAgICAgICAgICAgICAgICAgICAgKiBAcmV0dXJucyB7TnVtYmVyfSBUaGUgYmFzaWMgY29kZSBwb2ludCB3aG9zZSB2YWx1ZSAod2hlbiB1c2VkIGZvclxuICAgICAgICAgICAgICAgICAgICAgKiByZXByZXNlbnRpbmcgaW50ZWdlcnMpIGlzIGBkaWdpdGAsIHdoaWNoIG5lZWRzIHRvIGJlIGluIHRoZSByYW5nZVxuICAgICAgICAgICAgICAgICAgICAgKiBgMGAgdG8gYGJhc2UgLSAxYC4gSWYgYGZsYWdgIGlzIG5vbi16ZXJvLCB0aGUgdXBwZXJjYXNlIGZvcm0gaXNcbiAgICAgICAgICAgICAgICAgICAgICogdXNlZDsgZWxzZSwgdGhlIGxvd2VyY2FzZSBmb3JtIGlzIHVzZWQuIFRoZSBiZWhhdmlvciBpcyB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgICogaWYgYGZsYWdgIGlzIG5vbi16ZXJvIGFuZCBgZGlnaXRgIGhhcyBubyB1cHBlcmNhc2UgZm9ybS5cbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRpZ2l0VG9CYXNpYyhkaWdpdCwgZmxhZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gIDAuLjI1IG1hcCB0byBBU0NJSSBhLi56IG9yIEEuLlpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDI2Li4zNSBtYXAgdG8gQVNDSUkgMC4uOVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRpZ2l0ICsgMjIgKyA3NSAqIChkaWdpdCA8IDI2KSAtICgoZmxhZyAhPSAwKSA8PCA1KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgKiBCaWFzIGFkYXB0YXRpb24gZnVuY3Rpb24gYXMgcGVyIHNlY3Rpb24gMy40IG9mIFJGQyAzNDkyLlxuICAgICAgICAgICAgICAgICAgICAgKiBodHRwczovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjMzQ5MiNzZWN0aW9uLTMuNFxuICAgICAgICAgICAgICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYWRhcHQoZGVsdGEsIG51bVBvaW50cywgZmlyc3RUaW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgayA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWx0YSA9IGZpcnN0VGltZSA/IGZsb29yKGRlbHRhIC8gZGFtcCkgOiBkZWx0YSA+PiAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGEgKz0gZmxvb3IoZGVsdGEgLyBudW1Qb2ludHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICg7IC8qIG5vIGluaXRpYWxpemF0aW9uICovZGVsdGEgPiBiYXNlTWludXNUTWluICogdE1heCA+PiAxOyBrICs9IGJhc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWx0YSA9IGZsb29yKGRlbHRhIC8gYmFzZU1pbnVzVE1pbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmxvb3IoayArIChiYXNlTWludXNUTWluICsgMSkgKiBkZWx0YSAvIChkZWx0YSArIHNrZXcpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgKiBDb252ZXJ0cyBhIFB1bnljb2RlIHN0cmluZyBvZiBBU0NJSS1vbmx5IHN5bWJvbHMgdG8gYSBzdHJpbmcgb2YgVW5pY29kZVxuICAgICAgICAgICAgICAgICAgICAgKiBzeW1ib2xzLlxuICAgICAgICAgICAgICAgICAgICAgKiBAbWVtYmVyT2YgcHVueWNvZGVcbiAgICAgICAgICAgICAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IFRoZSBQdW55Y29kZSBzdHJpbmcgb2YgQVNDSUktb25seSBzeW1ib2xzLlxuICAgICAgICAgICAgICAgICAgICAgKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgcmVzdWx0aW5nIHN0cmluZyBvZiBVbmljb2RlIHN5bWJvbHMuXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBkZWNvZGUoaW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERvbid0IHVzZSBVQ1MtMlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0TGVuZ3RoID0gaW5wdXQubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID0gMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuID0gaW5pdGlhbE4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmlhcyA9IGluaXRpYWxCaWFzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2ljLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGosXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2xkaSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGssXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlnaXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdCxcblxuICAgICAgICAgICAgICAgICAgICAgICAgLyoqIENhY2hlZCBjYWxjdWxhdGlvbiByZXN1bHRzICovXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXNlTWludXNUO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBIYW5kbGUgdGhlIGJhc2ljIGNvZGUgcG9pbnRzOiBsZXQgYGJhc2ljYCBiZSB0aGUgbnVtYmVyIG9mIGlucHV0IGNvZGVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvaW50cyBiZWZvcmUgdGhlIGxhc3QgZGVsaW1pdGVyLCBvciBgMGAgaWYgdGhlcmUgaXMgbm9uZSwgdGhlbiBjb3B5XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgZmlyc3QgYmFzaWMgY29kZSBwb2ludHMgdG8gdGhlIG91dHB1dC5cblxuICAgICAgICAgICAgICAgICAgICAgICAgYmFzaWMgPSBpbnB1dC5sYXN0SW5kZXhPZihkZWxpbWl0ZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJhc2ljIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2ljID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IGJhc2ljOyArK2opIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiBpdCdzIG5vdCBhIGJhc2ljIGNvZGUgcG9pbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hhckNvZGVBdChqKSA+PSAweDgwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yKCdub3QtYmFzaWMnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0LnB1c2goaW5wdXQuY2hhckNvZGVBdChqKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1haW4gZGVjb2RpbmcgbG9vcDogc3RhcnQganVzdCBhZnRlciB0aGUgbGFzdCBkZWxpbWl0ZXIgaWYgYW55IGJhc2ljIGNvZGVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvaW50cyB3ZXJlIGNvcGllZDsgc3RhcnQgYXQgdGhlIGJlZ2lubmluZyBvdGhlcndpc2UuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaW5kZXggPSBiYXNpYyA+IDAgPyBiYXNpYyArIDEgOiAwOyBpbmRleCA8IGlucHV0TGVuZ3RoOykgLyogbm8gZmluYWwgZXhwcmVzc2lvbiAqL3tcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGBpbmRleGAgaXMgdGhlIGluZGV4IG9mIHRoZSBuZXh0IGNoYXJhY3RlciB0byBiZSBjb25zdW1lZC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBEZWNvZGUgYSBnZW5lcmFsaXplZCB2YXJpYWJsZS1sZW5ndGggaW50ZWdlciBpbnRvIGBkZWx0YWAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2hpY2ggZ2V0cyBhZGRlZCB0byBgaWAuIFRoZSBvdmVyZmxvdyBjaGVja2luZyBpcyBlYXNpZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiB3ZSBpbmNyZWFzZSBgaWAgYXMgd2UgZ28sIHRoZW4gc3VidHJhY3Qgb2ZmIGl0cyBzdGFydGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHZhbHVlIGF0IHRoZSBlbmQgdG8gb2J0YWluIGBkZWx0YWAuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChvbGRpID0gaSwgdyA9IDEsIGsgPSBiYXNlOzsgLyogbm8gY29uZGl0aW9uICovayArPSBiYXNlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID49IGlucHV0TGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcignaW52YWxpZC1pbnB1dCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlnaXQgPSBiYXNpY1RvRGlnaXQoaW5wdXQuY2hhckNvZGVBdChpbmRleCsrKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRpZ2l0ID49IGJhc2UgfHwgZGlnaXQgPiBmbG9vcigobWF4SW50IC0gaSkgLyB3KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IoJ292ZXJmbG93Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpICs9IGRpZ2l0ICogdztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdCA9IGsgPD0gYmlhcyA/IHRNaW4gOiBrID49IGJpYXMgKyB0TWF4ID8gdE1heCA6IGsgLSBiaWFzO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkaWdpdCA8IHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZU1pbnVzVCA9IGJhc2UgLSB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodyA+IGZsb29yKG1heEludCAvIGJhc2VNaW51c1QpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcignb3ZlcmZsb3cnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHcgKj0gYmFzZU1pbnVzVDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXQgPSBvdXRwdXQubGVuZ3RoICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaWFzID0gYWRhcHQoaSAtIG9sZGksIG91dCwgb2xkaSA9PSAwKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGBpYCB3YXMgc3VwcG9zZWQgdG8gd3JhcCBhcm91bmQgZnJvbSBgb3V0YCB0byBgMGAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW5jcmVtZW50aW5nIGBuYCBlYWNoIHRpbWUsIHNvIHdlJ2xsIGZpeCB0aGF0IG5vdzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmxvb3IoaSAvIG91dCkgPiBtYXhJbnQgLSBuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yKCdvdmVyZmxvdycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4gKz0gZmxvb3IoaSAvIG91dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaSAlPSBvdXQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbnNlcnQgYG5gIGF0IHBvc2l0aW9uIGBpYCBvZiB0aGUgb3V0cHV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0LnNwbGljZShpKyssIDAsIG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdWNzMmVuY29kZShvdXRwdXQpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAqIENvbnZlcnRzIGEgc3RyaW5nIG9mIFVuaWNvZGUgc3ltYm9scyAoZS5nLiBhIGRvbWFpbiBuYW1lIGxhYmVsKSB0byBhXG4gICAgICAgICAgICAgICAgICAgICAqIFB1bnljb2RlIHN0cmluZyBvZiBBU0NJSS1vbmx5IHN5bWJvbHMuXG4gICAgICAgICAgICAgICAgICAgICAqIEBtZW1iZXJPZiBwdW55Y29kZVxuICAgICAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gaW5wdXQgVGhlIHN0cmluZyBvZiBVbmljb2RlIHN5bWJvbHMuXG4gICAgICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSByZXN1bHRpbmcgUHVueWNvZGUgc3RyaW5nIG9mIEFTQ0lJLW9ubHkgc3ltYm9scy5cbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGVuY29kZShpbnB1dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlZENQQ291bnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzaWNMZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmlhcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IFtdLFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvKiogYGlucHV0TGVuZ3RoYCB3aWxsIGhvbGQgdGhlIG51bWJlciBvZiBjb2RlIHBvaW50cyBpbiBgaW5wdXRgLiAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRMZW5ndGgsXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8qKiBDYWNoZWQgY2FsY3VsYXRpb24gcmVzdWx0cyAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlZENQQ291bnRQbHVzT25lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VNaW51c1QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcU1pbnVzVDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29udmVydCB0aGUgaW5wdXQgaW4gVUNTLTIgdG8gVW5pY29kZVxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQgPSB1Y3MyZGVjb2RlKGlucHV0KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2FjaGUgdGhlIGxlbmd0aFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRMZW5ndGggPSBpbnB1dC5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEluaXRpYWxpemUgdGhlIHN0YXRlXG4gICAgICAgICAgICAgICAgICAgICAgICBuID0gaW5pdGlhbE47XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWx0YSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBiaWFzID0gaW5pdGlhbEJpYXM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhhbmRsZSB0aGUgYmFzaWMgY29kZSBwb2ludHNcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBpbnB1dExlbmd0aDsgKytqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFZhbHVlID0gaW5wdXRbal07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZSA8IDB4ODApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0LnB1c2goc3RyaW5nRnJvbUNoYXJDb2RlKGN1cnJlbnRWYWx1ZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlZENQQ291bnQgPSBiYXNpY0xlbmd0aCA9IG91dHB1dC5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGBoYW5kbGVkQ1BDb3VudGAgaXMgdGhlIG51bWJlciBvZiBjb2RlIHBvaW50cyB0aGF0IGhhdmUgYmVlbiBoYW5kbGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYGJhc2ljTGVuZ3RoYCBpcyB0aGUgbnVtYmVyIG9mIGJhc2ljIGNvZGUgcG9pbnRzLlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5pc2ggdGhlIGJhc2ljIHN0cmluZyAtIGlmIGl0IGlzIG5vdCBlbXB0eSAtIHdpdGggYSBkZWxpbWl0ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiYXNpY0xlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dC5wdXNoKGRlbGltaXRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1haW4gZW5jb2RpbmcgbG9vcDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChoYW5kbGVkQ1BDb3VudCA8IGlucHV0TGVuZ3RoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBbGwgbm9uLWJhc2ljIGNvZGUgcG9pbnRzIDwgbiBoYXZlIGJlZW4gaGFuZGxlZCBhbHJlYWR5LiBGaW5kIHRoZSBuZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbGFyZ2VyIG9uZTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKG0gPSBtYXhJbnQsIGogPSAwOyBqIDwgaW5wdXRMZW5ndGg7ICsraikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VmFsdWUgPSBpbnB1dFtqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZSA+PSBuICYmIGN1cnJlbnRWYWx1ZSA8IG0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0gPSBjdXJyZW50VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbmNyZWFzZSBgZGVsdGFgIGVub3VnaCB0byBhZHZhbmNlIHRoZSBkZWNvZGVyJ3MgPG4saT4gc3RhdGUgdG8gPG0sMD4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYnV0IGd1YXJkIGFnYWluc3Qgb3ZlcmZsb3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVkQ1BDb3VudFBsdXNPbmUgPSBoYW5kbGVkQ1BDb3VudCArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG0gLSBuID4gZmxvb3IoKG1heEludCAtIGRlbHRhKSAvIGhhbmRsZWRDUENvdW50UGx1c09uZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IoJ292ZXJmbG93Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGEgKz0gKG0gLSBuKSAqIGhhbmRsZWRDUENvdW50UGx1c09uZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuID0gbTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBpbnB1dExlbmd0aDsgKytqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRWYWx1ZSA9IGlucHV0W2pdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWUgPCBuICYmICsrZGVsdGEgPiBtYXhJbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yKCdvdmVyZmxvdycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZSA9PSBuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXByZXNlbnQgZGVsdGEgYXMgYSBnZW5lcmFsaXplZCB2YXJpYWJsZS1sZW5ndGggaW50ZWdlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChxID0gZGVsdGEsIGsgPSBiYXNlOzsgLyogbm8gY29uZGl0aW9uICovayArPSBiYXNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdCA9IGsgPD0gYmlhcyA/IHRNaW4gOiBrID49IGJpYXMgKyB0TWF4ID8gdE1heCA6IGsgLSBiaWFzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxIDwgdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcU1pbnVzVCA9IHEgLSB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VNaW51c1QgPSBiYXNlIC0gdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChzdHJpbmdGcm9tQ2hhckNvZGUoZGlnaXRUb0Jhc2ljKHQgKyBxTWludXNUICUgYmFzZU1pbnVzVCwgMCkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxID0gZmxvb3IocU1pbnVzVCAvIGJhc2VNaW51c1QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChzdHJpbmdGcm9tQ2hhckNvZGUoZGlnaXRUb0Jhc2ljKHEsIDApKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaWFzID0gYWRhcHQoZGVsdGEsIGhhbmRsZWRDUENvdW50UGx1c09uZSwgaGFuZGxlZENQQ291bnQgPT0gYmFzaWNMZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGEgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKytoYW5kbGVkQ1BDb3VudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICsrZGVsdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKytuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG91dHB1dC5qb2luKCcnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgKiBDb252ZXJ0cyBhIFB1bnljb2RlIHN0cmluZyByZXByZXNlbnRpbmcgYSBkb21haW4gbmFtZSBvciBhbiBlbWFpbCBhZGRyZXNzXG4gICAgICAgICAgICAgICAgICAgICAqIHRvIFVuaWNvZGUuIE9ubHkgdGhlIFB1bnljb2RlZCBwYXJ0cyBvZiB0aGUgaW5wdXQgd2lsbCBiZSBjb252ZXJ0ZWQsIGkuZS5cbiAgICAgICAgICAgICAgICAgICAgICogaXQgZG9lc24ndCBtYXR0ZXIgaWYgeW91IGNhbGwgaXQgb24gYSBzdHJpbmcgdGhhdCBoYXMgYWxyZWFkeSBiZWVuXG4gICAgICAgICAgICAgICAgICAgICAqIGNvbnZlcnRlZCB0byBVbmljb2RlLlxuICAgICAgICAgICAgICAgICAgICAgKiBAbWVtYmVyT2YgcHVueWNvZGVcbiAgICAgICAgICAgICAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IFRoZSBQdW55Y29kZWQgZG9tYWluIG5hbWUgb3IgZW1haWwgYWRkcmVzcyB0b1xuICAgICAgICAgICAgICAgICAgICAgKiBjb252ZXJ0IHRvIFVuaWNvZGUuXG4gICAgICAgICAgICAgICAgICAgICAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBVbmljb2RlIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBnaXZlbiBQdW55Y29kZVxuICAgICAgICAgICAgICAgICAgICAgKiBzdHJpbmcuXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB0b1VuaWNvZGUoaW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtYXBEb21haW4oaW5wdXQsIGZ1bmN0aW9uIChzdHJpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZXhQdW55Y29kZS50ZXN0KHN0cmluZykgPyBkZWNvZGUoc3RyaW5nLnNsaWNlKDQpLnRvTG93ZXJDYXNlKCkpIDogc3RyaW5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICogQ29udmVydHMgYSBVbmljb2RlIHN0cmluZyByZXByZXNlbnRpbmcgYSBkb21haW4gbmFtZSBvciBhbiBlbWFpbCBhZGRyZXNzIHRvXG4gICAgICAgICAgICAgICAgICAgICAqIFB1bnljb2RlLiBPbmx5IHRoZSBub24tQVNDSUkgcGFydHMgb2YgdGhlIGRvbWFpbiBuYW1lIHdpbGwgYmUgY29udmVydGVkLFxuICAgICAgICAgICAgICAgICAgICAgKiBpLmUuIGl0IGRvZXNuJ3QgbWF0dGVyIGlmIHlvdSBjYWxsIGl0IHdpdGggYSBkb21haW4gdGhhdCdzIGFscmVhZHkgaW5cbiAgICAgICAgICAgICAgICAgICAgICogQVNDSUkuXG4gICAgICAgICAgICAgICAgICAgICAqIEBtZW1iZXJPZiBwdW55Y29kZVxuICAgICAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gaW5wdXQgVGhlIGRvbWFpbiBuYW1lIG9yIGVtYWlsIGFkZHJlc3MgdG8gY29udmVydCwgYXMgYVxuICAgICAgICAgICAgICAgICAgICAgKiBVbmljb2RlIHN0cmluZy5cbiAgICAgICAgICAgICAgICAgICAgICogQHJldHVybnMge1N0cmluZ30gVGhlIFB1bnljb2RlIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBnaXZlbiBkb21haW4gbmFtZSBvclxuICAgICAgICAgICAgICAgICAgICAgKiBlbWFpbCBhZGRyZXNzLlxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gdG9BU0NJSShpbnB1dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hcERvbWFpbihpbnB1dCwgZnVuY3Rpb24gKHN0cmluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdleE5vbkFTQ0lJLnRlc3Qoc3RyaW5nKSA/ICd4bi0tJyArIGVuY29kZShzdHJpbmcpIDogc3RyaW5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgICAgICAgICAgICAgICAgICAvKiogRGVmaW5lIHRoZSBwdWJsaWMgQVBJICovXG4gICAgICAgICAgICAgICAgICAgIHB1bnljb2RlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAgICAgKiBBIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIGN1cnJlbnQgUHVueWNvZGUuanMgdmVyc2lvbiBudW1iZXIuXG4gICAgICAgICAgICAgICAgICAgICAgICAgKiBAbWVtYmVyT2YgcHVueWNvZGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAqIEB0eXBlIFN0cmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICAndmVyc2lvbic6ICcxLjQuMScsXG4gICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAqIEFuIG9iamVjdCBvZiBtZXRob2RzIHRvIGNvbnZlcnQgZnJvbSBKYXZhU2NyaXB0J3MgaW50ZXJuYWwgY2hhcmFjdGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgKiByZXByZXNlbnRhdGlvbiAoVUNTLTIpIHRvIFVuaWNvZGUgY29kZSBwb2ludHMsIGFuZCBiYWNrLlxuICAgICAgICAgICAgICAgICAgICAgICAgICogQHNlZSA8aHR0cHM6Ly9tYXRoaWFzYnluZW5zLmJlL25vdGVzL2phdmFzY3JpcHQtZW5jb2Rpbmc+XG4gICAgICAgICAgICAgICAgICAgICAgICAgKiBAbWVtYmVyT2YgcHVueWNvZGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAqIEB0eXBlIE9iamVjdFxuICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICAndWNzMic6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGVjb2RlJzogdWNzMmRlY29kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZW5jb2RlJzogdWNzMmVuY29kZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICdkZWNvZGUnOiBkZWNvZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnZW5jb2RlJzogZW5jb2RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3RvQVNDSUknOiB0b0FTQ0lJLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3RvVW5pY29kZSc6IHRvVW5pY29kZVxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIC8qKiBFeHBvc2UgYHB1bnljb2RlYCAqL1xuICAgICAgICAgICAgICAgICAgICAvLyBTb21lIEFNRCBidWlsZCBvcHRpbWl6ZXJzLCBsaWtlIHIuanMsIGNoZWNrIGZvciBzcGVjaWZpYyBjb25kaXRpb24gcGF0dGVybnNcbiAgICAgICAgICAgICAgICAgICAgLy8gbGlrZSB0aGUgZm9sbG93aW5nOlxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRlZmluZSA9PSAnZnVuY3Rpb24nICYmIF90eXBlb2YoZGVmaW5lLmFtZCkgPT0gJ29iamVjdCcgJiYgZGVmaW5lLmFtZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmaW5lKCdwdW55Y29kZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHVueWNvZGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmcmVlRXhwb3J0cyAmJiBmcmVlTW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kdWxlLmV4cG9ydHMgPT0gZnJlZUV4cG9ydHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbiBOb2RlLmpzLCBpby5qcywgb3IgUmluZ29KUyB2MC44LjArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJlZU1vZHVsZS5leHBvcnRzID0gcHVueWNvZGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGluIE5hcndoYWwgb3IgUmluZ29KUyB2MC43LjAtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChrZXkgaW4gcHVueWNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVueWNvZGUuaGFzT3duUHJvcGVydHkoa2V5KSAmJiAoZnJlZUV4cG9ydHNba2V5XSA9IHB1bnljb2RlW2tleV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGluIFJoaW5vIG9yIGEgd2ViIGJyb3dzZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvb3QucHVueWNvZGUgPSBwdW55Y29kZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pKHRoaXMpO1xuICAgICAgICAgICAgfSkuY2FsbCh0aGlzLCB0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHt9KTtcbiAgICAgICAgfSwge31dLCAyOiBbZnVuY3Rpb24gKHJlcXVpcmUsIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgICAgICAgLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuXG4gICAgICAgICAgICAvL1xuICAgICAgICAgICAgLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGFcbiAgICAgICAgICAgIC8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGVcbiAgICAgICAgICAgIC8vIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZ1xuICAgICAgICAgICAgLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuICAgICAgICAgICAgLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdFxuICAgICAgICAgICAgLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlXG4gICAgICAgICAgICAvLyBmb2xsb3dpbmcgY29uZGl0aW9uczpcbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZFxuICAgICAgICAgICAgLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gICAgICAgICAgICAvL1xuICAgICAgICAgICAgLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTU1xuICAgICAgICAgICAgLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRlxuICAgICAgICAgICAgLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTlxuICAgICAgICAgICAgLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4gICAgICAgICAgICAvLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1JcbiAgICAgICAgICAgIC8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEVcbiAgICAgICAgICAgIC8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbiAgICAgICAgICAgICd1c2Ugc3RyaWN0JztcblxuICAgICAgICAgICAgLy8gSWYgb2JqLmhhc093blByb3BlcnR5IGhhcyBiZWVuIG92ZXJyaWRkZW4sIHRoZW4gY2FsbGluZ1xuICAgICAgICAgICAgLy8gb2JqLmhhc093blByb3BlcnR5KHByb3ApIHdpbGwgYnJlYWsuXG4gICAgICAgICAgICAvLyBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9qb3llbnQvbm9kZS9pc3N1ZXMvMTcwN1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBoYXNPd25Qcm9wZXJ0eShvYmosIHByb3ApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKHFzLCBzZXAsIGVxLCBvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgc2VwID0gc2VwIHx8ICcmJztcbiAgICAgICAgICAgICAgICBlcSA9IGVxIHx8ICc9JztcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0ge307XG5cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHFzICE9PSAnc3RyaW5nJyB8fCBxcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcmVnZXhwID0gL1xcKy9nO1xuICAgICAgICAgICAgICAgIHFzID0gcXMuc3BsaXQoc2VwKTtcblxuICAgICAgICAgICAgICAgIHZhciBtYXhLZXlzID0gMTAwMDtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucyAmJiB0eXBlb2Ygb3B0aW9ucy5tYXhLZXlzID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgICAgICBtYXhLZXlzID0gb3B0aW9ucy5tYXhLZXlzO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBsZW4gPSBxcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgLy8gbWF4S2V5cyA8PSAwIG1lYW5zIHRoYXQgd2Ugc2hvdWxkIG5vdCBsaW1pdCBrZXlzIGNvdW50XG4gICAgICAgICAgICAgICAgaWYgKG1heEtleXMgPiAwICYmIGxlbiA+IG1heEtleXMpIHtcbiAgICAgICAgICAgICAgICAgICAgbGVuID0gbWF4S2V5cztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB4ID0gcXNbaV0ucmVwbGFjZShyZWdleHAsICclMjAnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkeCA9IHguaW5kZXhPZihlcSksXG4gICAgICAgICAgICAgICAgICAgICAgICBrc3RyLFxuICAgICAgICAgICAgICAgICAgICAgICAgdnN0cixcbiAgICAgICAgICAgICAgICAgICAgICAgIGssXG4gICAgICAgICAgICAgICAgICAgICAgICB2O1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpZHggPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAga3N0ciA9IHguc3Vic3RyKDAsIGlkeCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2c3RyID0geC5zdWJzdHIoaWR4ICsgMSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBrc3RyID0geDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZzdHIgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGsgPSBkZWNvZGVVUklDb21wb25lbnQoa3N0cik7XG4gICAgICAgICAgICAgICAgICAgIHYgPSBkZWNvZGVVUklDb21wb25lbnQodnN0cik7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFoYXNPd25Qcm9wZXJ0eShvYmosIGspKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmpba10gPSB2O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlzQXJyYXkob2JqW2tdKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqW2tdLnB1c2godik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmpba10gPSBbb2JqW2tdLCB2XTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gKHhzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh4cykgPT09ICdbb2JqZWN0IEFycmF5XSc7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9LCB7fV0sIDM6IFtmdW5jdGlvbiAocmVxdWlyZSwgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICAgICAgICAvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy5cbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAvLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYVxuICAgICAgICAgICAgLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZVxuICAgICAgICAgICAgLy8gXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nXG4gICAgICAgICAgICAvLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsXG4gICAgICAgICAgICAvLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0XG4gICAgICAgICAgICAvLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGVcbiAgICAgICAgICAgIC8vIGZvbGxvd2luZyBjb25kaXRpb25zOlxuICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIC8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkXG4gICAgICAgICAgICAvLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAvLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTXG4gICAgICAgICAgICAvLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GXG4gICAgICAgICAgICAvLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOXG4gICAgICAgICAgICAvLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbiAgICAgICAgICAgIC8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUlxuICAgICAgICAgICAgLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRVxuICAgICAgICAgICAgLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxuICAgICAgICAgICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgICAgICAgICB2YXIgc3RyaW5naWZ5UHJpbWl0aXZlID0gZnVuY3Rpb24gc3RyaW5naWZ5UHJpbWl0aXZlKHYpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHR5cGVvZiB2ID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2YodikpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3RyaW5nJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2O1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHYgPyAndHJ1ZScgOiAnZmFsc2UnO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ251bWJlcic6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNGaW5pdGUodikgPyB2IDogJyc7XG5cbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChvYmosIHNlcCwgZXEsIG5hbWUpIHtcbiAgICAgICAgICAgICAgICBzZXAgPSBzZXAgfHwgJyYnO1xuICAgICAgICAgICAgICAgIGVxID0gZXEgfHwgJz0nO1xuICAgICAgICAgICAgICAgIGlmIChvYmogPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgb2JqID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICgodHlwZW9mIG9iaiA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKG9iaikpID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWFwKG9iamVjdEtleXMob2JqKSwgZnVuY3Rpb24gKGspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrcyA9IGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUoaykpICsgZXE7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNBcnJheShvYmpba10pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hcChvYmpba10sIGZ1bmN0aW9uICh2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBrcyArIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUodikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmpvaW4oc2VwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtzICsgZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShvYmpba10pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSkuam9pbihzZXApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghbmFtZSkgcmV0dXJuICcnO1xuICAgICAgICAgICAgICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKG5hbWUpKSArIGVxICsgZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShvYmopKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBpc0FycmF5ID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAoeHMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHhzKSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIG1hcCh4cywgZikge1xuICAgICAgICAgICAgICAgIGlmICh4cy5tYXApIHJldHVybiB4cy5tYXAoZik7XG4gICAgICAgICAgICAgICAgdmFyIHJlcyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgeHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzLnB1c2goZih4c1tpXSwgaSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgb2JqZWN0S2V5cyA9IE9iamVjdC5rZXlzIHx8IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgcmVzLnB1c2goa2V5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sIHt9XSwgNDogW2Z1bmN0aW9uIChyZXF1aXJlLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgICAgICAgICd1c2Ugc3RyaWN0JztcblxuICAgICAgICAgICAgZXhwb3J0cy5kZWNvZGUgPSBleHBvcnRzLnBhcnNlID0gcmVxdWlyZSgnLi9kZWNvZGUnKTtcbiAgICAgICAgICAgIGV4cG9ydHMuZW5jb2RlID0gZXhwb3J0cy5zdHJpbmdpZnkgPSByZXF1aXJlKCcuL2VuY29kZScpO1xuICAgICAgICB9LCB7IFwiLi9kZWNvZGVcIjogMiwgXCIuL2VuY29kZVwiOiAzIH1dLCA1OiBbZnVuY3Rpb24gKHJlcXVpcmUsIG1vZHVsZSwgZXhwb3J0cykge1xuICAgICAgICAgICAgLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuXG4gICAgICAgICAgICAvL1xuICAgICAgICAgICAgLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGFcbiAgICAgICAgICAgIC8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGVcbiAgICAgICAgICAgIC8vIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZ1xuICAgICAgICAgICAgLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuICAgICAgICAgICAgLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdFxuICAgICAgICAgICAgLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlXG4gICAgICAgICAgICAvLyBmb2xsb3dpbmcgY29uZGl0aW9uczpcbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAvLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZFxuICAgICAgICAgICAgLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gICAgICAgICAgICAvL1xuICAgICAgICAgICAgLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTU1xuICAgICAgICAgICAgLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRlxuICAgICAgICAgICAgLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTlxuICAgICAgICAgICAgLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4gICAgICAgICAgICAvLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1JcbiAgICAgICAgICAgIC8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEVcbiAgICAgICAgICAgIC8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbiAgICAgICAgICAgICd1c2Ugc3RyaWN0JztcblxuICAgICAgICAgICAgdmFyIHB1bnljb2RlID0gcmVxdWlyZSgncHVueWNvZGUnKTtcbiAgICAgICAgICAgIHZhciB1dGlsID0gcmVxdWlyZSgnLi91dGlsJyk7XG5cbiAgICAgICAgICAgIGV4cG9ydHMucGFyc2UgPSB1cmxQYXJzZTtcbiAgICAgICAgICAgIGV4cG9ydHMucmVzb2x2ZSA9IHVybFJlc29sdmU7XG4gICAgICAgICAgICBleHBvcnRzLnJlc29sdmVPYmplY3QgPSB1cmxSZXNvbHZlT2JqZWN0O1xuICAgICAgICAgICAgZXhwb3J0cy5mb3JtYXQgPSB1cmxGb3JtYXQ7XG5cbiAgICAgICAgICAgIGV4cG9ydHMuVXJsID0gVXJsO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBVcmwoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm90b2NvbCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5zbGFzaGVzID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLmF1dGggPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuaG9zdCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5wb3J0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLmhvc3RuYW1lID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLmhhc2ggPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLnBhdGhuYW1lID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLnBhdGggPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuaHJlZiA9IG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFJlZmVyZW5jZTogUkZDIDM5ODYsIFJGQyAxODA4LCBSRkMgMjM5NlxuXG4gICAgICAgICAgICAvLyBkZWZpbmUgdGhlc2UgaGVyZSBzbyBhdCBsZWFzdCB0aGV5IG9ubHkgaGF2ZSB0byBiZVxuICAgICAgICAgICAgLy8gY29tcGlsZWQgb25jZSBvbiB0aGUgZmlyc3QgbW9kdWxlIGxvYWQuXG4gICAgICAgICAgICB2YXIgcHJvdG9jb2xQYXR0ZXJuID0gL14oW2EtejAtOS4rLV0rOikvaSxcbiAgICAgICAgICAgICAgICBwb3J0UGF0dGVybiA9IC86WzAtOV0qJC8sXG5cblxuICAgICAgICAgICAgLy8gU3BlY2lhbCBjYXNlIGZvciBhIHNpbXBsZSBwYXRoIFVSTFxuICAgICAgICAgICAgc2ltcGxlUGF0aFBhdHRlcm4gPSAvXihcXC9cXC8/KD8hXFwvKVteXFw/XFxzXSopKFxcP1teXFxzXSopPyQvLFxuXG5cbiAgICAgICAgICAgIC8vIFJGQyAyMzk2OiBjaGFyYWN0ZXJzIHJlc2VydmVkIGZvciBkZWxpbWl0aW5nIFVSTHMuXG4gICAgICAgICAgICAvLyBXZSBhY3R1YWxseSBqdXN0IGF1dG8tZXNjYXBlIHRoZXNlLlxuICAgICAgICAgICAgZGVsaW1zID0gWyc8JywgJz4nLCAnXCInLCAnYCcsICcgJywgJ1xccicsICdcXG4nLCAnXFx0J10sXG5cblxuICAgICAgICAgICAgLy8gUkZDIDIzOTY6IGNoYXJhY3RlcnMgbm90IGFsbG93ZWQgZm9yIHZhcmlvdXMgcmVhc29ucy5cbiAgICAgICAgICAgIHVud2lzZSA9IFsneycsICd9JywgJ3wnLCAnXFxcXCcsICdeJywgJ2AnXS5jb25jYXQoZGVsaW1zKSxcblxuXG4gICAgICAgICAgICAvLyBBbGxvd2VkIGJ5IFJGQ3MsIGJ1dCBjYXVzZSBvZiBYU1MgYXR0YWNrcy4gIEFsd2F5cyBlc2NhcGUgdGhlc2UuXG4gICAgICAgICAgICBhdXRvRXNjYXBlID0gWydcXCcnXS5jb25jYXQodW53aXNlKSxcblxuICAgICAgICAgICAgLy8gQ2hhcmFjdGVycyB0aGF0IGFyZSBuZXZlciBldmVyIGFsbG93ZWQgaW4gYSBob3N0bmFtZS5cbiAgICAgICAgICAgIC8vIE5vdGUgdGhhdCBhbnkgaW52YWxpZCBjaGFycyBhcmUgYWxzbyBoYW5kbGVkLCBidXQgdGhlc2VcbiAgICAgICAgICAgIC8vIGFyZSB0aGUgb25lcyB0aGF0IGFyZSAqZXhwZWN0ZWQqIHRvIGJlIHNlZW4sIHNvIHdlIGZhc3QtcGF0aFxuICAgICAgICAgICAgLy8gdGhlbS5cbiAgICAgICAgICAgIG5vbkhvc3RDaGFycyA9IFsnJScsICcvJywgJz8nLCAnOycsICcjJ10uY29uY2F0KGF1dG9Fc2NhcGUpLFxuICAgICAgICAgICAgICAgIGhvc3RFbmRpbmdDaGFycyA9IFsnLycsICc/JywgJyMnXSxcbiAgICAgICAgICAgICAgICBob3N0bmFtZU1heExlbiA9IDI1NSxcbiAgICAgICAgICAgICAgICBob3N0bmFtZVBhcnRQYXR0ZXJuID0gL15bK2EtejAtOUEtWl8tXXswLDYzfSQvLFxuICAgICAgICAgICAgICAgIGhvc3RuYW1lUGFydFN0YXJ0ID0gL14oWythLXowLTlBLVpfLV17MCw2M30pKC4qKSQvLFxuXG4gICAgICAgICAgICAvLyBwcm90b2NvbHMgdGhhdCBjYW4gYWxsb3cgXCJ1bnNhZmVcIiBhbmQgXCJ1bndpc2VcIiBjaGFycy5cbiAgICAgICAgICAgIHVuc2FmZVByb3RvY29sID0ge1xuICAgICAgICAgICAgICAgICdqYXZhc2NyaXB0JzogdHJ1ZSxcbiAgICAgICAgICAgICAgICAnamF2YXNjcmlwdDonOiB0cnVlXG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAvLyBwcm90b2NvbHMgdGhhdCBuZXZlciBoYXZlIGEgaG9zdG5hbWUuXG4gICAgICAgICAgICBob3N0bGVzc1Byb3RvY29sID0ge1xuICAgICAgICAgICAgICAgICdqYXZhc2NyaXB0JzogdHJ1ZSxcbiAgICAgICAgICAgICAgICAnamF2YXNjcmlwdDonOiB0cnVlXG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAvLyBwcm90b2NvbHMgdGhhdCBhbHdheXMgY29udGFpbiBhIC8vIGJpdC5cbiAgICAgICAgICAgIHNsYXNoZWRQcm90b2NvbCA9IHtcbiAgICAgICAgICAgICAgICAnaHR0cCc6IHRydWUsXG4gICAgICAgICAgICAgICAgJ2h0dHBzJzogdHJ1ZSxcbiAgICAgICAgICAgICAgICAnZnRwJzogdHJ1ZSxcbiAgICAgICAgICAgICAgICAnZ29waGVyJzogdHJ1ZSxcbiAgICAgICAgICAgICAgICAnZmlsZSc6IHRydWUsXG4gICAgICAgICAgICAgICAgJ2h0dHA6JzogdHJ1ZSxcbiAgICAgICAgICAgICAgICAnaHR0cHM6JzogdHJ1ZSxcbiAgICAgICAgICAgICAgICAnZnRwOic6IHRydWUsXG4gICAgICAgICAgICAgICAgJ2dvcGhlcjonOiB0cnVlLFxuICAgICAgICAgICAgICAgICdmaWxlOic6IHRydWVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcXVlcnlzdHJpbmcgPSByZXF1aXJlKCdxdWVyeXN0cmluZycpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiB1cmxQYXJzZSh1cmwsIHBhcnNlUXVlcnlTdHJpbmcsIHNsYXNoZXNEZW5vdGVIb3N0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHVybCAmJiB1dGlsLmlzT2JqZWN0KHVybCkgJiYgdXJsIGluc3RhbmNlb2YgVXJsKSByZXR1cm4gdXJsO1xuXG4gICAgICAgICAgICAgICAgdmFyIHUgPSBuZXcgVXJsKCk7XG4gICAgICAgICAgICAgICAgdS5wYXJzZSh1cmwsIHBhcnNlUXVlcnlTdHJpbmcsIHNsYXNoZXNEZW5vdGVIb3N0KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgVXJsLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uICh1cmwsIHBhcnNlUXVlcnlTdHJpbmcsIHNsYXNoZXNEZW5vdGVIb3N0KSB7XG4gICAgICAgICAgICAgICAgaWYgKCF1dGlsLmlzU3RyaW5nKHVybCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlBhcmFtZXRlciAndXJsJyBtdXN0IGJlIGEgc3RyaW5nLCBub3QgXCIgKyAodHlwZW9mIHVybCA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKHVybCkpKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBDb3B5IGNocm9tZSwgSUUsIG9wZXJhIGJhY2tzbGFzaC1oYW5kbGluZyBiZWhhdmlvci5cbiAgICAgICAgICAgICAgICAvLyBCYWNrIHNsYXNoZXMgYmVmb3JlIHRoZSBxdWVyeSBzdHJpbmcgZ2V0IGNvbnZlcnRlZCB0byBmb3J3YXJkIHNsYXNoZXNcbiAgICAgICAgICAgICAgICAvLyBTZWU6IGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD0yNTkxNlxuICAgICAgICAgICAgICAgIHZhciBxdWVyeUluZGV4ID0gdXJsLmluZGV4T2YoJz8nKSxcbiAgICAgICAgICAgICAgICAgICAgc3BsaXR0ZXIgPSBxdWVyeUluZGV4ICE9PSAtMSAmJiBxdWVyeUluZGV4IDwgdXJsLmluZGV4T2YoJyMnKSA/ICc/JyA6ICcjJyxcbiAgICAgICAgICAgICAgICAgICAgdVNwbGl0ID0gdXJsLnNwbGl0KHNwbGl0dGVyKSxcbiAgICAgICAgICAgICAgICAgICAgc2xhc2hSZWdleCA9IC9cXFxcL2c7XG4gICAgICAgICAgICAgICAgdVNwbGl0WzBdID0gdVNwbGl0WzBdLnJlcGxhY2Uoc2xhc2hSZWdleCwgJy8nKTtcbiAgICAgICAgICAgICAgICB1cmwgPSB1U3BsaXQuam9pbihzcGxpdHRlcik7XG5cbiAgICAgICAgICAgICAgICB2YXIgcmVzdCA9IHVybDtcblxuICAgICAgICAgICAgICAgIC8vIHRyaW0gYmVmb3JlIHByb2NlZWRpbmcuXG4gICAgICAgICAgICAgICAgLy8gVGhpcyBpcyB0byBzdXBwb3J0IHBhcnNlIHN0dWZmIGxpa2UgXCIgIGh0dHA6Ly9mb28uY29tICBcXG5cIlxuICAgICAgICAgICAgICAgIHJlc3QgPSByZXN0LnRyaW0oKTtcblxuICAgICAgICAgICAgICAgIGlmICghc2xhc2hlc0Rlbm90ZUhvc3QgJiYgdXJsLnNwbGl0KCcjJykubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRyeSBmYXN0IHBhdGggcmVnZXhwXG4gICAgICAgICAgICAgICAgICAgIHZhciBzaW1wbGVQYXRoID0gc2ltcGxlUGF0aFBhdHRlcm4uZXhlYyhyZXN0KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNpbXBsZVBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGF0aCA9IHJlc3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhyZWYgPSByZXN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXRobmFtZSA9IHNpbXBsZVBhdGhbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2ltcGxlUGF0aFsyXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoID0gc2ltcGxlUGF0aFsyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyc2VRdWVyeVN0cmluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5ID0gcXVlcnlzdHJpbmcucGFyc2UodGhpcy5zZWFyY2guc3Vic3RyKDEpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5ID0gdGhpcy5zZWFyY2guc3Vic3RyKDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGFyc2VRdWVyeVN0cmluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVyeSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcHJvdG8gPSBwcm90b2NvbFBhdHRlcm4uZXhlYyhyZXN0KTtcbiAgICAgICAgICAgICAgICBpZiAocHJvdG8pIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvdG8gPSBwcm90b1swXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvd2VyUHJvdG8gPSBwcm90by50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3RvY29sID0gbG93ZXJQcm90bztcbiAgICAgICAgICAgICAgICAgICAgcmVzdCA9IHJlc3Quc3Vic3RyKHByb3RvLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gZmlndXJlIG91dCBpZiBpdCdzIGdvdCBhIGhvc3RcbiAgICAgICAgICAgICAgICAvLyB1c2VyQHNlcnZlciBpcyAqYWx3YXlzKiBpbnRlcnByZXRlZCBhcyBhIGhvc3RuYW1lLCBhbmQgdXJsXG4gICAgICAgICAgICAgICAgLy8gcmVzb2x1dGlvbiB3aWxsIHRyZWF0IC8vZm9vL2JhciBhcyBob3N0PWZvbyxwYXRoPWJhciBiZWNhdXNlIHRoYXQnc1xuICAgICAgICAgICAgICAgIC8vIGhvdyB0aGUgYnJvd3NlciByZXNvbHZlcyByZWxhdGl2ZSBVUkxzLlxuICAgICAgICAgICAgICAgIGlmIChzbGFzaGVzRGVub3RlSG9zdCB8fCBwcm90byB8fCByZXN0Lm1hdGNoKC9eXFwvXFwvW15AXFwvXStAW15AXFwvXSsvKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2xhc2hlcyA9IHJlc3Quc3Vic3RyKDAsIDIpID09PSAnLy8nO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2xhc2hlcyAmJiAhKHByb3RvICYmIGhvc3RsZXNzUHJvdG9jb2xbcHJvdG9dKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdCA9IHJlc3Quc3Vic3RyKDIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zbGFzaGVzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghaG9zdGxlc3NQcm90b2NvbFtwcm90b10gJiYgKHNsYXNoZXMgfHwgcHJvdG8gJiYgIXNsYXNoZWRQcm90b2NvbFtwcm90b10pKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlcmUncyBhIGhvc3RuYW1lLlxuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgZmlyc3QgaW5zdGFuY2Ugb2YgLywgPywgOywgb3IgIyBlbmRzIHRoZSBob3N0LlxuICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGVyZSBpcyBhbiBAIGluIHRoZSBob3N0bmFtZSwgdGhlbiBub24taG9zdCBjaGFycyAqYXJlKiBhbGxvd2VkXG4gICAgICAgICAgICAgICAgICAgIC8vIHRvIHRoZSBsZWZ0IG9mIHRoZSBsYXN0IEAgc2lnbiwgdW5sZXNzIHNvbWUgaG9zdC1lbmRpbmcgY2hhcmFjdGVyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbWVzICpiZWZvcmUqIHRoZSBALXNpZ24uXG4gICAgICAgICAgICAgICAgICAgIC8vIFVSTHMgYXJlIG9ibm94aW91cy5cbiAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgLy8gZXg6XG4gICAgICAgICAgICAgICAgICAgIC8vIGh0dHA6Ly9hQGJAYy8gPT4gdXNlcjphQGIgaG9zdDpjXG4gICAgICAgICAgICAgICAgICAgIC8vIGh0dHA6Ly9hQGI/QGMgPT4gdXNlcjphIGhvc3Q6YyBwYXRoOi8/QGNcblxuICAgICAgICAgICAgICAgICAgICAvLyB2MC4xMiBUT0RPKGlzYWFjcyk6IFRoaXMgaXMgbm90IHF1aXRlIGhvdyBDaHJvbWUgZG9lcyB0aGluZ3MuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJldmlldyBvdXIgdGVzdCBjYXNlIGFnYWluc3QgYnJvd3NlcnMgbW9yZSBjb21wcmVoZW5zaXZlbHkuXG5cbiAgICAgICAgICAgICAgICAgICAgLy8gZmluZCB0aGUgZmlyc3QgaW5zdGFuY2Ugb2YgYW55IGhvc3RFbmRpbmdDaGFyc1xuICAgICAgICAgICAgICAgICAgICB2YXIgaG9zdEVuZCA9IC0xO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhvc3RFbmRpbmdDaGFycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhlYyA9IHJlc3QuaW5kZXhPZihob3N0RW5kaW5nQ2hhcnNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhlYyAhPT0gLTEgJiYgKGhvc3RFbmQgPT09IC0xIHx8IGhlYyA8IGhvc3RFbmQpKSBob3N0RW5kID0gaGVjO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gYXQgdGhpcyBwb2ludCwgZWl0aGVyIHdlIGhhdmUgYW4gZXhwbGljaXQgcG9pbnQgd2hlcmUgdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vIGF1dGggcG9ydGlvbiBjYW5ub3QgZ28gcGFzdCwgb3IgdGhlIGxhc3QgQCBjaGFyIGlzIHRoZSBkZWNpZGVyLlxuICAgICAgICAgICAgICAgICAgICB2YXIgYXV0aCwgYXRTaWduO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaG9zdEVuZCA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGF0U2lnbiBjYW4gYmUgYW55d2hlcmUuXG4gICAgICAgICAgICAgICAgICAgICAgICBhdFNpZ24gPSByZXN0Lmxhc3RJbmRleE9mKCdAJyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhdFNpZ24gbXVzdCBiZSBpbiBhdXRoIHBvcnRpb24uXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBodHRwOi8vYUBiL2NAZCA9PiBob3N0OmIgYXV0aDphIHBhdGg6L2NAZFxuICAgICAgICAgICAgICAgICAgICAgICAgYXRTaWduID0gcmVzdC5sYXN0SW5kZXhPZignQCcsIGhvc3RFbmQpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gTm93IHdlIGhhdmUgYSBwb3J0aW9uIHdoaWNoIGlzIGRlZmluaXRlbHkgdGhlIGF1dGguXG4gICAgICAgICAgICAgICAgICAgIC8vIFB1bGwgdGhhdCBvZmYuXG4gICAgICAgICAgICAgICAgICAgIGlmIChhdFNpZ24gIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhdXRoID0gcmVzdC5zbGljZSgwLCBhdFNpZ24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdCA9IHJlc3Quc2xpY2UoYXRTaWduICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmF1dGggPSBkZWNvZGVVUklDb21wb25lbnQoYXV0aCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgaG9zdCBpcyB0aGUgcmVtYWluaW5nIHRvIHRoZSBsZWZ0IG9mIHRoZSBmaXJzdCBub24taG9zdCBjaGFyXG4gICAgICAgICAgICAgICAgICAgIGhvc3RFbmQgPSAtMTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub25Ib3N0Q2hhcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoZWMgPSByZXN0LmluZGV4T2Yobm9uSG9zdENoYXJzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoZWMgIT09IC0xICYmIChob3N0RW5kID09PSAtMSB8fCBoZWMgPCBob3N0RW5kKSkgaG9zdEVuZCA9IGhlYztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBpZiB3ZSBzdGlsbCBoYXZlIG5vdCBoaXQgaXQsIHRoZW4gdGhlIGVudGlyZSB0aGluZyBpcyBhIGhvc3QuXG4gICAgICAgICAgICAgICAgICAgIGlmIChob3N0RW5kID09PSAtMSkgaG9zdEVuZCA9IHJlc3QubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaG9zdCA9IHJlc3Quc2xpY2UoMCwgaG9zdEVuZCk7XG4gICAgICAgICAgICAgICAgICAgIHJlc3QgPSByZXN0LnNsaWNlKGhvc3RFbmQpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIHB1bGwgb3V0IHBvcnQuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyc2VIb3N0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gd2UndmUgaW5kaWNhdGVkIHRoYXQgdGhlcmUgaXMgYSBob3N0bmFtZSxcbiAgICAgICAgICAgICAgICAgICAgLy8gc28gZXZlbiBpZiBpdCdzIGVtcHR5LCBpdCBoYXMgdG8gYmUgcHJlc2VudC5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ob3N0bmFtZSA9IHRoaXMuaG9zdG5hbWUgfHwgJyc7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgaG9zdG5hbWUgYmVnaW5zIHdpdGggWyBhbmQgZW5kcyB3aXRoIF1cbiAgICAgICAgICAgICAgICAgICAgLy8gYXNzdW1lIHRoYXQgaXQncyBhbiBJUHY2IGFkZHJlc3MuXG4gICAgICAgICAgICAgICAgICAgIHZhciBpcHY2SG9zdG5hbWUgPSB0aGlzLmhvc3RuYW1lWzBdID09PSAnWycgJiYgdGhpcy5ob3N0bmFtZVt0aGlzLmhvc3RuYW1lLmxlbmd0aCAtIDFdID09PSAnXSc7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gdmFsaWRhdGUgYSBsaXR0bGUuXG4gICAgICAgICAgICAgICAgICAgIGlmICghaXB2Nkhvc3RuYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaG9zdHBhcnRzID0gdGhpcy5ob3N0bmFtZS5zcGxpdCgvXFwuLyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGhvc3RwYXJ0cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFydCA9IGhvc3RwYXJ0c1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBhcnQpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcGFydC5tYXRjaChob3N0bmFtZVBhcnRQYXR0ZXJuKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3cGFydCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgayA9IHBhcnQubGVuZ3RoOyBqIDwgazsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFydC5jaGFyQ29kZUF0KGopID4gMTI3KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UgcmVwbGFjZSBub24tQVNDSUkgY2hhciB3aXRoIGEgdGVtcG9yYXJ5IHBsYWNlaG9sZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UgbmVlZCB0aGlzIHRvIG1ha2Ugc3VyZSBzaXplIG9mIGhvc3RuYW1lIGlzIG5vdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJyb2tlbiBieSByZXBsYWNpbmcgbm9uLUFTQ0lJIGJ5IG5vdGhpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdwYXJ0ICs9ICd4JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3cGFydCArPSBwYXJ0W2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdlIHRlc3QgYWdhaW4gd2l0aCBBU0NJSSBjaGFyIG9ubHlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFuZXdwYXJ0Lm1hdGNoKGhvc3RuYW1lUGFydFBhdHRlcm4pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsaWRQYXJ0cyA9IGhvc3RwYXJ0cy5zbGljZSgwLCBpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub3RIb3N0ID0gaG9zdHBhcnRzLnNsaWNlKGkgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiaXQgPSBwYXJ0Lm1hdGNoKGhvc3RuYW1lUGFydFN0YXJ0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxpZFBhcnRzLnB1c2goYml0WzFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3RIb3N0LnVuc2hpZnQoYml0WzJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub3RIb3N0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3QgPSAnLycgKyBub3RIb3N0LmpvaW4oJy4nKSArIHJlc3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhvc3RuYW1lID0gdmFsaWRQYXJ0cy5qb2luKCcuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhvc3RuYW1lLmxlbmd0aCA+IGhvc3RuYW1lTWF4TGVuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhvc3RuYW1lID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBob3N0bmFtZXMgYXJlIGFsd2F5cyBsb3dlciBjYXNlLlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ob3N0bmFtZSA9IHRoaXMuaG9zdG5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICghaXB2Nkhvc3RuYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJRE5BIFN1cHBvcnQ6IFJldHVybnMgYSBwdW55Y29kZWQgcmVwcmVzZW50YXRpb24gb2YgXCJkb21haW5cIi5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEl0IG9ubHkgY29udmVydHMgcGFydHMgb2YgdGhlIGRvbWFpbiBuYW1lIHRoYXRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGhhdmUgbm9uLUFTQ0lJIGNoYXJhY3RlcnMsIGkuZS4gaXQgZG9lc24ndCBtYXR0ZXIgaWZcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHlvdSBjYWxsIGl0IHdpdGggYSBkb21haW4gdGhhdCBhbHJlYWR5IGlzIEFTQ0lJLW9ubHkuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhvc3RuYW1lID0gcHVueWNvZGUudG9BU0NJSSh0aGlzLmhvc3RuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBwID0gdGhpcy5wb3J0ID8gJzonICsgdGhpcy5wb3J0IDogJyc7XG4gICAgICAgICAgICAgICAgICAgIHZhciBoID0gdGhpcy5ob3N0bmFtZSB8fCAnJztcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ob3N0ID0gaCArIHA7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaHJlZiArPSB0aGlzLmhvc3Q7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gc3RyaXAgWyBhbmQgXSBmcm9tIHRoZSBob3N0bmFtZVxuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgaG9zdCBmaWVsZCBzdGlsbCByZXRhaW5zIHRoZW0sIHRob3VnaFxuICAgICAgICAgICAgICAgICAgICBpZiAoaXB2Nkhvc3RuYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhvc3RuYW1lID0gdGhpcy5ob3N0bmFtZS5zdWJzdHIoMSwgdGhpcy5ob3N0bmFtZS5sZW5ndGggLSAyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN0WzBdICE9PSAnLycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN0ID0gJy8nICsgcmVzdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIG5vdyByZXN0IGlzIHNldCB0byB0aGUgcG9zdC1ob3N0IHN0dWZmLlxuICAgICAgICAgICAgICAgIC8vIGNob3Agb2ZmIGFueSBkZWxpbSBjaGFycy5cbiAgICAgICAgICAgICAgICBpZiAoIXVuc2FmZVByb3RvY29sW2xvd2VyUHJvdG9dKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gRmlyc3QsIG1ha2UgMTAwJSBzdXJlIHRoYXQgYW55IFwiYXV0b0VzY2FwZVwiIGNoYXJzIGdldFxuICAgICAgICAgICAgICAgICAgICAvLyBlc2NhcGVkLCBldmVuIGlmIGVuY29kZVVSSUNvbXBvbmVudCBkb2Vzbid0IHRoaW5rIHRoZXlcbiAgICAgICAgICAgICAgICAgICAgLy8gbmVlZCB0byBiZS5cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBhdXRvRXNjYXBlLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFlID0gYXV0b0VzY2FwZVtpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN0LmluZGV4T2YoYWUpID09PSAtMSkgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXNjID0gZW5jb2RlVVJJQ29tcG9uZW50KGFlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlc2MgPT09IGFlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXNjID0gZXNjYXBlKGFlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3QgPSByZXN0LnNwbGl0KGFlKS5qb2luKGVzYyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBjaG9wIG9mZiBmcm9tIHRoZSB0YWlsIGZpcnN0LlxuICAgICAgICAgICAgICAgIHZhciBoYXNoID0gcmVzdC5pbmRleE9mKCcjJyk7XG4gICAgICAgICAgICAgICAgaWYgKGhhc2ggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGdvdCBhIGZyYWdtZW50IHN0cmluZy5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYXNoID0gcmVzdC5zdWJzdHIoaGFzaCk7XG4gICAgICAgICAgICAgICAgICAgIHJlc3QgPSByZXN0LnNsaWNlKDAsIGhhc2gpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcW0gPSByZXN0LmluZGV4T2YoJz8nKTtcbiAgICAgICAgICAgICAgICBpZiAocW0gIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoID0gcmVzdC5zdWJzdHIocW0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5ID0gcmVzdC5zdWJzdHIocW0gKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlUXVlcnlTdHJpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXVlcnkgPSBxdWVyeXN0cmluZy5wYXJzZSh0aGlzLnF1ZXJ5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXN0ID0gcmVzdC5zbGljZSgwLCBxbSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwYXJzZVF1ZXJ5U3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG5vIHF1ZXJ5IHN0cmluZywgYnV0IHBhcnNlUXVlcnlTdHJpbmcgc3RpbGwgcmVxdWVzdGVkXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucXVlcnkgPSB7fTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJlc3QpIHRoaXMucGF0aG5hbWUgPSByZXN0O1xuICAgICAgICAgICAgICAgIGlmIChzbGFzaGVkUHJvdG9jb2xbbG93ZXJQcm90b10gJiYgdGhpcy5ob3N0bmFtZSAmJiAhdGhpcy5wYXRobmFtZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhdGhuYW1lID0gJy8nO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vdG8gc3VwcG9ydCBodHRwLnJlcXVlc3RcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXRobmFtZSB8fCB0aGlzLnNlYXJjaCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IHRoaXMucGF0aG5hbWUgfHwgJyc7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzID0gdGhpcy5zZWFyY2ggfHwgJyc7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGF0aCA9IHAgKyBzO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGZpbmFsbHksIHJlY29uc3RydWN0IHRoZSBocmVmIGJhc2VkIG9uIHdoYXQgaGFzIGJlZW4gdmFsaWRhdGVkLlxuICAgICAgICAgICAgICAgIHRoaXMuaHJlZiA9IHRoaXMuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBmb3JtYXQgYSBwYXJzZWQgb2JqZWN0IGludG8gYSB1cmwgc3RyaW5nXG4gICAgICAgICAgICBmdW5jdGlvbiB1cmxGb3JtYXQob2JqKSB7XG4gICAgICAgICAgICAgICAgLy8gZW5zdXJlIGl0J3MgYW4gb2JqZWN0LCBhbmQgbm90IGEgc3RyaW5nIHVybC5cbiAgICAgICAgICAgICAgICAvLyBJZiBpdCdzIGFuIG9iaiwgdGhpcyBpcyBhIG5vLW9wLlxuICAgICAgICAgICAgICAgIC8vIHRoaXMgd2F5LCB5b3UgY2FuIGNhbGwgdXJsX2Zvcm1hdCgpIG9uIHN0cmluZ3NcbiAgICAgICAgICAgICAgICAvLyB0byBjbGVhbiB1cCBwb3RlbnRpYWxseSB3b25reSB1cmxzLlxuICAgICAgICAgICAgICAgIGlmICh1dGlsLmlzU3RyaW5nKG9iaikpIG9iaiA9IHVybFBhcnNlKG9iaik7XG4gICAgICAgICAgICAgICAgaWYgKCEob2JqIGluc3RhbmNlb2YgVXJsKSkgcmV0dXJuIFVybC5wcm90b3R5cGUuZm9ybWF0LmNhbGwob2JqKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gb2JqLmZvcm1hdCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBVcmwucHJvdG90eXBlLmZvcm1hdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgYXV0aCA9IHRoaXMuYXV0aCB8fCAnJztcbiAgICAgICAgICAgICAgICBpZiAoYXV0aCkge1xuICAgICAgICAgICAgICAgICAgICBhdXRoID0gZW5jb2RlVVJJQ29tcG9uZW50KGF1dGgpO1xuICAgICAgICAgICAgICAgICAgICBhdXRoID0gYXV0aC5yZXBsYWNlKC8lM0EvaSwgJzonKTtcbiAgICAgICAgICAgICAgICAgICAgYXV0aCArPSAnQCc7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHByb3RvY29sID0gdGhpcy5wcm90b2NvbCB8fCAnJyxcbiAgICAgICAgICAgICAgICAgICAgcGF0aG5hbWUgPSB0aGlzLnBhdGhuYW1lIHx8ICcnLFxuICAgICAgICAgICAgICAgICAgICBoYXNoID0gdGhpcy5oYXNoIHx8ICcnLFxuICAgICAgICAgICAgICAgICAgICBob3N0ID0gZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gJyc7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ob3N0KSB7XG4gICAgICAgICAgICAgICAgICAgIGhvc3QgPSBhdXRoICsgdGhpcy5ob3N0O1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5ob3N0bmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBob3N0ID0gYXV0aCArICh0aGlzLmhvc3RuYW1lLmluZGV4T2YoJzonKSA9PT0gLTEgPyB0aGlzLmhvc3RuYW1lIDogJ1snICsgdGhpcy5ob3N0bmFtZSArICddJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnBvcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3QgKz0gJzonICsgdGhpcy5wb3J0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucXVlcnkgJiYgdXRpbC5pc09iamVjdCh0aGlzLnF1ZXJ5KSAmJiBPYmplY3Qua2V5cyh0aGlzLnF1ZXJ5KS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgcXVlcnkgPSBxdWVyeXN0cmluZy5zdHJpbmdpZnkodGhpcy5xdWVyeSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHNlYXJjaCA9IHRoaXMuc2VhcmNoIHx8IHF1ZXJ5ICYmICc/JyArIHF1ZXJ5IHx8ICcnO1xuXG4gICAgICAgICAgICAgICAgaWYgKHByb3RvY29sICYmIHByb3RvY29sLnN1YnN0cigtMSkgIT09ICc6JykgcHJvdG9jb2wgKz0gJzonO1xuXG4gICAgICAgICAgICAgICAgLy8gb25seSB0aGUgc2xhc2hlZFByb3RvY29scyBnZXQgdGhlIC8vLiAgTm90IG1haWx0bzosIHhtcHA6LCBldGMuXG4gICAgICAgICAgICAgICAgLy8gdW5sZXNzIHRoZXkgaGFkIHRoZW0gdG8gYmVnaW4gd2l0aC5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zbGFzaGVzIHx8ICghcHJvdG9jb2wgfHwgc2xhc2hlZFByb3RvY29sW3Byb3RvY29sXSkgJiYgaG9zdCAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaG9zdCA9ICcvLycgKyAoaG9zdCB8fCAnJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXRobmFtZSAmJiBwYXRobmFtZS5jaGFyQXQoMCkgIT09ICcvJykgcGF0aG5hbWUgPSAnLycgKyBwYXRobmFtZTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFob3N0KSB7XG4gICAgICAgICAgICAgICAgICAgIGhvc3QgPSAnJztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaGFzaCAmJiBoYXNoLmNoYXJBdCgwKSAhPT0gJyMnKSBoYXNoID0gJyMnICsgaGFzaDtcbiAgICAgICAgICAgICAgICBpZiAoc2VhcmNoICYmIHNlYXJjaC5jaGFyQXQoMCkgIT09ICc/Jykgc2VhcmNoID0gJz8nICsgc2VhcmNoO1xuXG4gICAgICAgICAgICAgICAgcGF0aG5hbWUgPSBwYXRobmFtZS5yZXBsYWNlKC9bPyNdL2csIGZ1bmN0aW9uIChtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KG1hdGNoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBzZWFyY2ggPSBzZWFyY2gucmVwbGFjZSgnIycsICclMjMnKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBwcm90b2NvbCArIGhvc3QgKyBwYXRobmFtZSArIHNlYXJjaCArIGhhc2g7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBmdW5jdGlvbiB1cmxSZXNvbHZlKHNvdXJjZSwgcmVsYXRpdmUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdXJsUGFyc2Uoc291cmNlLCBmYWxzZSwgdHJ1ZSkucmVzb2x2ZShyZWxhdGl2ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIFVybC5wcm90b3R5cGUucmVzb2x2ZSA9IGZ1bmN0aW9uIChyZWxhdGl2ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlc29sdmVPYmplY3QodXJsUGFyc2UocmVsYXRpdmUsIGZhbHNlLCB0cnVlKSkuZm9ybWF0KCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBmdW5jdGlvbiB1cmxSZXNvbHZlT2JqZWN0KHNvdXJjZSwgcmVsYXRpdmUpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXNvdXJjZSkgcmV0dXJuIHJlbGF0aXZlO1xuICAgICAgICAgICAgICAgIHJldHVybiB1cmxQYXJzZShzb3VyY2UsIGZhbHNlLCB0cnVlKS5yZXNvbHZlT2JqZWN0KHJlbGF0aXZlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgVXJsLnByb3RvdHlwZS5yZXNvbHZlT2JqZWN0ID0gZnVuY3Rpb24gKHJlbGF0aXZlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHV0aWwuaXNTdHJpbmcocmVsYXRpdmUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZWwgPSBuZXcgVXJsKCk7XG4gICAgICAgICAgICAgICAgICAgIHJlbC5wYXJzZShyZWxhdGl2ZSwgZmFsc2UsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICByZWxhdGl2ZSA9IHJlbDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFVybCgpO1xuICAgICAgICAgICAgICAgIHZhciB0a2V5cyA9IE9iamVjdC5rZXlzKHRoaXMpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIHRrID0gMDsgdGsgPCB0a2V5cy5sZW5ndGg7IHRrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRrZXkgPSB0a2V5c1t0a107XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFt0a2V5XSA9IHRoaXNbdGtleV07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gaGFzaCBpcyBhbHdheXMgb3ZlcnJpZGRlbiwgbm8gbWF0dGVyIHdoYXQuXG4gICAgICAgICAgICAgICAgLy8gZXZlbiBocmVmPVwiXCIgd2lsbCByZW1vdmUgaXQuXG4gICAgICAgICAgICAgICAgcmVzdWx0Lmhhc2ggPSByZWxhdGl2ZS5oYXNoO1xuXG4gICAgICAgICAgICAgICAgLy8gaWYgdGhlIHJlbGF0aXZlIHVybCBpcyBlbXB0eSwgdGhlbiB0aGVyZSdzIG5vdGhpbmcgbGVmdCB0byBkbyBoZXJlLlxuICAgICAgICAgICAgICAgIGlmIChyZWxhdGl2ZS5ocmVmID09PSAnJykge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBocmVmcyBsaWtlIC8vZm9vL2JhciBhbHdheXMgY3V0IHRvIHRoZSBwcm90b2NvbC5cbiAgICAgICAgICAgICAgICBpZiAocmVsYXRpdmUuc2xhc2hlcyAmJiAhcmVsYXRpdmUucHJvdG9jb2wpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGFrZSBldmVyeXRoaW5nIGV4Y2VwdCB0aGUgcHJvdG9jb2wgZnJvbSByZWxhdGl2ZVxuICAgICAgICAgICAgICAgICAgICB2YXIgcmtleXMgPSBPYmplY3Qua2V5cyhyZWxhdGl2ZSk7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHJrID0gMDsgcmsgPCBya2V5cy5sZW5ndGg7IHJrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBya2V5ID0gcmtleXNbcmtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJrZXkgIT09ICdwcm90b2NvbCcpIHJlc3VsdFtya2V5XSA9IHJlbGF0aXZlW3JrZXldO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy91cmxQYXJzZSBhcHBlbmRzIHRyYWlsaW5nIC8gdG8gdXJscyBsaWtlIGh0dHA6Ly93d3cuZXhhbXBsZS5jb21cbiAgICAgICAgICAgICAgICAgICAgaWYgKHNsYXNoZWRQcm90b2NvbFtyZXN1bHQucHJvdG9jb2xdICYmIHJlc3VsdC5ob3N0bmFtZSAmJiAhcmVzdWx0LnBhdGhuYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucGF0aCA9IHJlc3VsdC5wYXRobmFtZSA9ICcvJztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChyZWxhdGl2ZS5wcm90b2NvbCAmJiByZWxhdGl2ZS5wcm90b2NvbCAhPT0gcmVzdWx0LnByb3RvY29sKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIGl0J3MgYSBrbm93biB1cmwgcHJvdG9jb2wsIHRoZW4gY2hhbmdpbmdcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHByb3RvY29sIGRvZXMgd2VpcmQgdGhpbmdzXG4gICAgICAgICAgICAgICAgICAgIC8vIGZpcnN0LCBpZiBpdCdzIG5vdCBmaWxlOiwgdGhlbiB3ZSBNVVNUIGhhdmUgYSBob3N0LFxuICAgICAgICAgICAgICAgICAgICAvLyBhbmQgaWYgdGhlcmUgd2FzIGEgcGF0aFxuICAgICAgICAgICAgICAgICAgICAvLyB0byBiZWdpbiB3aXRoLCB0aGVuIHdlIE1VU1QgaGF2ZSBhIHBhdGguXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIGl0IGlzIGZpbGU6LCB0aGVuIHRoZSBob3N0IGlzIGRyb3BwZWQsXG4gICAgICAgICAgICAgICAgICAgIC8vIGJlY2F1c2UgdGhhdCdzIGtub3duIHRvIGJlIGhvc3RsZXNzLlxuICAgICAgICAgICAgICAgICAgICAvLyBhbnl0aGluZyBlbHNlIGlzIGFzc3VtZWQgdG8gYmUgYWJzb2x1dGUuXG4gICAgICAgICAgICAgICAgICAgIGlmICghc2xhc2hlZFByb3RvY29sW3JlbGF0aXZlLnByb3RvY29sXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhyZWxhdGl2ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB2ID0gMDsgdiA8IGtleXMubGVuZ3RoOyB2KyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgayA9IGtleXNbdl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2tdID0gcmVsYXRpdmVba107XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZXN1bHQucHJvdG9jb2wgPSByZWxhdGl2ZS5wcm90b2NvbDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZWxhdGl2ZS5ob3N0ICYmICFob3N0bGVzc1Byb3RvY29sW3JlbGF0aXZlLnByb3RvY29sXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbFBhdGggPSAocmVsYXRpdmUucGF0aG5hbWUgfHwgJycpLnNwbGl0KCcvJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAocmVsUGF0aC5sZW5ndGggJiYgIShyZWxhdGl2ZS5ob3N0ID0gcmVsUGF0aC5zaGlmdCgpKSkge31cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVsYXRpdmUuaG9zdCkgcmVsYXRpdmUuaG9zdCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZWxhdGl2ZS5ob3N0bmFtZSkgcmVsYXRpdmUuaG9zdG5hbWUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWxQYXRoWzBdICE9PSAnJykgcmVsUGF0aC51bnNoaWZ0KCcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWxQYXRoLmxlbmd0aCA8IDIpIHJlbFBhdGgudW5zaGlmdCgnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucGF0aG5hbWUgPSByZWxQYXRoLmpvaW4oJy8nKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wYXRobmFtZSA9IHJlbGF0aXZlLnBhdGhuYW1lO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5zZWFyY2ggPSByZWxhdGl2ZS5zZWFyY2g7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5xdWVyeSA9IHJlbGF0aXZlLnF1ZXJ5O1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQuaG9zdCA9IHJlbGF0aXZlLmhvc3QgfHwgJyc7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5hdXRoID0gcmVsYXRpdmUuYXV0aDtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0Lmhvc3RuYW1lID0gcmVsYXRpdmUuaG9zdG5hbWUgfHwgcmVsYXRpdmUuaG9zdDtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnBvcnQgPSByZWxhdGl2ZS5wb3J0O1xuICAgICAgICAgICAgICAgICAgICAvLyB0byBzdXBwb3J0IGh0dHAucmVxdWVzdFxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnBhdGhuYW1lIHx8IHJlc3VsdC5zZWFyY2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwID0gcmVzdWx0LnBhdGhuYW1lIHx8ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHMgPSByZXN1bHQuc2VhcmNoIHx8ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnBhdGggPSBwICsgcztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXN1bHQuc2xhc2hlcyA9IHJlc3VsdC5zbGFzaGVzIHx8IHJlbGF0aXZlLnNsYXNoZXM7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBpc1NvdXJjZUFicyA9IHJlc3VsdC5wYXRobmFtZSAmJiByZXN1bHQucGF0aG5hbWUuY2hhckF0KDApID09PSAnLycsXG4gICAgICAgICAgICAgICAgICAgIGlzUmVsQWJzID0gcmVsYXRpdmUuaG9zdCB8fCByZWxhdGl2ZS5wYXRobmFtZSAmJiByZWxhdGl2ZS5wYXRobmFtZS5jaGFyQXQoMCkgPT09ICcvJyxcbiAgICAgICAgICAgICAgICAgICAgbXVzdEVuZEFicyA9IGlzUmVsQWJzIHx8IGlzU291cmNlQWJzIHx8IHJlc3VsdC5ob3N0ICYmIHJlbGF0aXZlLnBhdGhuYW1lLFxuICAgICAgICAgICAgICAgICAgICByZW1vdmVBbGxEb3RzID0gbXVzdEVuZEFicyxcbiAgICAgICAgICAgICAgICAgICAgc3JjUGF0aCA9IHJlc3VsdC5wYXRobmFtZSAmJiByZXN1bHQucGF0aG5hbWUuc3BsaXQoJy8nKSB8fCBbXSxcbiAgICAgICAgICAgICAgICAgICAgcmVsUGF0aCA9IHJlbGF0aXZlLnBhdGhuYW1lICYmIHJlbGF0aXZlLnBhdGhuYW1lLnNwbGl0KCcvJykgfHwgW10sXG4gICAgICAgICAgICAgICAgICAgIHBzeWNob3RpYyA9IHJlc3VsdC5wcm90b2NvbCAmJiAhc2xhc2hlZFByb3RvY29sW3Jlc3VsdC5wcm90b2NvbF07XG5cbiAgICAgICAgICAgICAgICAvLyBpZiB0aGUgdXJsIGlzIGEgbm9uLXNsYXNoZWQgdXJsLCB0aGVuIHJlbGF0aXZlXG4gICAgICAgICAgICAgICAgLy8gbGlua3MgbGlrZSAuLi8uLiBzaG91bGQgYmUgYWJsZVxuICAgICAgICAgICAgICAgIC8vIHRvIGNyYXdsIHVwIHRvIHRoZSBob3N0bmFtZSwgYXMgd2VsbC4gIFRoaXMgaXMgc3RyYW5nZS5cbiAgICAgICAgICAgICAgICAvLyByZXN1bHQucHJvdG9jb2wgaGFzIGFscmVhZHkgYmVlbiBzZXQgYnkgbm93LlxuICAgICAgICAgICAgICAgIC8vIExhdGVyIG9uLCBwdXQgdGhlIGZpcnN0IHBhdGggcGFydCBpbnRvIHRoZSBob3N0IGZpZWxkLlxuICAgICAgICAgICAgICAgIGlmIChwc3ljaG90aWMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0Lmhvc3RuYW1lID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wb3J0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5ob3N0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3JjUGF0aFswXSA9PT0gJycpIHNyY1BhdGhbMF0gPSByZXN1bHQuaG9zdDtlbHNlIHNyY1BhdGgudW5zaGlmdChyZXN1bHQuaG9zdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0Lmhvc3QgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlbGF0aXZlLnByb3RvY29sKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWxhdGl2ZS5ob3N0bmFtZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWxhdGl2ZS5wb3J0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWxhdGl2ZS5ob3N0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbFBhdGhbMF0gPT09ICcnKSByZWxQYXRoWzBdID0gcmVsYXRpdmUuaG9zdDtlbHNlIHJlbFBhdGgudW5zaGlmdChyZWxhdGl2ZS5ob3N0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0aXZlLmhvc3QgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG11c3RFbmRBYnMgPSBtdXN0RW5kQWJzICYmIChyZWxQYXRoWzBdID09PSAnJyB8fCBzcmNQYXRoWzBdID09PSAnJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGlzUmVsQWJzKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGl0J3MgYWJzb2x1dGUuXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5ob3N0ID0gcmVsYXRpdmUuaG9zdCB8fCByZWxhdGl2ZS5ob3N0ID09PSAnJyA/IHJlbGF0aXZlLmhvc3QgOiByZXN1bHQuaG9zdDtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0Lmhvc3RuYW1lID0gcmVsYXRpdmUuaG9zdG5hbWUgfHwgcmVsYXRpdmUuaG9zdG5hbWUgPT09ICcnID8gcmVsYXRpdmUuaG9zdG5hbWUgOiByZXN1bHQuaG9zdG5hbWU7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5zZWFyY2ggPSByZWxhdGl2ZS5zZWFyY2g7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5xdWVyeSA9IHJlbGF0aXZlLnF1ZXJ5O1xuICAgICAgICAgICAgICAgICAgICBzcmNQYXRoID0gcmVsUGF0aDtcbiAgICAgICAgICAgICAgICAgICAgLy8gZmFsbCB0aHJvdWdoIHRvIHRoZSBkb3QtaGFuZGxpbmcgYmVsb3cuXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZWxQYXRoLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBpdCdzIHJlbGF0aXZlXG4gICAgICAgICAgICAgICAgICAgIC8vIHRocm93IGF3YXkgdGhlIGV4aXN0aW5nIGZpbGUsIGFuZCB0YWtlIHRoZSBuZXcgcGF0aCBpbnN0ZWFkLlxuICAgICAgICAgICAgICAgICAgICBpZiAoIXNyY1BhdGgpIHNyY1BhdGggPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgc3JjUGF0aC5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgc3JjUGF0aCA9IHNyY1BhdGguY29uY2F0KHJlbFBhdGgpO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQuc2VhcmNoID0gcmVsYXRpdmUuc2VhcmNoO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQucXVlcnkgPSByZWxhdGl2ZS5xdWVyeTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCF1dGlsLmlzTnVsbE9yVW5kZWZpbmVkKHJlbGF0aXZlLnNlYXJjaCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8ganVzdCBwdWxsIG91dCB0aGUgc2VhcmNoLlxuICAgICAgICAgICAgICAgICAgICAvLyBsaWtlIGhyZWY9Jz9mb28nLlxuICAgICAgICAgICAgICAgICAgICAvLyBQdXQgdGhpcyBhZnRlciB0aGUgb3RoZXIgdHdvIGNhc2VzIGJlY2F1c2UgaXQgc2ltcGxpZmllcyB0aGUgYm9vbGVhbnNcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBzeWNob3RpYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Lmhvc3RuYW1lID0gcmVzdWx0Lmhvc3QgPSBzcmNQYXRoLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL29jY2F0aW9uYWx5IHRoZSBhdXRoIGNhbiBnZXQgc3R1Y2sgb25seSBpbiBob3N0XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3RoaXMgZXNwZWNpYWxseSBoYXBwZW5zIGluIGNhc2VzIGxpa2VcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdXJsLnJlc29sdmVPYmplY3QoJ21haWx0bzpsb2NhbDFAZG9tYWluMScsICdsb2NhbDJAZG9tYWluMicpXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXV0aEluSG9zdCA9IHJlc3VsdC5ob3N0ICYmIHJlc3VsdC5ob3N0LmluZGV4T2YoJ0AnKSA+IDAgPyByZXN1bHQuaG9zdC5zcGxpdCgnQCcpIDogZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXV0aEluSG9zdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5hdXRoID0gYXV0aEluSG9zdC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5ob3N0ID0gcmVzdWx0Lmhvc3RuYW1lID0gYXV0aEluSG9zdC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5zZWFyY2ggPSByZWxhdGl2ZS5zZWFyY2g7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5xdWVyeSA9IHJlbGF0aXZlLnF1ZXJ5O1xuICAgICAgICAgICAgICAgICAgICAvL3RvIHN1cHBvcnQgaHR0cC5yZXF1ZXN0XG4gICAgICAgICAgICAgICAgICAgIGlmICghdXRpbC5pc051bGwocmVzdWx0LnBhdGhuYW1lKSB8fCAhdXRpbC5pc051bGwocmVzdWx0LnNlYXJjaCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wYXRoID0gKHJlc3VsdC5wYXRobmFtZSA/IHJlc3VsdC5wYXRobmFtZSA6ICcnKSArIChyZXN1bHQuc2VhcmNoID8gcmVzdWx0LnNlYXJjaCA6ICcnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIXNyY1BhdGgubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG5vIHBhdGggYXQgYWxsLiAgZWFzeS5cbiAgICAgICAgICAgICAgICAgICAgLy8gd2UndmUgYWxyZWFkeSBoYW5kbGVkIHRoZSBvdGhlciBzdHVmZiBhYm92ZS5cbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnBhdGhuYW1lID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgLy90byBzdXBwb3J0IGh0dHAucmVxdWVzdFxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnNlYXJjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnBhdGggPSAnLycgKyByZXN1bHQuc2VhcmNoO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnBhdGggPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGlmIGEgdXJsIEVORHMgaW4gLiBvciAuLiwgdGhlbiBpdCBtdXN0IGdldCBhIHRyYWlsaW5nIHNsYXNoLlxuICAgICAgICAgICAgICAgIC8vIGhvd2V2ZXIsIGlmIGl0IGVuZHMgaW4gYW55dGhpbmcgZWxzZSBub24tc2xhc2h5LFxuICAgICAgICAgICAgICAgIC8vIHRoZW4gaXQgbXVzdCBOT1QgZ2V0IGEgdHJhaWxpbmcgc2xhc2guXG4gICAgICAgICAgICAgICAgdmFyIGxhc3QgPSBzcmNQYXRoLnNsaWNlKC0xKVswXTtcbiAgICAgICAgICAgICAgICB2YXIgaGFzVHJhaWxpbmdTbGFzaCA9IChyZXN1bHQuaG9zdCB8fCByZWxhdGl2ZS5ob3N0IHx8IHNyY1BhdGgubGVuZ3RoID4gMSkgJiYgKGxhc3QgPT09ICcuJyB8fCBsYXN0ID09PSAnLi4nKSB8fCBsYXN0ID09PSAnJztcblxuICAgICAgICAgICAgICAgIC8vIHN0cmlwIHNpbmdsZSBkb3RzLCByZXNvbHZlIGRvdWJsZSBkb3RzIHRvIHBhcmVudCBkaXJcbiAgICAgICAgICAgICAgICAvLyBpZiB0aGUgcGF0aCB0cmllcyB0byBnbyBhYm92ZSB0aGUgcm9vdCwgYHVwYCBlbmRzIHVwID4gMFxuICAgICAgICAgICAgICAgIHZhciB1cCA9IDA7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IHNyY1BhdGgubGVuZ3RoOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgICAgICAgICBsYXN0ID0gc3JjUGF0aFtpXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxhc3QgPT09ICcuJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3JjUGF0aC5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGFzdCA9PT0gJy4uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3JjUGF0aC5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cCsrO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHVwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzcmNQYXRoLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwLS07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBpZiB0aGUgcGF0aCBpcyBhbGxvd2VkIHRvIGdvIGFib3ZlIHRoZSByb290LCByZXN0b3JlIGxlYWRpbmcgLi5zXG4gICAgICAgICAgICAgICAgaWYgKCFtdXN0RW5kQWJzICYmICFyZW1vdmVBbGxEb3RzKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoOyB1cC0tOyB1cCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3JjUGF0aC51bnNoaWZ0KCcuLicpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKG11c3RFbmRBYnMgJiYgc3JjUGF0aFswXSAhPT0gJycgJiYgKCFzcmNQYXRoWzBdIHx8IHNyY1BhdGhbMF0uY2hhckF0KDApICE9PSAnLycpKSB7XG4gICAgICAgICAgICAgICAgICAgIHNyY1BhdGgudW5zaGlmdCgnJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGhhc1RyYWlsaW5nU2xhc2ggJiYgc3JjUGF0aC5qb2luKCcvJykuc3Vic3RyKC0xKSAhPT0gJy8nKSB7XG4gICAgICAgICAgICAgICAgICAgIHNyY1BhdGgucHVzaCgnJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGlzQWJzb2x1dGUgPSBzcmNQYXRoWzBdID09PSAnJyB8fCBzcmNQYXRoWzBdICYmIHNyY1BhdGhbMF0uY2hhckF0KDApID09PSAnLyc7XG5cbiAgICAgICAgICAgICAgICAvLyBwdXQgdGhlIGhvc3QgYmFja1xuICAgICAgICAgICAgICAgIGlmIChwc3ljaG90aWMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0Lmhvc3RuYW1lID0gcmVzdWx0Lmhvc3QgPSBpc0Fic29sdXRlID8gJycgOiBzcmNQYXRoLmxlbmd0aCA/IHNyY1BhdGguc2hpZnQoKSA6ICcnO1xuICAgICAgICAgICAgICAgICAgICAvL29jY2F0aW9uYWx5IHRoZSBhdXRoIGNhbiBnZXQgc3R1Y2sgb25seSBpbiBob3N0XG4gICAgICAgICAgICAgICAgICAgIC8vdGhpcyBlc3BlY2lhbGx5IGhhcHBlbnMgaW4gY2FzZXMgbGlrZVxuICAgICAgICAgICAgICAgICAgICAvL3VybC5yZXNvbHZlT2JqZWN0KCdtYWlsdG86bG9jYWwxQGRvbWFpbjEnLCAnbG9jYWwyQGRvbWFpbjInKVxuICAgICAgICAgICAgICAgICAgICB2YXIgYXV0aEluSG9zdCA9IHJlc3VsdC5ob3N0ICYmIHJlc3VsdC5ob3N0LmluZGV4T2YoJ0AnKSA+IDAgPyByZXN1bHQuaG9zdC5zcGxpdCgnQCcpIDogZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhdXRoSW5Ib3N0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuYXV0aCA9IGF1dGhJbkhvc3Quc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5ob3N0ID0gcmVzdWx0Lmhvc3RuYW1lID0gYXV0aEluSG9zdC5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbXVzdEVuZEFicyA9IG11c3RFbmRBYnMgfHwgcmVzdWx0Lmhvc3QgJiYgc3JjUGF0aC5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICBpZiAobXVzdEVuZEFicyAmJiAhaXNBYnNvbHV0ZSkge1xuICAgICAgICAgICAgICAgICAgICBzcmNQYXRoLnVuc2hpZnQoJycpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghc3JjUGF0aC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnBhdGhuYW1lID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnBhdGggPSBudWxsO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wYXRobmFtZSA9IHNyY1BhdGguam9pbignLycpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vdG8gc3VwcG9ydCByZXF1ZXN0Lmh0dHBcbiAgICAgICAgICAgICAgICBpZiAoIXV0aWwuaXNOdWxsKHJlc3VsdC5wYXRobmFtZSkgfHwgIXV0aWwuaXNOdWxsKHJlc3VsdC5zZWFyY2gpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wYXRoID0gKHJlc3VsdC5wYXRobmFtZSA/IHJlc3VsdC5wYXRobmFtZSA6ICcnKSArIChyZXN1bHQuc2VhcmNoID8gcmVzdWx0LnNlYXJjaCA6ICcnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVzdWx0LmF1dGggPSByZWxhdGl2ZS5hdXRoIHx8IHJlc3VsdC5hdXRoO1xuICAgICAgICAgICAgICAgIHJlc3VsdC5zbGFzaGVzID0gcmVzdWx0LnNsYXNoZXMgfHwgcmVsYXRpdmUuc2xhc2hlcztcbiAgICAgICAgICAgICAgICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgVXJsLnByb3RvdHlwZS5wYXJzZUhvc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGhvc3QgPSB0aGlzLmhvc3Q7XG4gICAgICAgICAgICAgICAgdmFyIHBvcnQgPSBwb3J0UGF0dGVybi5leGVjKGhvc3QpO1xuICAgICAgICAgICAgICAgIGlmIChwb3J0KSB7XG4gICAgICAgICAgICAgICAgICAgIHBvcnQgPSBwb3J0WzBdO1xuICAgICAgICAgICAgICAgICAgICBpZiAocG9ydCAhPT0gJzonKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBvcnQgPSBwb3J0LnN1YnN0cigxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBob3N0ID0gaG9zdC5zdWJzdHIoMCwgaG9zdC5sZW5ndGggLSBwb3J0Lmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChob3N0KSB0aGlzLmhvc3RuYW1lID0gaG9zdDtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sIHsgXCIuL3V0aWxcIjogNiwgXCJwdW55Y29kZVwiOiAxLCBcInF1ZXJ5c3RyaW5nXCI6IDQgfV0sIDY6IFtmdW5jdGlvbiAocmVxdWlyZSwgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICAgICAgICAndXNlIHN0cmljdCc7XG5cbiAgICAgICAgICAgIG1vZHVsZS5leHBvcnRzID0ge1xuICAgICAgICAgICAgICAgIGlzU3RyaW5nOiBmdW5jdGlvbiBpc1N0cmluZyhhcmcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdzdHJpbmcnO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgaXNPYmplY3Q6IGZ1bmN0aW9uIGlzT2JqZWN0KGFyZykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHR5cGVvZiBhcmcgPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZihhcmcpKSA9PT0gJ29iamVjdCcgJiYgYXJnICE9PSBudWxsO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgaXNOdWxsOiBmdW5jdGlvbiBpc051bGwoYXJnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhcmcgPT09IG51bGw7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBpc051bGxPclVuZGVmaW5lZDogZnVuY3Rpb24gaXNOdWxsT3JVbmRlZmluZWQoYXJnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhcmcgPT0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9LCB7fV0sIDc6IFtmdW5jdGlvbiAocmVxdWlyZSwgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuICAgICAgICAgICAgdmFyIHRoaW5nX2Rlc2NyaXB0aW9uXzEgPSByZXF1aXJlKFwiLi90aGluZy1kZXNjcmlwdGlvblwiKTtcbiAgICAgICAgICAgIHZhciBURCA9IHJlcXVpcmUoXCIuL3RoaW5nLWRlc2NyaXB0aW9uXCIpO1xuICAgICAgICAgICAgdmFyIHR5cGVkanNvbl9ucG1fMSA9IHJlcXVpcmUoXCJ0eXBlZGpzb24tbnBtXCIpO1xuICAgICAgICAgICAgZnVuY3Rpb24gcGFyc2VURE9iamVjdCh0ZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZVREU3RyaW5nKHR5cGVkanNvbl9ucG1fMS5UeXBlZEpTT04uc3RyaW5naWZ5KHRkLCB7IGVuYWJsZVR5cGVIaW50czogZmFsc2UgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZXhwb3J0cy5wYXJzZVRET2JqZWN0ID0gcGFyc2VURE9iamVjdDtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHBhcnNlVERTdHJpbmcoanNvbikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGFyc2VURFN0cmluZygpIHBhcnNpbmdcXG5gYGBcXG5cIiArIGpzb24gKyBcIlxcbmBgYFwiKTtcbiAgICAgICAgICAgICAgICB2YXIgdGQgPSB0eXBlZGpzb25fbnBtXzEuVHlwZWRKU09OLnBhcnNlKGpzb24sIHRoaW5nX2Rlc2NyaXB0aW9uXzEuZGVmYXVsdCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJwYXJzZVREU3RyaW5nKCkgZm91bmQgXCIgKyB0ZC5pbnRlcmFjdGlvbi5sZW5ndGggKyBcIiBJbnRlcmFjdGlvblwiICsgKHRkLmludGVyYWN0aW9uLmxlbmd0aCA9PT0gMSA/ICcnIDogJ3MnKSk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRkLmludGVyYWN0aW9uOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW50ZXJhY3Rpb24gPSBfYVtfaV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbnRlcmFjdGlvbi5zZW1hbnRpY1R5cGVzLmluZGV4T2YoVEQuSW50ZXJhY3Rpb25QYXR0ZXJuLlByb3BlcnR5LnRvU3RyaW5nKCkpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCIgKiBQcm9wZXJ0eSAnXCIgKyBpbnRlcmFjdGlvbi5uYW1lICsgXCInXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJhY3Rpb24ucGF0dGVybiA9IFRELkludGVyYWN0aW9uUGF0dGVybi5Qcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbnRlcmFjdGlvbi5zZW1hbnRpY1R5cGVzLmluZGV4T2YoVEQuSW50ZXJhY3Rpb25QYXR0ZXJuLkFjdGlvbi50b1N0cmluZygpKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiICogQWN0aW9uICdcIiArIGludGVyYWN0aW9uLm5hbWUgKyBcIidcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnRlcmFjdGlvbi5wYXR0ZXJuID0gVEQuSW50ZXJhY3Rpb25QYXR0ZXJuLkFjdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbnRlcmFjdGlvbi5zZW1hbnRpY1R5cGVzLmluZGV4T2YoVEQuSW50ZXJhY3Rpb25QYXR0ZXJuLkV2ZW50LnRvU3RyaW5nKCkpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCIgKiBFdmVudCAnXCIgKyBpbnRlcmFjdGlvbi5uYW1lICsgXCInXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJhY3Rpb24ucGF0dGVybiA9IFRELkludGVyYWN0aW9uUGF0dGVybi5FdmVudDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJwYXJzZVREU3RyaW5nKCkgZm91bmQgdW5rbm93biBJbnRlcmFjdGlvbiBwYXR0ZXJuICdcIiArIGludGVyYWN0aW9uLnNlbWFudGljVHlwZXMgKyBcIidcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRkLmJhc2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJwYXJzZVREU3RyaW5nKCkgYXBwbHlpbmcgYmFzZSAnXCIgKyB0ZC5iYXNlICsgXCInIHRvIGhyZWYgJ1wiICsgaW50ZXJhY3Rpb24ubGlua1swXS5ocmVmICsgXCInXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhyZWYgPSBpbnRlcmFjdGlvbi5saW5rWzBdLmhyZWY7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gcmVxdWlyZSgndXJsJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IHRkLmJhc2UuaW5kZXhPZignOicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByID0gdGQuYmFzZS5zdWJzdHIoMCwgbiArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVyaVRlbXAgPSB0ZC5iYXNlLnJlcGxhY2UocHIsICdodHRwOicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJpVGVtcCA9IHVybC5yZXNvbHZlKHVyaVRlbXAsIGhyZWYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJpVGVtcCA9IHVyaVRlbXAucmVwbGFjZSgnaHR0cDonLCBwcik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnRlcmFjdGlvbi5saW5rWzBdLmhyZWYgPSB1cmlUZW1wO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0ZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGV4cG9ydHMucGFyc2VURFN0cmluZyA9IHBhcnNlVERTdHJpbmc7XG4gICAgICAgICAgICBmdW5jdGlvbiBzZXJpYWxpemVURCh0ZCkge1xuICAgICAgICAgICAgICAgIHR5cGVkanNvbl9ucG1fMS5UeXBlZEpTT04uY29uZmlnKHsgXCJlbmFibGVUeXBlSGludHNcIjogZmFsc2UgfSk7XG4gICAgICAgICAgICAgICAgdmFyIGpzb24gPSB0eXBlZGpzb25fbnBtXzEuVHlwZWRKU09OLnN0cmluZ2lmeSh0ZCk7XG4gICAgICAgICAgICAgICAgdmFyIHJhdyA9IEpTT04ucGFyc2UoanNvbik7XG4gICAgICAgICAgICAgICAgaWYgKHRkLmJhc2UgPT09IG51bGwgfHwgdGQuYmFzZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSByYXcuYmFzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHJhdy5pbnRlcmFjdGlvbjsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGludGVyYWN0aW9uID0gX2FbX2ldO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW50ZXJhY3Rpb24uaW5wdXREYXRhID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgaW50ZXJhY3Rpb24uaW5wdXREYXRhO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbnRlcmFjdGlvbi5vdXRwdXREYXRhID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgaW50ZXJhY3Rpb24ub3V0cHV0RGF0YTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoaW50ZXJhY3Rpb24ud3JpdGFibGUgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBpbnRlcmFjdGlvbi53cml0YWJsZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoaW50ZXJhY3Rpb24ub3V0cHV0RGF0YSAmJiBpbnRlcmFjdGlvbi5vdXRwdXREYXRhLnJlcXVpcmVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiIyMjIEhPVEZJWCBmb3IgVHlwZWRKU09OICMjI1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXFzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciByZXEgaW4gaW50ZXJhY3Rpb24ub3V0cHV0RGF0YS5yZXF1aXJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXMucHVzaChpbnRlcmFjdGlvbi5vdXRwdXREYXRhLnJlcXVpcmVkW3JlcV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfWludGVyYWN0aW9uLm91dHB1dERhdGEucmVxdWlyZWQgPSByZXFzO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGpzb24gPSBKU09OLnN0cmluZ2lmeShyYXcpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic2VyaWFsaXplVEQoKSBwcm9kdWNlZFxcbmBgYFxcblwiICsganNvbiArIFwiXFxuYGBgXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBqc29uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZXhwb3J0cy5zZXJpYWxpemVURCA9IHNlcmlhbGl6ZVREO1xuICAgICAgICB9LCB7IFwiLi90aGluZy1kZXNjcmlwdGlvblwiOiA4LCBcInR5cGVkanNvbi1ucG1cIjogOSwgXCJ1cmxcIjogNSB9XSwgODogW2Z1bmN0aW9uIChyZXF1aXJlLCBtb2R1bGUsIGV4cG9ydHMpIHtcbiAgICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgICAgICAgICB2YXIgX19kZWNvcmF0ZSA9IHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlIHx8IGZ1bmN0aW9uIChkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xuICAgICAgICAgICAgICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsXG4gICAgICAgICAgICAgICAgICAgIGQ7XG4gICAgICAgICAgICAgICAgaWYgKCh0eXBlb2YgUmVmbGVjdCA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKFJlZmxlY3QpKSA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7ZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xuICAgICAgICAgICAgICAgIH1yZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbiAgICAgICAgICAgIHZhciB0eXBlZGpzb25fbnBtXzEgPSByZXF1aXJlKFwidHlwZWRqc29uLW5wbVwiKTtcbiAgICAgICAgICAgIHZhciBJbnRlcmFjdGlvblBhdHRlcm47XG4gICAgICAgICAgICAoZnVuY3Rpb24gKEludGVyYWN0aW9uUGF0dGVybikge1xuICAgICAgICAgICAgICAgIEludGVyYWN0aW9uUGF0dGVybltJbnRlcmFjdGlvblBhdHRlcm5bXCJQcm9wZXJ0eVwiXSA9ICdQcm9wZXJ0eSddID0gXCJQcm9wZXJ0eVwiO1xuICAgICAgICAgICAgICAgIEludGVyYWN0aW9uUGF0dGVybltJbnRlcmFjdGlvblBhdHRlcm5bXCJBY3Rpb25cIl0gPSAnQWN0aW9uJ10gPSBcIkFjdGlvblwiO1xuICAgICAgICAgICAgICAgIEludGVyYWN0aW9uUGF0dGVybltJbnRlcmFjdGlvblBhdHRlcm5bXCJFdmVudFwiXSA9ICdFdmVudCddID0gXCJFdmVudFwiO1xuICAgICAgICAgICAgfSkoSW50ZXJhY3Rpb25QYXR0ZXJuID0gZXhwb3J0cy5JbnRlcmFjdGlvblBhdHRlcm4gfHwgKGV4cG9ydHMuSW50ZXJhY3Rpb25QYXR0ZXJuID0ge30pKTtcbiAgICAgICAgICAgIHZhciBJbnRlcmFjdGlvbkxpbmsgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gSW50ZXJhY3Rpb25MaW5rKCkge31cbiAgICAgICAgICAgICAgICByZXR1cm4gSW50ZXJhY3Rpb25MaW5rO1xuICAgICAgICAgICAgfSgpO1xuICAgICAgICAgICAgX19kZWNvcmF0ZShbdHlwZWRqc29uX25wbV8xLkpzb25NZW1iZXIoeyBpc1JlcXVpcmVkOiB0cnVlLCB0eXBlOiBTdHJpbmcgfSldLCBJbnRlcmFjdGlvbkxpbmsucHJvdG90eXBlLCBcImhyZWZcIiwgdm9pZCAwKTtcbiAgICAgICAgICAgIF9fZGVjb3JhdGUoW3R5cGVkanNvbl9ucG1fMS5Kc29uTWVtYmVyKHsgaXNSZXF1aXJlZDogdHJ1ZSwgdHlwZTogU3RyaW5nIH0pXSwgSW50ZXJhY3Rpb25MaW5rLnByb3RvdHlwZSwgXCJtZWRpYVR5cGVcIiwgdm9pZCAwKTtcbiAgICAgICAgICAgIEludGVyYWN0aW9uTGluayA9IF9fZGVjb3JhdGUoW3R5cGVkanNvbl9ucG1fMS5Kc29uT2JqZWN0KCldLCBJbnRlcmFjdGlvbkxpbmspO1xuICAgICAgICAgICAgZXhwb3J0cy5JbnRlcmFjdGlvbkxpbmsgPSBJbnRlcmFjdGlvbkxpbms7XG4gICAgICAgICAgICB2YXIgSW50ZXJhY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gSW50ZXJhY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VtYW50aWNUeXBlcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpbmsgPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIEludGVyYWN0aW9uO1xuICAgICAgICAgICAgfSgpO1xuICAgICAgICAgICAgX19kZWNvcmF0ZShbdHlwZWRqc29uX25wbV8xLkpzb25NZW1iZXIoeyBuYW1lOiAnQHR5cGUnLCBpc1JlcXVpcmVkOiB0cnVlLCBlbGVtZW50czogU3RyaW5nIH0pXSwgSW50ZXJhY3Rpb24ucHJvdG90eXBlLCBcInNlbWFudGljVHlwZXNcIiwgdm9pZCAwKTtcbiAgICAgICAgICAgIF9fZGVjb3JhdGUoW3R5cGVkanNvbl9ucG1fMS5Kc29uTWVtYmVyKHsgaXNSZXF1aXJlZDogdHJ1ZSwgdHlwZTogU3RyaW5nIH0pXSwgSW50ZXJhY3Rpb24ucHJvdG90eXBlLCBcIm5hbWVcIiwgdm9pZCAwKTtcbiAgICAgICAgICAgIF9fZGVjb3JhdGUoW3R5cGVkanNvbl9ucG1fMS5Kc29uTWVtYmVyKHsgaXNSZXF1aXJlZDogdHJ1ZSwgZWxlbWVudHM6IEludGVyYWN0aW9uTGluayB9KV0sIEludGVyYWN0aW9uLnByb3RvdHlwZSwgXCJsaW5rXCIsIHZvaWQgMCk7XG4gICAgICAgICAgICBfX2RlY29yYXRlKFt0eXBlZGpzb25fbnBtXzEuSnNvbk1lbWJlcih7IHR5cGU6IEJvb2xlYW4gfSldLCBJbnRlcmFjdGlvbi5wcm90b3R5cGUsIFwid3JpdGFibGVcIiwgdm9pZCAwKTtcbiAgICAgICAgICAgIF9fZGVjb3JhdGUoW3R5cGVkanNvbl9ucG1fMS5Kc29uTWVtYmVyKHsgdHlwZTogT2JqZWN0IH0pXSwgSW50ZXJhY3Rpb24ucHJvdG90eXBlLCBcImlucHV0RGF0YVwiLCB2b2lkIDApO1xuICAgICAgICAgICAgX19kZWNvcmF0ZShbdHlwZWRqc29uX25wbV8xLkpzb25NZW1iZXIoeyB0eXBlOiBPYmplY3QgfSldLCBJbnRlcmFjdGlvbi5wcm90b3R5cGUsIFwib3V0cHV0RGF0YVwiLCB2b2lkIDApO1xuICAgICAgICAgICAgSW50ZXJhY3Rpb24gPSBfX2RlY29yYXRlKFt0eXBlZGpzb25fbnBtXzEuSnNvbk9iamVjdCh7IGtub3duVHlwZXM6IFtJbnRlcmFjdGlvbkxpbmtdIH0pXSwgSW50ZXJhY3Rpb24pO1xuICAgICAgICAgICAgZXhwb3J0cy5JbnRlcmFjdGlvbiA9IEludGVyYWN0aW9uO1xuICAgICAgICAgICAgdmFyIFRoaW5nRGVzY3JpcHRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gVGhpbmdEZXNjcmlwdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250ZXh0ID0gWydodHRwOi8vdzNjLmdpdGh1Yi5pby93b3QvdzNjLXdvdC10ZC1jb250ZXh0Lmpzb25sZCddO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbWFudGljVHlwZSA9IFsnVGhpbmcnXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnRlcmFjdGlvbiA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gVGhpbmdEZXNjcmlwdGlvbjtcbiAgICAgICAgICAgIH0oKTtcbiAgICAgICAgICAgIF9fZGVjb3JhdGUoW3R5cGVkanNvbl9ucG1fMS5Kc29uTWVtYmVyKHsgbmFtZTogJ0B0eXBlJywgZWxlbWVudHM6IFN0cmluZyB9KV0sIFRoaW5nRGVzY3JpcHRpb24ucHJvdG90eXBlLCBcInNlbWFudGljVHlwZVwiLCB2b2lkIDApO1xuICAgICAgICAgICAgX19kZWNvcmF0ZShbdHlwZWRqc29uX25wbV8xLkpzb25NZW1iZXIoeyBpc1JlcXVpcmVkOiB0cnVlLCB0eXBlOiBTdHJpbmcgfSldLCBUaGluZ0Rlc2NyaXB0aW9uLnByb3RvdHlwZSwgXCJuYW1lXCIsIHZvaWQgMCk7XG4gICAgICAgICAgICBfX2RlY29yYXRlKFt0eXBlZGpzb25fbnBtXzEuSnNvbk1lbWJlcih7IHR5cGU6IFN0cmluZyB9KV0sIFRoaW5nRGVzY3JpcHRpb24ucHJvdG90eXBlLCBcImJhc2VcIiwgdm9pZCAwKTtcbiAgICAgICAgICAgIF9fZGVjb3JhdGUoW3R5cGVkanNvbl9ucG1fMS5Kc29uTWVtYmVyKHsgaXNSZXF1aXJlZDogdHJ1ZSwgZWxlbWVudHM6IEludGVyYWN0aW9uIH0pXSwgVGhpbmdEZXNjcmlwdGlvbi5wcm90b3R5cGUsIFwiaW50ZXJhY3Rpb25cIiwgdm9pZCAwKTtcbiAgICAgICAgICAgIF9fZGVjb3JhdGUoW3R5cGVkanNvbl9ucG1fMS5Kc29uTWVtYmVyKHsgbmFtZTogJ0Bjb250ZXh0JywgZWxlbWVudHM6IFN0cmluZyB9KV0sIFRoaW5nRGVzY3JpcHRpb24ucHJvdG90eXBlLCBcImNvbnRleHRcIiwgdm9pZCAwKTtcbiAgICAgICAgICAgIFRoaW5nRGVzY3JpcHRpb24gPSBfX2RlY29yYXRlKFt0eXBlZGpzb25fbnBtXzEuSnNvbk9iamVjdCh7IGtub3duVHlwZXM6IFtJbnRlcmFjdGlvbl0gfSldLCBUaGluZ0Rlc2NyaXB0aW9uKTtcbiAgICAgICAgICAgIGV4cG9ydHMuZGVmYXVsdCA9IFRoaW5nRGVzY3JpcHRpb247XG4gICAgICAgIH0sIHsgXCJ0eXBlZGpzb24tbnBtXCI6IDkgfV0sIDk6IFtmdW5jdGlvbiAocmVxdWlyZSwgbW9kdWxlLCBleHBvcnRzKSB7XG4gICAgICAgICAgICAvKiFcbiAgICAgICAgICAgIFR5cGVkSlNPTiB2MC4yLjAgLSBodHRwczovL2dpdGh1Yi5jb20vSm9obldoaXRlVEIvVHlwZWRKU09OXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIFR5cGVkIEpTT04gcGFyc2luZyBhbmQgc2VyaWFsaXppbmcgdGhhdCBwcmVzZXJ2ZXMgdHlwZSBpbmZvcm1hdGlvbi4gUGFyc2UgSlNPTiBpbnRvIGFjdHVhbCBjbGFzcyBpbnN0YW5jZXMuIFJlY29tbWVuZGVkIChidXQgbm90IHJlcXVpcmVkKVxuICAgICAgICAgICAgdG8gYmUgdXNlZCB3aXRoIHJlZmxlY3QtbWV0YWRhdGEgKGdsb2JhbCBpbnN0YWxsYXRpb24pOiBodHRwczovL2dpdGh1Yi5jb20vcmJ1Y2t0b24vUmVmbGVjdERlY29yYXRvcnMuXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgVGhlIE1JVCBMaWNlbnNlIChNSVQpXG4gICAgICAgICAgICBDb3B5cmlnaHQgKGMpIDIwMTYgSm9obiBXaGl0ZVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlXG4gICAgICAgICAgICBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuICAgICAgICAgICAgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0b1xuICAgICAgICAgICAgdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuICAgICAgICAgICAgXG4gICAgICAgICAgICBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GXG4gICAgICAgICAgICBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZXG4gICAgICAgICAgICBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRVxuICAgICAgICAgICAgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG4gICAgICAgICAgICAqL1xuICAgICAgICAgICAgKGZ1bmN0aW9uIChmYWN0b3J5KSB7XG4gICAgICAgICAgICAgICAgaWYgKCh0eXBlb2YgbW9kdWxlID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2YobW9kdWxlKSkgPT09ICdvYmplY3QnICYmIF90eXBlb2YobW9kdWxlLmV4cG9ydHMpID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdiA9IGZhY3RvcnkocmVxdWlyZSwgZXhwb3J0cyk7aWYgKHYgIT09IHVuZGVmaW5lZCkgbW9kdWxlLmV4cG9ydHMgPSB2O1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmluZShbXCJyZXF1aXJlXCIsIFwiZXhwb3J0c1wiXSwgZmFjdG9yeSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkoZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMpIHtcbiAgICAgICAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICAgICAgICAgIHZhciBNRVRBREFUQV9GSUVMRF9LRVkgPSBcIl9fdHlwZWRKc29uSnNvbk9iamVjdE1ldGFkYXRhSW5mb3JtYXRpb25fX1wiO1xuICAgICAgICAgICAgICAgIHZhciBKU09OO1xuICAgICAgICAgICAgICAgIGlmICghSlNPTikge1xuICAgICAgICAgICAgICAgICAgICBKU09OID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2U6IGZ1bmN0aW9uIHBhcnNlKHNKU09OKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJldHVybnZhbCA9IHNKU09OO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodHlwZW9mIHJldHVybnZhbCA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKHJldHVybnZhbCkpID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmV0dXJudmFsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBldmFsKCcoJyArIHNKU09OICsgJyknKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5naWZ5OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRvU3RyaW5nLmNhbGwoYSkgPT09ICdbb2JqZWN0IEFycmF5XSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXNjTWFwID0geyAnXCInOiAnXFxcXFwiJywgJ1xcXFwnOiAnXFxcXFxcXFwnLCAnXFxiJzogJ1xcXFxiJywgJ1xcZic6ICdcXFxcZicsICdcXG4nOiAnXFxcXG4nLCAnXFxyJzogJ1xcXFxyJywgJ1xcdCc6ICdcXFxcdCcgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXNjRnVuYyA9IGZ1bmN0aW9uIGVzY0Z1bmMobSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXNjTWFwW21dIHx8IFwiXFxcXHVcIiArIChtLmNoYXJDb2RlQXQoMCkgKyAweDEwMDAwKS50b1N0cmluZygxNikuc3Vic3RyKDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVzY1JFID0gL1tcXFxcXCJcXHUwMDAwLVxcdTAwMUZcXHUyMDI4XFx1MjAyOV0vZztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gc3RyaW5naWZ5KHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ251bGwnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpc0Zpbml0ZSh2YWx1ZSkgPyB2YWx1ZS50b1N0cmluZygpIDogJ251bGwnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgodHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2YodmFsdWUpKSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUudG9KU09OID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0cmluZ2lmeSh2YWx1ZS50b0pTT04oKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9ICdbJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbHVlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyArPSAoaSA/ICcsICcgOiAnJykgKyBzdHJpbmdpZnkodmFsdWVbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1yZXR1cm4gcmVzICsgJ10nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0b1N0cmluZy5jYWxsKHZhbHVlKSA9PT0gJ1tvYmplY3QgT2JqZWN0XScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG1wID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgayBpbiB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUuaGFzT3duUHJvcGVydHkoaykpIHRtcC5wdXNoKHN0cmluZ2lmeShrKSArICc6ICcgKyBzdHJpbmdpZnkodmFsdWVba10pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICd7JyArIHRtcC5qb2luKCcsICcpICsgJ30nO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnXCInICsgdmFsdWUudG9TdHJpbmcoKS5yZXBsYWNlKGVzY1JFLCBlc2NGdW5jKSArICdcIic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0oKVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgSGVscGVycztcbiAgICAgICAgICAgICAgICAoZnVuY3Rpb24gKEhlbHBlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYXNzaWduKHRhcmdldCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNvdXJjZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvdXRwdXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc291cmNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldCA9PT0gdW5kZWZpbmVkIHx8IHRhcmdldCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY29udmVydCB1bmRlZmluZWQgb3IgbnVsbCB0byBvYmplY3RcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSBPYmplY3QodGFyZ2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2UgIT09IHVuZGVmaW5lZCAmJiBzb3VyY2UgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbmV4dEtleSBpbiBzb3VyY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2UuaGFzT3duUHJvcGVydHkobmV4dEtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRbbmV4dEtleV0gPSBzb3VyY2VbbmV4dEtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIEhlbHBlcnMuYXNzaWduID0gYXNzaWduO1xuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBlcnJvcihtZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3B0aW9uYWxQYXJhbXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWxQYXJhbXNbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHR5cGVvZiBjb25zb2xlID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2YoY29uc29sZSkpID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBjb25zb2xlLmVycm9yID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yLmFwcGx5KGNvbnNvbGUsIFttZXNzYWdlXS5jb25jYXQob3B0aW9uYWxQYXJhbXMpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKHR5cGVvZiBjb25zb2xlID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2YoY29uc29sZSkpID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBjb25zb2xlLmxvZyA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgW1wiRVJST1I6IFwiICsgbWVzc2FnZV0uY29uY2F0KG9wdGlvbmFsUGFyYW1zKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgSGVscGVycy5lcnJvciA9IGVycm9yO1xuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXRDbGFzc05hbWUodGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0VHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGFyZ2V0ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRUeXBlID0gdGFyZ2V0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgodHlwZW9mIHRhcmdldCA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKHRhcmdldCkpID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0VHlwZSA9IHRhcmdldC5jb25zdHJ1Y3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0VHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcInVuZGVmaW5lZFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFwibmFtZVwiIGluIHRhcmdldFR5cGUgJiYgdHlwZW9mIHRhcmdldFR5cGUubmFtZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRUeXBlLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRUeXBlLnRvU3RyaW5nKCkubWF0Y2goL2Z1bmN0aW9uIChcXHcqKS8pWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIEhlbHBlcnMuZ2V0Q2xhc3NOYW1lID0gZ2V0Q2xhc3NOYW1lO1xuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXREZWZhdWx0VmFsdWUodHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBOdW1iZXI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgU3RyaW5nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIEJvb2xlYW46XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIEFycmF5OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgSGVscGVycy5nZXREZWZhdWx0VmFsdWUgPSBnZXREZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGdldFByb3BlcnR5RGlzcGxheU5hbWUodGFyZ2V0LCBwcm9wZXJ0eUtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldENsYXNzTmFtZSh0YXJnZXQpICsgXCIuXCIgKyBwcm9wZXJ0eUtleS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIEhlbHBlcnMuZ2V0UHJvcGVydHlEaXNwbGF5TmFtZSA9IGdldFByb3BlcnR5RGlzcGxheU5hbWU7XG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGlzQXJyYXkob2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIEFycmF5LmlzQXJyYXkgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBBcnJheS5pc0FycmF5KG9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYmplY3QgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIEhlbHBlcnMuaXNBcnJheSA9IGlzQXJyYXk7XG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGlzUHJpbWl0aXZlKG9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0eXBlb2Ygb2JqID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2Yob2JqKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzdHJpbmdcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwibnVtYmVyXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImJvb2xlYW5cIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqIGluc3RhbmNlb2YgU3RyaW5nIHx8IG9iaiA9PT0gU3RyaW5nIHx8IG9iaiBpbnN0YW5jZW9mIE51bWJlciB8fCBvYmogPT09IE51bWJlciB8fCBvYmogaW5zdGFuY2VvZiBCb29sZWFuIHx8IG9iaiA9PT0gQm9vbGVhbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIEhlbHBlcnMuaXNQcmltaXRpdmUgPSBpc1ByaW1pdGl2ZTtcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gaXNSZXNlcnZlZE1lbWJlck5hbWUobmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5hbWUgPT09IE1FVEFEQVRBX0ZJRUxEX0tFWTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBIZWxwZXJzLmlzUmVzZXJ2ZWRNZW1iZXJOYW1lID0gaXNSZXNlcnZlZE1lbWJlck5hbWU7XG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGlzU3VidHlwZU9mKEEsIEIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhUHJvdG90eXBlID0gQS5wcm90b3R5cGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoQSA9PT0gQikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGFQcm90b3R5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYVByb3RvdHlwZSBpbnN0YW5jZW9mIEIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFQcm90b3R5cGUgPSBhUHJvdG90eXBlLnByb3RvdHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBIZWxwZXJzLmlzU3VidHlwZU9mID0gaXNTdWJ0eXBlT2Y7XG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGxvZyhtZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3B0aW9uYWxQYXJhbXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWxQYXJhbXNbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHR5cGVvZiBjb25zb2xlID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2YoY29uc29sZSkpID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBjb25zb2xlLmxvZyA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgW21lc3NhZ2VdLmNvbmNhdChvcHRpb25hbFBhcmFtcykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIEhlbHBlcnMubG9nID0gbG9nO1xuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBtZXJnZSh0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzb3VyY2VzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZXNbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3V0cHV0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNvdXJjZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXQgPT09IHVuZGVmaW5lZCB8fCB0YXJnZXQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNvbnZlcnQgdW5kZWZpbmVkIG9yIG51bGwgdG8gb2JqZWN0XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyh0YXJnZXQpLmZvckVhY2goZnVuY3Rpb24gKG5leHRLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRbbmV4dEtleV0gPSB0YXJnZXRbbmV4dEtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2UgIT09IHVuZGVmaW5lZCAmJiBzb3VyY2UgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbmV4dEtleSBpbiBzb3VyY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2UuaGFzT3duUHJvcGVydHkobmV4dEtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRbbmV4dEtleV0gPSBzb3VyY2VbbmV4dEtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIEhlbHBlcnMubWVyZ2UgPSBtZXJnZTtcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gdmFsdWVJc0RlZmluZWQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCIgfHwgdmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIEhlbHBlcnMudmFsdWVJc0RlZmluZWQgPSB2YWx1ZUlzRGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gd2FybihtZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3B0aW9uYWxQYXJhbXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uYWxQYXJhbXNbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHR5cGVvZiBjb25zb2xlID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2YoY29uc29sZSkpID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBjb25zb2xlLndhcm4gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2Fybi5hcHBseShjb25zb2xlLCBbbWVzc2FnZV0uY29uY2F0KG9wdGlvbmFsUGFyYW1zKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCh0eXBlb2YgY29uc29sZSA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKGNvbnNvbGUpKSA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgY29uc29sZS5sb2cgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIFtcIldBUk5JTkc6IFwiICsgbWVzc2FnZV0uY29uY2F0KG9wdGlvbmFsUGFyYW1zKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgSGVscGVycy53YXJuID0gd2FybjtcbiAgICAgICAgICAgICAgICB9KShIZWxwZXJzIHx8IChIZWxwZXJzID0ge30pKTtcbiAgICAgICAgICAgICAgICB2YXIgSnNvbk1lbWJlck1ldGFkYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBKc29uTWVtYmVyTWV0YWRhdGEoKSB7fVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gSnNvbk1lbWJlck1ldGFkYXRhO1xuICAgICAgICAgICAgICAgIH0oKTtcbiAgICAgICAgICAgICAgICB2YXIgSnNvbk9iamVjdE1ldGFkYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBKc29uT2JqZWN0TWV0YWRhdGEoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9kYXRhTWVtYmVycyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fa25vd25UeXBlcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fa25vd25UeXBlQ2FjaGUgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0V4cGxpY2l0bHlNYXJrZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBKc29uT2JqZWN0TWV0YWRhdGEuZ2V0SnNvbk9iamVjdE5hbWUgPSBmdW5jdGlvbiAodHlwZSwgaW5oZXJpdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5oZXJpdGVkID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmhlcml0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1ldGFkYXRhID0gdGhpcy5nZXRGcm9tVHlwZSh0eXBlLCBpbmhlcml0ZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1ldGFkYXRhICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1ldGFkYXRhLmNsYXNzTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEhlbHBlcnMuZ2V0Q2xhc3NOYW1lKHR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBKc29uT2JqZWN0TWV0YWRhdGEuZ2V0RnJvbVR5cGUgPSBmdW5jdGlvbiAodGFyZ2V0LCBpbmhlcml0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmhlcml0ZWQgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaGVyaXRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0UHJvdG90eXBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1ldGFkYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0YXJnZXQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFByb3RvdHlwZSA9IHRhcmdldC5wcm90b3R5cGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFByb3RvdHlwZSA9IHRhcmdldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0UHJvdG90eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0UHJvdG90eXBlLmhhc093blByb3BlcnR5KE1FVEFEQVRBX0ZJRUxEX0tFWSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YSA9IHRhcmdldFByb3RvdHlwZVtNRVRBREFUQV9GSUVMRF9LRVldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbmhlcml0ZWQgJiYgdGFyZ2V0UHJvdG90eXBlW01FVEFEQVRBX0ZJRUxEX0tFWV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YSA9IHRhcmdldFByb3RvdHlwZVtNRVRBREFUQV9GSUVMRF9LRVldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1ldGFkYXRhICYmIG1ldGFkYXRhLmlzRXhwbGljaXRseU1hcmtlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtZXRhZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIEpzb25PYmplY3RNZXRhZGF0YS5nZXRGcm9tSW5zdGFuY2UgPSBmdW5jdGlvbiAodGFyZ2V0LCBpbmhlcml0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmhlcml0ZWQgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaGVyaXRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRGcm9tVHlwZShPYmplY3QuZ2V0UHJvdG90eXBlT2YodGFyZ2V0KSwgaW5oZXJpdGVkKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgSnNvbk9iamVjdE1ldGFkYXRhLmdldEtub3duVHlwZU5hbWVGcm9tVHlwZSA9IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXRhZGF0YSA9IHRoaXMuZ2V0RnJvbVR5cGUodGFyZ2V0LCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWV0YWRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWV0YWRhdGEuY2xhc3NOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gSGVscGVycy5nZXRDbGFzc05hbWUodGFyZ2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgSnNvbk9iamVjdE1ldGFkYXRhLmdldEtub3duVHlwZU5hbWVGcm9tSW5zdGFuY2UgPSBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWV0YWRhdGEgPSB0aGlzLmdldEZyb21JbnN0YW5jZSh0YXJnZXQsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZXRhZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtZXRhZGF0YS5jbGFzc05hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBIZWxwZXJzLmdldENsYXNzTmFtZSh0YXJnZXQuY29uc3RydWN0b3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSnNvbk9iamVjdE1ldGFkYXRhLnByb3RvdHlwZSwgXCJkYXRhTWVtYmVyc1wiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZGF0YU1lbWJlcnM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEpzb25PYmplY3RNZXRhZGF0YS5wcm90b3R5cGUsIFwiY2xhc3NOYW1lXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5fY2xhc3NOYW1lID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jbGFzc05hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEhlbHBlcnMuZ2V0Q2xhc3NOYW1lKHRoaXMuY2xhc3NUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jbGFzc05hbWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSnNvbk9iamVjdE1ldGFkYXRhLnByb3RvdHlwZSwgXCJrbm93blR5cGVzXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrbm93blR5cGVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrbm93blR5cGVOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtub3duVHlwZXMgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9rbm93blR5cGVzLmZvckVhY2goZnVuY3Rpb24gKGtub3duVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrbm93blR5cGVOYW1lID0gSnNvbk9iamVjdE1ldGFkYXRhLmdldEtub3duVHlwZU5hbWVGcm9tVHlwZShrbm93blR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrbm93blR5cGVzW2tub3duVHlwZU5hbWVdID0ga25vd25UeXBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2tub3duVHlwZUNhY2hlID0ga25vd25UeXBlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ga25vd25UeXBlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBKc29uT2JqZWN0TWV0YWRhdGEucHJvdG90eXBlLnNldEtub3duVHlwZSA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fa25vd25UeXBlcy5pbmRleE9mKHR5cGUpID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2tub3duVHlwZXMucHVzaCh0eXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9rbm93blR5cGVDYWNoZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIEpzb25PYmplY3RNZXRhZGF0YS5wcm90b3R5cGUuYWRkTWVtYmVyID0gZnVuY3Rpb24gKG1lbWJlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKHRoaXMuX2RhdGFNZW1iZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wZXJ0eUtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5fZGF0YU1lbWJlcnNbcHJvcGVydHlLZXldLm5hbWUgPT09IG1lbWJlci5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkEgbWVtYmVyIHdpdGggdGhlIG5hbWUgJ1wiICsgbWVtYmVyLm5hbWUgKyBcIicgYWxyZWFkeSBleGlzdHMuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGF0YU1lbWJlcnNbbWVtYmVyLmtleV0gPSBtZW1iZXI7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIEpzb25PYmplY3RNZXRhZGF0YS5wcm90b3R5cGUuc29ydE1lbWJlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lbWJlckFycmF5ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLl9kYXRhTWVtYmVycykuZm9yRWFjaChmdW5jdGlvbiAocHJvcGVydHlLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXJBcnJheS5wdXNoKF90aGlzLl9kYXRhTWVtYmVyc1twcm9wZXJ0eUtleV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXJBcnJheSA9IG1lbWJlckFycmF5LnNvcnQodGhpcy5zb3J0TWVtYmVyc0NvbXBhcmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGF0YU1lbWJlcnMgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lbWJlckFycmF5LmZvckVhY2goZnVuY3Rpb24gKGRhdGFNZW1iZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fZGF0YU1lbWJlcnNbZGF0YU1lbWJlci5rZXldID0gZGF0YU1lbWJlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBKc29uT2JqZWN0TWV0YWRhdGEucHJvdG90eXBlLnNvcnRNZW1iZXJzQ29tcGFyZSA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGEub3JkZXIgIT09IFwibnVtYmVyXCIgJiYgdHlwZW9mIGIub3JkZXIgIT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYS5uYW1lIDwgYi5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGEubmFtZSA+IGIubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhLm9yZGVyICE9PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBiLm9yZGVyICE9PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYS5vcmRlciA8IGIub3JkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYS5vcmRlciA+IGIub3JkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEubmFtZSA8IGIubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGEubmFtZSA+IGIubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEpzb25PYmplY3RNZXRhZGF0YTtcbiAgICAgICAgICAgICAgICB9KCk7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gSnNvbk9iamVjdChvcHRpb25zT3JUYXJnZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb3B0aW9uc09yVGFyZ2V0ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zT3JUYXJnZXQgfHwge307XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGluaXRpYWxpemVyID0gb3B0aW9ucy5pbml0aWFsaXplcjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlcmlhbGl6ZXIgPSBvcHRpb25zLnNlcmlhbGl6ZXI7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWNvcmF0b3IgPSBmdW5jdGlvbiBkZWNvcmF0b3IodGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqZWN0TWV0YWRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50TWV0YWRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eShNRVRBREFUQV9GSUVMRF9LRVkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0TWV0YWRhdGEgPSBuZXcgSnNvbk9iamVjdE1ldGFkYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudE1ldGFkYXRhID0gdGFyZ2V0LnByb3RvdHlwZVtNRVRBREFUQV9GSUVMRF9LRVldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKHBhcmVudE1ldGFkYXRhLmRhdGFNZW1iZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChtZW1iZXJQcm9wZXJ0eUtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0TWV0YWRhdGEuZGF0YU1lbWJlcnNbbWVtYmVyUHJvcGVydHlLZXldID0gcGFyZW50TWV0YWRhdGEuZGF0YU1lbWJlcnNbbWVtYmVyUHJvcGVydHlLZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXMocGFyZW50TWV0YWRhdGEua25vd25UeXBlcykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RNZXRhZGF0YS5zZXRLbm93blR5cGUocGFyZW50TWV0YWRhdGEua25vd25UeXBlc1trZXldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQucHJvdG90eXBlLCBNRVRBREFUQV9GSUVMRF9LRVksIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG9iamVjdE1ldGFkYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdE1ldGFkYXRhID0gdGFyZ2V0LnByb3RvdHlwZVtNRVRBREFUQV9GSUVMRF9LRVldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0TWV0YWRhdGEuY2xhc3NUeXBlID0gdGFyZ2V0O1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0TWV0YWRhdGEuaXNFeHBsaWNpdGx5TWFya2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RNZXRhZGF0YS5jbGFzc05hbWUgPSBvcHRpb25zLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5rbm93blR5cGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5rbm93blR5cGVzLmZvckVhY2goZnVuY3Rpb24gKGtub3duVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBrbm93blR5cGUgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiS25vd24gdHlwZSAjXCIgKyBpKysgKyBcIiBpcyB1bmRlZmluZWQuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0TWV0YWRhdGEuc2V0S25vd25UeXBlKGtub3duVHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSGVscGVycy5lcnJvcihuZXcgVHlwZUVycm9yKFwiQEpzb25PYmplY3Q6IFwiICsgZS5tZXNzYWdlICsgXCIgKG9uICdcIiArIEhlbHBlcnMuZ2V0Q2xhc3NOYW1lKHRhcmdldCkgKyBcIicpXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGluaXRpYWxpemVyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RNZXRhZGF0YS5pbml0aWFsaXplciA9IGluaXRpYWxpemVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHNlcmlhbGl6ZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdE1ldGFkYXRhLnNlcmlhbGl6ZXIgPSBzZXJpYWxpemVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnNPclRhcmdldCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVjb3JhdG9yKG9wdGlvbnNPclRhcmdldCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVjb3JhdG9yO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGV4cG9ydHMuSnNvbk9iamVjdCA9IEpzb25PYmplY3Q7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb24ganNvbk1lbWJlclR5cGVJbml0KG1ldGFkYXRhLCBwcm9wZXJ0eU5hbWUsIHdhcm5BcnJheSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAod2FybkFycmF5ID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdhcm5BcnJheSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChtZXRhZGF0YS5lbGVtZW50cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtZXRhZGF0YS5lbGVtZW50cyA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGEuZWxlbWVudHMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IG1ldGFkYXRhLmVsZW1lbnRzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbWV0YWRhdGEudHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhLnR5cGUgPSBBcnJheTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobWV0YWRhdGEudHlwZSA9PT0gQXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbWV0YWRhdGEuZWxlbWVudHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAod2FybkFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhlbHBlcnMud2FybihcIk5vIHZhbGlkICdlbGVtZW50cycgb3B0aW9uIHdhcyBzcGVjaWZpZWQgZm9yICdcIiArIHByb3BlcnR5TmFtZSArIFwiJy5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gdmFsaWQgJ2VsZW1lbnRzJyBvcHRpb24gd2FzIHNwZWNpZmllZCBmb3IgJ1wiICsgcHJvcGVydHlOYW1lICsgXCInLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb25NZW1iZXJUeXBlSW5pdChtZXRhZGF0YS5lbGVtZW50cywgcHJvcGVydHlOYW1lICsgJ1tdJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtZXRhZGF0YS50eXBlICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIHZhbGlkICd0eXBlJyBvcHRpb24gd2FzIHNwZWNpZmllZCBmb3IgJ1wiICsgcHJvcGVydHlOYW1lICsgXCInLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBqc29uTWVtYmVyS25vd25UeXBlcyhtZXRhZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIga25vd25UeXBlcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICAgICAgICAgICAgICBrbm93blR5cGVzLnB1c2gobWV0YWRhdGEudHlwZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtZXRhZGF0YS5lbGVtZW50cykge1xuICAgICAgICAgICAgICAgICAgICAgICAga25vd25UeXBlcyA9IGtub3duVHlwZXMuY29uY2F0KGpzb25NZW1iZXJLbm93blR5cGVzKG1ldGFkYXRhLmVsZW1lbnRzKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtub3duVHlwZXM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIEpzb25NZW1iZXIob3B0aW9uc09yVGFyZ2V0LCBwcm9wZXJ0eUtleSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWVtYmVyTWV0YWRhdGEgPSBuZXcgSnNvbk1lbWJlck1ldGFkYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvcHRpb25zO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVjb3JhdG9yO1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHByb3BlcnR5S2V5ID09PSBcInN0cmluZ1wiIHx8ICh0eXBlb2YgcHJvcGVydHlLZXkgPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZihwcm9wZXJ0eUtleSkpID09PSBcInN5bWJvbFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zID0ge307XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zID0gb3B0aW9uc09yVGFyZ2V0IHx8IHt9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRlY29yYXRvciA9IGZ1bmN0aW9uIGRlY29yYXRvcih0YXJnZXQsIHByb3BlcnR5S2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBwcm9wZXJ0eUtleS50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmplY3RNZXRhZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnRNZXRhZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWZsZWN0VHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9wZXJ0eU5hbWUgPSBIZWxwZXJzLmdldFByb3BlcnR5RGlzcGxheU5hbWUodGFyZ2V0LCBwcm9wZXJ0eUtleSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRhcmdldCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkBKc29uTWVtYmVyIGNhbm5vdCBiZSB1c2VkIG9uIGEgc3RhdGljIHByb3BlcnR5ICgnXCIgKyBwcm9wZXJ0eU5hbWUgKyBcIicpLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGFyZ2V0W3Byb3BlcnR5S2V5XSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkBKc29uTWVtYmVyIGNhbm5vdCBiZSB1c2VkIG9uIGEgbWV0aG9kIHByb3BlcnR5ICgnXCIgKyBwcm9wZXJ0eU5hbWUgKyBcIicpLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmhhc093blByb3BlcnR5KFwiZWxlbWVudFR5cGVcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBIZWxwZXJzLndhcm4ocHJvcGVydHlOYW1lICsgXCI6IHRoZSAnZWxlbWVudFR5cGUnIG9wdGlvbiBpcyBkZXByZWNhdGVkLCB1c2UgJ2VsZW1lbnRzJyBpbnN0ZWFkLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmVsZW1lbnRzID0gb3B0aW9ucy5lbGVtZW50VHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5lbGVtZW50VHlwZSA9PT0gQXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVyTWV0YWRhdGEuZm9yY2VFbmFibGVUeXBlSGludGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVyTWV0YWRhdGEgPSBIZWxwZXJzLmFzc2lnbihtZW1iZXJNZXRhZGF0YSwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXJNZXRhZGF0YS5rZXkgPSBwcm9wZXJ0eUtleS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVyTWV0YWRhdGEubmFtZSA9IG9wdGlvbnMubmFtZSB8fCBwcm9wZXJ0eUtleS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEhlbHBlcnMuaXNSZXNlcnZlZE1lbWJlck5hbWUobWVtYmVyTWV0YWRhdGEubmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJASnNvbk1lbWJlcjogJ1wiICsgbWVtYmVyTWV0YWRhdGEubmFtZSArIFwiJyBpcyBhIHJlc2VydmVkIG5hbWUuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuaGFzT3duUHJvcGVydHkoXCJ0eXBlXCIpICYmIHR5cGVvZiBvcHRpb25zLnR5cGUgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQEpzb25NZW1iZXI6ICd0eXBlJyBvZiAnXCIgKyBwcm9wZXJ0eU5hbWUgKyBcIicgaXMgdW5kZWZpbmVkLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodHlwZW9mIFJlZmxlY3QgPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZihSZWZsZWN0KSkgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZ2V0TWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZmxlY3RUeXBlID0gUmVmbGVjdC5nZXRNZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIHRhcmdldCwgcHJvcGVydHlLZXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVmbGVjdFR5cGUgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkBKc29uTWVtYmVyOiB0eXBlIGRldGVjdGVkIGZvciAnXCIgKyBwcm9wZXJ0eU5hbWUgKyBcIicgaXMgdW5kZWZpbmVkLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFtZW1iZXJNZXRhZGF0YS50eXBlIHx8IHR5cGVvZiBtZW1iZXJNZXRhZGF0YS50eXBlICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVyTWV0YWRhdGEudHlwZSA9IHJlZmxlY3RUeXBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWVtYmVyTWV0YWRhdGEudHlwZSAhPT0gcmVmbGVjdFR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSGVscGVycy53YXJuKFwiQEpzb25NZW1iZXI6ICd0eXBlJyBzcGVjaWZpZWQgZm9yICdcIiArIHByb3BlcnR5TmFtZSArIFwiJyBkb2VzIG5vdCBtYXRjaCBkZXRlY3RlZCB0eXBlLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBqc29uTWVtYmVyVHlwZUluaXQobWVtYmVyTWV0YWRhdGEsIHByb3BlcnR5TmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRhcmdldC5oYXNPd25Qcm9wZXJ0eShNRVRBREFUQV9GSUVMRF9LRVkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0TWV0YWRhdGEgPSBuZXcgSnNvbk9iamVjdE1ldGFkYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudE1ldGFkYXRhID0gdGFyZ2V0W01FVEFEQVRBX0ZJRUxEX0tFWV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXMocGFyZW50TWV0YWRhdGEuZGF0YU1lbWJlcnMpLmZvckVhY2goZnVuY3Rpb24gKG1lbWJlclByb3BlcnR5S2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RNZXRhZGF0YS5kYXRhTWVtYmVyc1ttZW1iZXJQcm9wZXJ0eUtleV0gPSBwYXJlbnRNZXRhZGF0YS5kYXRhTWVtYmVyc1ttZW1iZXJQcm9wZXJ0eUtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBNRVRBREFUQV9GSUVMRF9LRVksIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG9iamVjdE1ldGFkYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdE1ldGFkYXRhID0gdGFyZ2V0W01FVEFEQVRBX0ZJRUxEX0tFWV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBqc29uTWVtYmVyS25vd25UeXBlcyhtZW1iZXJNZXRhZGF0YSkuZm9yRWFjaChmdW5jdGlvbiAoa25vd25UeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0TWV0YWRhdGEuc2V0S25vd25UeXBlKGtub3duVHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0TWV0YWRhdGEuYWRkTWVtYmVyKG1lbWJlck1ldGFkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJNZW1iZXIgJ1wiICsgbWVtYmVyTWV0YWRhdGEubmFtZSArIFwiJyBhbHJlYWR5IGV4aXN0cyBvbiAnXCIgKyBIZWxwZXJzLmdldENsYXNzTmFtZShvYmplY3RNZXRhZGF0YS5jbGFzc1R5cGUpICsgXCInLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBwcm9wZXJ0eUtleSA9PT0gXCJzdHJpbmdcIiB8fCAodHlwZW9mIHByb3BlcnR5S2V5ID09PSBcInVuZGVmaW5lZFwiID8gXCJ1bmRlZmluZWRcIiA6IF90eXBlb2YocHJvcGVydHlLZXkpKSA9PT0gXCJzeW1ib2xcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlY29yYXRvcihvcHRpb25zT3JUYXJnZXQsIHByb3BlcnR5S2V5KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWNvcmF0b3I7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZXhwb3J0cy5Kc29uTWVtYmVyID0gSnNvbk1lbWJlcjtcbiAgICAgICAgICAgICAgICB2YXIgU2VyaWFsaXplciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gU2VyaWFsaXplcigpIHt9XG4gICAgICAgICAgICAgICAgICAgIFNlcmlhbGl6ZXIud3JpdGVPYmplY3QgPSBmdW5jdGlvbiAob2JqZWN0LCBzZXR0aW5ncykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9iamVjdE1ldGFkYXRhID0gSnNvbk9iamVjdE1ldGFkYXRhLmdldEZyb21JbnN0YW5jZShvYmplY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIE9iamVjdFR5cGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqZWN0TWV0YWRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3RUeXBlID0gb2JqZWN0TWV0YWRhdGEuY2xhc3NUeXBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3RUeXBlID0gb2JqZWN0LmNvbnN0cnVjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMud3JpdGVUb0pzb25PYmplY3Qob2JqZWN0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0VHlwZTogT2JqZWN0VHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVUeXBlSGludHM6IHNldHRpbmdzLmVuYWJsZVR5cGVIaW50cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlSGludFByb3BlcnR5S2V5OiBzZXR0aW5ncy50eXBlSGludFByb3BlcnR5S2V5XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSwgc2V0dGluZ3MucmVwbGFjZXIpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBTZXJpYWxpemVyLndyaXRlVG9Kc29uT2JqZWN0ID0gZnVuY3Rpb24gKG9iamVjdCwgc2V0dGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIganNvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmplY3RNZXRhZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYmplY3QgPT09IG51bGwgfHwgdHlwZW9mIG9iamVjdCA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5lbWl0RGVmYXVsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uID0gSGVscGVycy5nZXREZWZhdWx0VmFsdWUoc2V0dGluZ3Mub2JqZWN0VHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAganNvbiA9IG9iamVjdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEhlbHBlcnMuaXNQcmltaXRpdmUob2JqZWN0KSB8fCBvYmplY3QgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAganNvbiA9IG9iamVjdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAob2JqZWN0IGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG4gPSBvYmplY3QubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb24ucHVzaCh0aGlzLndyaXRlVG9Kc29uT2JqZWN0KG9iamVjdFtpXSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudHM6IHNldHRpbmdzLmVsZW1lbnRzID8gc2V0dGluZ3MuZWxlbWVudHMuZWxlbWVudHMgOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlVHlwZUhpbnRzOiBzZXR0aW5ncy5lbmFibGVUeXBlSGludHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RUeXBlOiBzZXR0aW5ncy5lbGVtZW50cyA/IHNldHRpbmdzLmVsZW1lbnRzLnR5cGUgOiBPYmplY3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlVHlwZUhpbnRzOiBzZXR0aW5ncy5yZXF1aXJlVHlwZUhpbnRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZUhpbnRQcm9wZXJ0eUtleTogc2V0dGluZ3MudHlwZUhpbnRQcm9wZXJ0eUtleVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RNZXRhZGF0YSA9IEpzb25PYmplY3RNZXRhZGF0YS5nZXRGcm9tSW5zdGFuY2Uob2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqZWN0TWV0YWRhdGEgJiYgdHlwZW9mIG9iamVjdE1ldGFkYXRhLnNlcmlhbGl6ZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uID0gb2JqZWN0TWV0YWRhdGEuc2VyaWFsaXplcihvYmplY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLmVuYWJsZVR5cGVIaW50cyAmJiAoc2V0dGluZ3MucmVxdWlyZVR5cGVIaW50cyB8fCBvYmplY3QuY29uc3RydWN0b3IgIT09IHNldHRpbmdzLm9iamVjdFR5cGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uW3NldHRpbmdzLnR5cGVIaW50UHJvcGVydHlLZXldID0gSnNvbk9iamVjdE1ldGFkYXRhLmdldEtub3duVHlwZU5hbWVGcm9tSW5zdGFuY2Uob2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqZWN0TWV0YWRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdE1ldGFkYXRhLnNvcnRNZW1iZXJzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhvYmplY3RNZXRhZGF0YS5kYXRhTWVtYmVycykuZm9yRWFjaChmdW5jdGlvbiAocHJvcGVydHlLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvcGVydHlNZXRhZGF0YSA9IG9iamVjdE1ldGFkYXRhLmRhdGFNZW1iZXJzW3Byb3BlcnR5S2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uW3Byb3BlcnR5TWV0YWRhdGEubmFtZV0gPSBfdGhpcy53cml0ZVRvSnNvbk9iamVjdChvYmplY3RbcHJvcGVydHlLZXldLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRzOiBwcm9wZXJ0eU1ldGFkYXRhLmVsZW1lbnRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0RGVmYXVsdDogcHJvcGVydHlNZXRhZGF0YS5lbWl0RGVmYXVsdFZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVUeXBlSGludHM6IHNldHRpbmdzLmVuYWJsZVR5cGVIaW50cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcHJvcGVydHlNZXRhZGF0YS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RUeXBlOiBwcm9wZXJ0eU1ldGFkYXRhLnR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVUeXBlSGludHM6IHNldHRpbmdzLnJlcXVpcmVUeXBlSGludHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVIaW50UHJvcGVydHlLZXk6IHNldHRpbmdzLnR5cGVIaW50UHJvcGVydHlLZXlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXMob2JqZWN0KS5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wZXJ0eUtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb25bcHJvcGVydHlLZXldID0gX3RoaXMud3JpdGVUb0pzb25PYmplY3Qob2JqZWN0W3Byb3BlcnR5S2V5XSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVUeXBlSGludHM6IHNldHRpbmdzLmVuYWJsZVR5cGVIaW50cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0VHlwZTogT2JqZWN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlVHlwZUhpbnRzOiBzZXR0aW5ncy5yZXF1aXJlVHlwZUhpbnRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlSGludFByb3BlcnR5S2V5OiBzZXR0aW5ncy50eXBlSGludFByb3BlcnR5S2V5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBqc29uO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gU2VyaWFsaXplcjtcbiAgICAgICAgICAgICAgICB9KCk7XG4gICAgICAgICAgICAgICAgdmFyIERlc2VyaWFsaXplciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gRGVzZXJpYWxpemVyKCkge31cbiAgICAgICAgICAgICAgICAgICAgRGVzZXJpYWxpemVyLnJlYWRPYmplY3QgPSBmdW5jdGlvbiAoanNvbiwgdHlwZSwgc2V0dGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXRhZGF0YSA9IEpzb25PYmplY3RNZXRhZGF0YS5nZXRGcm9tVHlwZSh0eXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YganNvbiA9PT0gJ09iamVjdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGpzb247XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gSlNPTi5wYXJzZShqc29uLCBzZXR0aW5ncy5yZXZpdmVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygc2V0dGluZ3MubWF4T2JqZWN0cyA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvdW50T2JqZWN0cyh2YWx1ZSkgPiBzZXR0aW5ncy5tYXhPYmplY3RzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkpTT04gZXhjZWVkcyBvYmplY3QgY291bnQgbGltaXQgKFwiICsgc2V0dGluZ3MubWF4T2JqZWN0cyArIFwiKS5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UgPSB0aGlzLnJlYWRKc29uVG9JbnN0YW5jZSh2YWx1ZSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdFR5cGU6IHR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZUhpbnRQcm9wZXJ0eUtleTogc2V0dGluZ3MudHlwZUhpbnRQcm9wZXJ0eUtleSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVUeXBlSGludHM6IHNldHRpbmdzLmVuYWJsZVR5cGVIaW50cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJpY3RUeXBlSGludE1vZGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga25vd25UeXBlczogbWV0YWRhdGEgPyBtZXRhZGF0YS5rbm93blR5cGVzIDoge31cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGluc3RhbmNlO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBEZXNlcmlhbGl6ZXIuY291bnRPYmplY3RzID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZih2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwib2JqZWN0XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoSGVscGVycy5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50XzEgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50XzEgKz0gX3RoaXMuY291bnRPYmplY3RzKGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY291bnRfMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb3VudF8yID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKHZhbHVlKS5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wZXJ0eUtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50XzIgKz0gX3RoaXMuY291bnRPYmplY3RzKHZhbHVlW3Byb3BlcnR5S2V5XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb3VudF8yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInVuZGVmaW5lZFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgRGVzZXJpYWxpemVyLnJlYWRKc29uVG9JbnN0YW5jZSA9IGZ1bmN0aW9uIChqc29uLCBzZXR0aW5ncykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmplY3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqZWN0TWV0YWRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgT2JqZWN0VHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0eXBlSGludDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtub3duVHlwZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGpzb24gPT09IFwidW5kZWZpbmVkXCIgfHwganNvbiA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5pc1JlcXVpcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgcmVxdWlyZWQgbWVtYmVyLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEhlbHBlcnMuaXNQcmltaXRpdmUoc2V0dGluZ3Mub2JqZWN0VHlwZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoanNvbi5jb25zdHJ1Y3RvciAhPT0gc2V0dGluZ3Mub2JqZWN0VHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXhwZWN0ZWRUeXBlTmFtZSA9IEhlbHBlcnMuZ2V0Q2xhc3NOYW1lKHNldHRpbmdzLm9iamVjdFR5cGUpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmb3VuZFR5cGVOYW1lID0gSGVscGVycy5nZXRDbGFzc05hbWUoanNvbi5jb25zdHJ1Y3RvcikudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkV4cGVjdGVkIHZhbHVlIHRvIGJlIG9mIHR5cGUgJ1wiICsgZXhwZWN0ZWRUeXBlTmFtZSArIFwiJywgZ290ICdcIiArIGZvdW5kVHlwZU5hbWUgKyBcIicuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QgPSBqc29uO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzZXR0aW5ncy5vYmplY3RUeXBlID09PSBBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghSGVscGVycy5pc0FycmF5KGpzb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJFeHBlY3RlZCB2YWx1ZSB0byBiZSBvZiB0eXBlICdBcnJheScsIGdvdCAnXCIgKyBIZWxwZXJzLmdldENsYXNzTmFtZShqc29uLmNvbnN0cnVjdG9yKSArIFwiJy5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb24uZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QucHVzaChfdGhpcy5yZWFkSnNvblRvSW5zdGFuY2UoZWxlbWVudCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudHM6IHNldHRpbmdzLmVsZW1lbnRzID8gc2V0dGluZ3MuZWxlbWVudHMuZWxlbWVudHMgOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlVHlwZUhpbnRzOiBzZXR0aW5ncy5lbmFibGVUeXBlSGludHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrbm93blR5cGVzOiBzZXR0aW5ncy5rbm93blR5cGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0VHlwZTogc2V0dGluZ3MuZWxlbWVudHMgPyBzZXR0aW5ncy5lbGVtZW50cy50eXBlIDogZWxlbWVudC5jb25zdHJ1Y3RvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVUeXBlSGludHM6IHNldHRpbmdzLnJlcXVpcmVUeXBlSGludHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJpY3RUeXBlSGludE1vZGU6IHNldHRpbmdzLnN0cmljdFR5cGVIaW50TW9kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVIaW50UHJvcGVydHlLZXk6IHNldHRpbmdzLnR5cGVIaW50UHJvcGVydHlLZXlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzZXR0aW5ncy5vYmplY3RUeXBlID09PSBEYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBqc29uID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCA9IG5ldyBEYXRlKGpzb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoanNvbiBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0ID0ganNvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRXhwZWN0ZWQgdmFsdWUgdG8gYmUgb2YgdHlwZSAnc3RyaW5nJywgZ290ICdcIiArICh0eXBlb2YganNvbiA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKGpzb24pKSArIFwiJy5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlSGludCA9IGpzb25bc2V0dGluZ3MudHlwZUhpbnRQcm9wZXJ0eUtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVIaW50ICYmIHNldHRpbmdzLmVuYWJsZVR5cGVIaW50cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHR5cGVIaW50ICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiVHlwZS1oaW50IChcIiArIHNldHRpbmdzLnR5cGVIaW50UHJvcGVydHlLZXkgKyBcIikgbXVzdCBiZSBhIHN0cmluZy5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzZXR0aW5ncy5rbm93blR5cGVzW3R5cGVIaW50XSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiJ1wiICsgdHlwZUhpbnQgKyBcIicgaXMgbm90IGEga25vd24gdHlwZS5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLnN0cmljdFR5cGVIaW50TW9kZSAmJiAhSGVscGVycy5pc1N1YnR5cGVPZihzZXR0aW5ncy5rbm93blR5cGVzW3R5cGVIaW50XSwgc2V0dGluZ3Mub2JqZWN0VHlwZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIidcIiArIHR5cGVIaW50ICsgXCInIGlzIG5vdCBhIHN1YnR5cGUgb2YgJ1wiICsgSGVscGVycy5nZXRDbGFzc05hbWUoc2V0dGluZ3Mub2JqZWN0VHlwZSkgKyBcIicuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdFR5cGUgPSBzZXR0aW5ncy5rbm93blR5cGVzW3R5cGVIaW50XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0TWV0YWRhdGEgPSBKc29uT2JqZWN0TWV0YWRhdGEuZ2V0RnJvbVR5cGUoT2JqZWN0VHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLmVuYWJsZVR5cGVIaW50cyAmJiBzZXR0aW5ncy5yZXF1aXJlVHlwZUhpbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJNaXNzaW5nIHJlcXVpcmVkIHR5cGUtaGludC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0VHlwZSA9IHNldHRpbmdzLm9iamVjdFR5cGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdE1ldGFkYXRhID0gSnNvbk9iamVjdE1ldGFkYXRhLmdldEZyb21UeXBlKHNldHRpbmdzLm9iamVjdFR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqZWN0TWV0YWRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvYmplY3RNZXRhZGF0YS5pbml0aWFsaXplciA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QgPSBvYmplY3RNZXRhZGF0YS5pbml0aWFsaXplcihqc29uKSB8fCBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0TWV0YWRhdGEuc29ydE1lbWJlcnMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdCA9IG5ldyBPYmplY3RUeXBlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhvYmplY3RNZXRhZGF0YS5kYXRhTWVtYmVycykuZm9yRWFjaChmdW5jdGlvbiAocHJvcGVydHlLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvcGVydHlNZXRhZGF0YSA9IG9iamVjdE1ldGFkYXRhLmRhdGFNZW1iZXJzW3Byb3BlcnR5S2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wID0gX3RoaXMucmVhZEpzb25Ub0luc3RhbmNlKGpzb25bcHJvcGVydHlNZXRhZGF0YS5uYW1lXSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50czogcHJvcGVydHlNZXRhZGF0YS5lbGVtZW50cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlVHlwZUhpbnRzOiBzZXR0aW5ncy5lbmFibGVUeXBlSGludHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzUmVxdWlyZWQ6IHByb3BlcnR5TWV0YWRhdGEuaXNSZXF1aXJlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga25vd25UeXBlczogSGVscGVycy5tZXJnZShzZXR0aW5ncy5rbm93blR5cGVzLCBvYmplY3RNZXRhZGF0YS5rbm93blR5cGVzIHx8IHt9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0VHlwZTogcHJvcGVydHlNZXRhZGF0YS50eXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlVHlwZUhpbnRzOiBzZXR0aW5ncy5yZXF1aXJlVHlwZUhpbnRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJpY3RUeXBlSGludE1vZGU6IHNldHRpbmdzLnN0cmljdFR5cGVIaW50TW9kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZUhpbnRQcm9wZXJ0eUtleTogc2V0dGluZ3MudHlwZUhpbnRQcm9wZXJ0eUtleVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChIZWxwZXJzLnZhbHVlSXNEZWZpbmVkKHRlbXApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdFtwcm9wZXJ0eUtleV0gPSB0ZW1wO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGpzb24pLmZvckVhY2goZnVuY3Rpb24gKHByb3BlcnR5S2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoanNvbltwcm9wZXJ0eUtleV0gJiYgcHJvcGVydHlLZXkgIT09IHNldHRpbmdzLnR5cGVIaW50UHJvcGVydHlLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RbcHJvcGVydHlLZXldID0gX3RoaXMucmVhZEpzb25Ub0luc3RhbmNlKGpzb25bcHJvcGVydHlLZXldLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZVR5cGVIaW50czogc2V0dGluZ3MuZW5hYmxlVHlwZUhpbnRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrbm93blR5cGVzOiBzZXR0aW5ncy5rbm93blR5cGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RUeXBlOiBqc29uW3Byb3BlcnR5S2V5XS5jb25zdHJ1Y3RvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZVR5cGVIaW50czogc2V0dGluZ3MucmVxdWlyZVR5cGVIaW50cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZUhpbnRQcm9wZXJ0eUtleTogc2V0dGluZ3MudHlwZUhpbnRQcm9wZXJ0eUtleVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqZWN0O1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gRGVzZXJpYWxpemVyO1xuICAgICAgICAgICAgICAgIH0oKTtcbiAgICAgICAgICAgICAgICB2YXIgY29uZmlnU2V0dGluZ3MgPSB7XG4gICAgICAgICAgICAgICAgICAgIGVuYWJsZVR5cGVIaW50czogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdHlwZUhpbnRQcm9wZXJ0eUtleTogXCJfX3R5cGVcIlxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIFR5cGVkSlNPTiA9IHtcbiAgICAgICAgICAgICAgICAgICAgY29uZmlnOiBmdW5jdGlvbiBjb25maWcoc2V0dGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ1NldHRpbmdzID0gSGVscGVycy5tZXJnZShjb25maWdTZXR0aW5ncywgc2V0dGluZ3MpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBzdHJpbmdpZnk6IGZ1bmN0aW9uIHN0cmluZ2lmeSh2YWx1ZSwgc2V0dGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBTZXJpYWxpemVyLndyaXRlT2JqZWN0KHZhbHVlLCBIZWxwZXJzLm1lcmdlKGNvbmZpZ1NldHRpbmdzLCBzZXR0aW5ncyB8fCB7fSkpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBwYXJzZTogZnVuY3Rpb24gcGFyc2UoanNvbiwgdHlwZSwgc2V0dGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChKc29uT2JqZWN0TWV0YWRhdGEuZ2V0RnJvbVR5cGUodHlwZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gRGVzZXJpYWxpemVyLnJlYWRPYmplY3QoanNvbiwgdHlwZSwgSGVscGVycy5tZXJnZShjb25maWdTZXR0aW5ncywgc2V0dGluZ3MgfHwge30pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UuYXBwbHkoSlNPTiwgYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZXhwb3J0cy5UeXBlZEpTT04gPSBUeXBlZEpTT047XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSwge31dIH0sIHt9LCBbN10pKDcpO1xufSk7XG4vKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXygxNikpKVxuXG4vKioqLyB9KVxuXG59LFsxN10pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBwYXJzZXIuZDA3MDQwMWQ3NjNhNTlkMjRhOWQuanMiLCJ2YXIgZztcclxuXHJcbi8vIFRoaXMgd29ya3MgaW4gbm9uLXN0cmljdCBtb2RlXHJcbmcgPSAoZnVuY3Rpb24oKSB7XHJcblx0cmV0dXJuIHRoaXM7XHJcbn0pKCk7XHJcblxyXG50cnkge1xyXG5cdC8vIFRoaXMgd29ya3MgaWYgZXZhbCBpcyBhbGxvd2VkIChzZWUgQ1NQKVxyXG5cdGcgPSBnIHx8IEZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKSB8fCAoMSxldmFsKShcInRoaXNcIik7XHJcbn0gY2F0Y2goZSkge1xyXG5cdC8vIFRoaXMgd29ya3MgaWYgdGhlIHdpbmRvdyByZWZlcmVuY2UgaXMgYXZhaWxhYmxlXHJcblx0aWYodHlwZW9mIHdpbmRvdyA9PT0gXCJvYmplY3RcIilcclxuXHRcdGcgPSB3aW5kb3c7XHJcbn1cclxuXHJcbi8vIGcgY2FuIHN0aWxsIGJlIHVuZGVmaW5lZCwgYnV0IG5vdGhpbmcgdG8gZG8gYWJvdXQgaXQuLi5cclxuLy8gV2UgcmV0dXJuIHVuZGVmaW5lZCwgaW5zdGVhZCBvZiBub3RoaW5nIGhlcmUsIHNvIGl0J3NcclxuLy8gZWFzaWVyIHRvIGhhbmRsZSB0aGlzIGNhc2UuIGlmKCFnbG9iYWwpIHsgLi4ufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBnO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAod2VicGFjaykvYnVpbGRpbi9nbG9iYWwuanNcbi8vIG1vZHVsZSBpZCA9IDE2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCAyIiwiKGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09XCJvYmplY3RcIiYmdHlwZW9mIG1vZHVsZSE9PVwidW5kZWZpbmVkXCIpe21vZHVsZS5leHBvcnRzPWYoKX1lbHNlIGlmKHR5cGVvZiBkZWZpbmU9PT1cImZ1bmN0aW9uXCImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT1cInVuZGVmaW5lZFwiKXtnPXdpbmRvd31lbHNlIGlmKHR5cGVvZiBnbG9iYWwhPT1cInVuZGVmaW5lZFwiKXtnPWdsb2JhbH1lbHNlIGlmKHR5cGVvZiBzZWxmIT09XCJ1bmRlZmluZWRcIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcucGFyc2VyID0gZigpfX0pKGZ1bmN0aW9uKCl7dmFyIGRlZmluZSxtb2R1bGUsZXhwb3J0cztyZXR1cm4gKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkoezE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuKGZ1bmN0aW9uIChnbG9iYWwpe1xuLyohIGh0dHBzOi8vbXRocy5iZS9wdW55Y29kZSB2MS40LjEgYnkgQG1hdGhpYXMgKi9cbjsoZnVuY3Rpb24ocm9vdCkge1xuXG5cdC8qKiBEZXRlY3QgZnJlZSB2YXJpYWJsZXMgKi9cblx0dmFyIGZyZWVFeHBvcnRzID0gdHlwZW9mIGV4cG9ydHMgPT0gJ29iamVjdCcgJiYgZXhwb3J0cyAmJlxuXHRcdCFleHBvcnRzLm5vZGVUeXBlICYmIGV4cG9ydHM7XG5cdHZhciBmcmVlTW9kdWxlID0gdHlwZW9mIG1vZHVsZSA9PSAnb2JqZWN0JyAmJiBtb2R1bGUgJiZcblx0XHQhbW9kdWxlLm5vZGVUeXBlICYmIG1vZHVsZTtcblx0dmFyIGZyZWVHbG9iYWwgPSB0eXBlb2YgZ2xvYmFsID09ICdvYmplY3QnICYmIGdsb2JhbDtcblx0aWYgKFxuXHRcdGZyZWVHbG9iYWwuZ2xvYmFsID09PSBmcmVlR2xvYmFsIHx8XG5cdFx0ZnJlZUdsb2JhbC53aW5kb3cgPT09IGZyZWVHbG9iYWwgfHxcblx0XHRmcmVlR2xvYmFsLnNlbGYgPT09IGZyZWVHbG9iYWxcblx0KSB7XG5cdFx0cm9vdCA9IGZyZWVHbG9iYWw7XG5cdH1cblxuXHQvKipcblx0ICogVGhlIGBwdW55Y29kZWAgb2JqZWN0LlxuXHQgKiBAbmFtZSBwdW55Y29kZVxuXHQgKiBAdHlwZSBPYmplY3Rcblx0ICovXG5cdHZhciBwdW55Y29kZSxcblxuXHQvKiogSGlnaGVzdCBwb3NpdGl2ZSBzaWduZWQgMzItYml0IGZsb2F0IHZhbHVlICovXG5cdG1heEludCA9IDIxNDc0ODM2NDcsIC8vIGFrYS4gMHg3RkZGRkZGRiBvciAyXjMxLTFcblxuXHQvKiogQm9vdHN0cmluZyBwYXJhbWV0ZXJzICovXG5cdGJhc2UgPSAzNixcblx0dE1pbiA9IDEsXG5cdHRNYXggPSAyNixcblx0c2tldyA9IDM4LFxuXHRkYW1wID0gNzAwLFxuXHRpbml0aWFsQmlhcyA9IDcyLFxuXHRpbml0aWFsTiA9IDEyOCwgLy8gMHg4MFxuXHRkZWxpbWl0ZXIgPSAnLScsIC8vICdcXHgyRCdcblxuXHQvKiogUmVndWxhciBleHByZXNzaW9ucyAqL1xuXHRyZWdleFB1bnljb2RlID0gL154bi0tLyxcblx0cmVnZXhOb25BU0NJSSA9IC9bXlxceDIwLVxceDdFXS8sIC8vIHVucHJpbnRhYmxlIEFTQ0lJIGNoYXJzICsgbm9uLUFTQ0lJIGNoYXJzXG5cdHJlZ2V4U2VwYXJhdG9ycyA9IC9bXFx4MkVcXHUzMDAyXFx1RkYwRVxcdUZGNjFdL2csIC8vIFJGQyAzNDkwIHNlcGFyYXRvcnNcblxuXHQvKiogRXJyb3IgbWVzc2FnZXMgKi9cblx0ZXJyb3JzID0ge1xuXHRcdCdvdmVyZmxvdyc6ICdPdmVyZmxvdzogaW5wdXQgbmVlZHMgd2lkZXIgaW50ZWdlcnMgdG8gcHJvY2VzcycsXG5cdFx0J25vdC1iYXNpYyc6ICdJbGxlZ2FsIGlucHV0ID49IDB4ODAgKG5vdCBhIGJhc2ljIGNvZGUgcG9pbnQpJyxcblx0XHQnaW52YWxpZC1pbnB1dCc6ICdJbnZhbGlkIGlucHV0J1xuXHR9LFxuXG5cdC8qKiBDb252ZW5pZW5jZSBzaG9ydGN1dHMgKi9cblx0YmFzZU1pbnVzVE1pbiA9IGJhc2UgLSB0TWluLFxuXHRmbG9vciA9IE1hdGguZmxvb3IsXG5cdHN0cmluZ0Zyb21DaGFyQ29kZSA9IFN0cmluZy5mcm9tQ2hhckNvZGUsXG5cblx0LyoqIFRlbXBvcmFyeSB2YXJpYWJsZSAqL1xuXHRrZXk7XG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0LyoqXG5cdCAqIEEgZ2VuZXJpYyBlcnJvciB1dGlsaXR5IGZ1bmN0aW9uLlxuXHQgKiBAcHJpdmF0ZVxuXHQgKiBAcGFyYW0ge1N0cmluZ30gdHlwZSBUaGUgZXJyb3IgdHlwZS5cblx0ICogQHJldHVybnMge0Vycm9yfSBUaHJvd3MgYSBgUmFuZ2VFcnJvcmAgd2l0aCB0aGUgYXBwbGljYWJsZSBlcnJvciBtZXNzYWdlLlxuXHQgKi9cblx0ZnVuY3Rpb24gZXJyb3IodHlwZSkge1xuXHRcdHRocm93IG5ldyBSYW5nZUVycm9yKGVycm9yc1t0eXBlXSk7XG5cdH1cblxuXHQvKipcblx0ICogQSBnZW5lcmljIGBBcnJheSNtYXBgIHV0aWxpdHkgZnVuY3Rpb24uXG5cdCAqIEBwcml2YXRlXG5cdCAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBpdGVyYXRlIG92ZXIuXG5cdCAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIFRoZSBmdW5jdGlvbiB0aGF0IGdldHMgY2FsbGVkIGZvciBldmVyeSBhcnJheVxuXHQgKiBpdGVtLlxuXHQgKiBAcmV0dXJucyB7QXJyYXl9IEEgbmV3IGFycmF5IG9mIHZhbHVlcyByZXR1cm5lZCBieSB0aGUgY2FsbGJhY2sgZnVuY3Rpb24uXG5cdCAqL1xuXHRmdW5jdGlvbiBtYXAoYXJyYXksIGZuKSB7XG5cdFx0dmFyIGxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcblx0XHR2YXIgcmVzdWx0ID0gW107XG5cdFx0d2hpbGUgKGxlbmd0aC0tKSB7XG5cdFx0XHRyZXN1bHRbbGVuZ3RoXSA9IGZuKGFycmF5W2xlbmd0aF0pO1xuXHRcdH1cblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9XG5cblx0LyoqXG5cdCAqIEEgc2ltcGxlIGBBcnJheSNtYXBgLWxpa2Ugd3JhcHBlciB0byB3b3JrIHdpdGggZG9tYWluIG5hbWUgc3RyaW5ncyBvciBlbWFpbFxuXHQgKiBhZGRyZXNzZXMuXG5cdCAqIEBwcml2YXRlXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBkb21haW4gVGhlIGRvbWFpbiBuYW1lIG9yIGVtYWlsIGFkZHJlc3MuXG5cdCAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIFRoZSBmdW5jdGlvbiB0aGF0IGdldHMgY2FsbGVkIGZvciBldmVyeVxuXHQgKiBjaGFyYWN0ZXIuXG5cdCAqIEByZXR1cm5zIHtBcnJheX0gQSBuZXcgc3RyaW5nIG9mIGNoYXJhY3RlcnMgcmV0dXJuZWQgYnkgdGhlIGNhbGxiYWNrXG5cdCAqIGZ1bmN0aW9uLlxuXHQgKi9cblx0ZnVuY3Rpb24gbWFwRG9tYWluKHN0cmluZywgZm4pIHtcblx0XHR2YXIgcGFydHMgPSBzdHJpbmcuc3BsaXQoJ0AnKTtcblx0XHR2YXIgcmVzdWx0ID0gJyc7XG5cdFx0aWYgKHBhcnRzLmxlbmd0aCA+IDEpIHtcblx0XHRcdC8vIEluIGVtYWlsIGFkZHJlc3Nlcywgb25seSB0aGUgZG9tYWluIG5hbWUgc2hvdWxkIGJlIHB1bnljb2RlZC4gTGVhdmVcblx0XHRcdC8vIHRoZSBsb2NhbCBwYXJ0IChpLmUuIGV2ZXJ5dGhpbmcgdXAgdG8gYEBgKSBpbnRhY3QuXG5cdFx0XHRyZXN1bHQgPSBwYXJ0c1swXSArICdAJztcblx0XHRcdHN0cmluZyA9IHBhcnRzWzFdO1xuXHRcdH1cblx0XHQvLyBBdm9pZCBgc3BsaXQocmVnZXgpYCBmb3IgSUU4IGNvbXBhdGliaWxpdHkuIFNlZSAjMTcuXG5cdFx0c3RyaW5nID0gc3RyaW5nLnJlcGxhY2UocmVnZXhTZXBhcmF0b3JzLCAnXFx4MkUnKTtcblx0XHR2YXIgbGFiZWxzID0gc3RyaW5nLnNwbGl0KCcuJyk7XG5cdFx0dmFyIGVuY29kZWQgPSBtYXAobGFiZWxzLCBmbikuam9pbignLicpO1xuXHRcdHJldHVybiByZXN1bHQgKyBlbmNvZGVkO1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZXMgYW4gYXJyYXkgY29udGFpbmluZyB0aGUgbnVtZXJpYyBjb2RlIHBvaW50cyBvZiBlYWNoIFVuaWNvZGVcblx0ICogY2hhcmFjdGVyIGluIHRoZSBzdHJpbmcuIFdoaWxlIEphdmFTY3JpcHQgdXNlcyBVQ1MtMiBpbnRlcm5hbGx5LFxuXHQgKiB0aGlzIGZ1bmN0aW9uIHdpbGwgY29udmVydCBhIHBhaXIgb2Ygc3Vycm9nYXRlIGhhbHZlcyAoZWFjaCBvZiB3aGljaFxuXHQgKiBVQ1MtMiBleHBvc2VzIGFzIHNlcGFyYXRlIGNoYXJhY3RlcnMpIGludG8gYSBzaW5nbGUgY29kZSBwb2ludCxcblx0ICogbWF0Y2hpbmcgVVRGLTE2LlxuXHQgKiBAc2VlIGBwdW55Y29kZS51Y3MyLmVuY29kZWBcblx0ICogQHNlZSA8aHR0cHM6Ly9tYXRoaWFzYnluZW5zLmJlL25vdGVzL2phdmFzY3JpcHQtZW5jb2Rpbmc+XG5cdCAqIEBtZW1iZXJPZiBwdW55Y29kZS51Y3MyXG5cdCAqIEBuYW1lIGRlY29kZVxuXHQgKiBAcGFyYW0ge1N0cmluZ30gc3RyaW5nIFRoZSBVbmljb2RlIGlucHV0IHN0cmluZyAoVUNTLTIpLlxuXHQgKiBAcmV0dXJucyB7QXJyYXl9IFRoZSBuZXcgYXJyYXkgb2YgY29kZSBwb2ludHMuXG5cdCAqL1xuXHRmdW5jdGlvbiB1Y3MyZGVjb2RlKHN0cmluZykge1xuXHRcdHZhciBvdXRwdXQgPSBbXSxcblx0XHQgICAgY291bnRlciA9IDAsXG5cdFx0ICAgIGxlbmd0aCA9IHN0cmluZy5sZW5ndGgsXG5cdFx0ICAgIHZhbHVlLFxuXHRcdCAgICBleHRyYTtcblx0XHR3aGlsZSAoY291bnRlciA8IGxlbmd0aCkge1xuXHRcdFx0dmFsdWUgPSBzdHJpbmcuY2hhckNvZGVBdChjb3VudGVyKyspO1xuXHRcdFx0aWYgKHZhbHVlID49IDB4RDgwMCAmJiB2YWx1ZSA8PSAweERCRkYgJiYgY291bnRlciA8IGxlbmd0aCkge1xuXHRcdFx0XHQvLyBoaWdoIHN1cnJvZ2F0ZSwgYW5kIHRoZXJlIGlzIGEgbmV4dCBjaGFyYWN0ZXJcblx0XHRcdFx0ZXh0cmEgPSBzdHJpbmcuY2hhckNvZGVBdChjb3VudGVyKyspO1xuXHRcdFx0XHRpZiAoKGV4dHJhICYgMHhGQzAwKSA9PSAweERDMDApIHsgLy8gbG93IHN1cnJvZ2F0ZVxuXHRcdFx0XHRcdG91dHB1dC5wdXNoKCgodmFsdWUgJiAweDNGRikgPDwgMTApICsgKGV4dHJhICYgMHgzRkYpICsgMHgxMDAwMCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gdW5tYXRjaGVkIHN1cnJvZ2F0ZTsgb25seSBhcHBlbmQgdGhpcyBjb2RlIHVuaXQsIGluIGNhc2UgdGhlIG5leHRcblx0XHRcdFx0XHQvLyBjb2RlIHVuaXQgaXMgdGhlIGhpZ2ggc3Vycm9nYXRlIG9mIGEgc3Vycm9nYXRlIHBhaXJcblx0XHRcdFx0XHRvdXRwdXQucHVzaCh2YWx1ZSk7XG5cdFx0XHRcdFx0Y291bnRlci0tO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRvdXRwdXQucHVzaCh2YWx1ZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBvdXRwdXQ7XG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlcyBhIHN0cmluZyBiYXNlZCBvbiBhbiBhcnJheSBvZiBudW1lcmljIGNvZGUgcG9pbnRzLlxuXHQgKiBAc2VlIGBwdW55Y29kZS51Y3MyLmRlY29kZWBcblx0ICogQG1lbWJlck9mIHB1bnljb2RlLnVjczJcblx0ICogQG5hbWUgZW5jb2RlXG5cdCAqIEBwYXJhbSB7QXJyYXl9IGNvZGVQb2ludHMgVGhlIGFycmF5IG9mIG51bWVyaWMgY29kZSBwb2ludHMuXG5cdCAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBuZXcgVW5pY29kZSBzdHJpbmcgKFVDUy0yKS5cblx0ICovXG5cdGZ1bmN0aW9uIHVjczJlbmNvZGUoYXJyYXkpIHtcblx0XHRyZXR1cm4gbWFwKGFycmF5LCBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0dmFyIG91dHB1dCA9ICcnO1xuXHRcdFx0aWYgKHZhbHVlID4gMHhGRkZGKSB7XG5cdFx0XHRcdHZhbHVlIC09IDB4MTAwMDA7XG5cdFx0XHRcdG91dHB1dCArPSBzdHJpbmdGcm9tQ2hhckNvZGUodmFsdWUgPj4+IDEwICYgMHgzRkYgfCAweEQ4MDApO1xuXHRcdFx0XHR2YWx1ZSA9IDB4REMwMCB8IHZhbHVlICYgMHgzRkY7XG5cdFx0XHR9XG5cdFx0XHRvdXRwdXQgKz0gc3RyaW5nRnJvbUNoYXJDb2RlKHZhbHVlKTtcblx0XHRcdHJldHVybiBvdXRwdXQ7XG5cdFx0fSkuam9pbignJyk7XG5cdH1cblxuXHQvKipcblx0ICogQ29udmVydHMgYSBiYXNpYyBjb2RlIHBvaW50IGludG8gYSBkaWdpdC9pbnRlZ2VyLlxuXHQgKiBAc2VlIGBkaWdpdFRvQmFzaWMoKWBcblx0ICogQHByaXZhdGVcblx0ICogQHBhcmFtIHtOdW1iZXJ9IGNvZGVQb2ludCBUaGUgYmFzaWMgbnVtZXJpYyBjb2RlIHBvaW50IHZhbHVlLlxuXHQgKiBAcmV0dXJucyB7TnVtYmVyfSBUaGUgbnVtZXJpYyB2YWx1ZSBvZiBhIGJhc2ljIGNvZGUgcG9pbnQgKGZvciB1c2UgaW5cblx0ICogcmVwcmVzZW50aW5nIGludGVnZXJzKSBpbiB0aGUgcmFuZ2UgYDBgIHRvIGBiYXNlIC0gMWAsIG9yIGBiYXNlYCBpZlxuXHQgKiB0aGUgY29kZSBwb2ludCBkb2VzIG5vdCByZXByZXNlbnQgYSB2YWx1ZS5cblx0ICovXG5cdGZ1bmN0aW9uIGJhc2ljVG9EaWdpdChjb2RlUG9pbnQpIHtcblx0XHRpZiAoY29kZVBvaW50IC0gNDggPCAxMCkge1xuXHRcdFx0cmV0dXJuIGNvZGVQb2ludCAtIDIyO1xuXHRcdH1cblx0XHRpZiAoY29kZVBvaW50IC0gNjUgPCAyNikge1xuXHRcdFx0cmV0dXJuIGNvZGVQb2ludCAtIDY1O1xuXHRcdH1cblx0XHRpZiAoY29kZVBvaW50IC0gOTcgPCAyNikge1xuXHRcdFx0cmV0dXJuIGNvZGVQb2ludCAtIDk3O1xuXHRcdH1cblx0XHRyZXR1cm4gYmFzZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDb252ZXJ0cyBhIGRpZ2l0L2ludGVnZXIgaW50byBhIGJhc2ljIGNvZGUgcG9pbnQuXG5cdCAqIEBzZWUgYGJhc2ljVG9EaWdpdCgpYFxuXHQgKiBAcHJpdmF0ZVxuXHQgKiBAcGFyYW0ge051bWJlcn0gZGlnaXQgVGhlIG51bWVyaWMgdmFsdWUgb2YgYSBiYXNpYyBjb2RlIHBvaW50LlxuXHQgKiBAcmV0dXJucyB7TnVtYmVyfSBUaGUgYmFzaWMgY29kZSBwb2ludCB3aG9zZSB2YWx1ZSAod2hlbiB1c2VkIGZvclxuXHQgKiByZXByZXNlbnRpbmcgaW50ZWdlcnMpIGlzIGBkaWdpdGAsIHdoaWNoIG5lZWRzIHRvIGJlIGluIHRoZSByYW5nZVxuXHQgKiBgMGAgdG8gYGJhc2UgLSAxYC4gSWYgYGZsYWdgIGlzIG5vbi16ZXJvLCB0aGUgdXBwZXJjYXNlIGZvcm0gaXNcblx0ICogdXNlZDsgZWxzZSwgdGhlIGxvd2VyY2FzZSBmb3JtIGlzIHVzZWQuIFRoZSBiZWhhdmlvciBpcyB1bmRlZmluZWRcblx0ICogaWYgYGZsYWdgIGlzIG5vbi16ZXJvIGFuZCBgZGlnaXRgIGhhcyBubyB1cHBlcmNhc2UgZm9ybS5cblx0ICovXG5cdGZ1bmN0aW9uIGRpZ2l0VG9CYXNpYyhkaWdpdCwgZmxhZykge1xuXHRcdC8vICAwLi4yNSBtYXAgdG8gQVNDSUkgYS4ueiBvciBBLi5aXG5cdFx0Ly8gMjYuLjM1IG1hcCB0byBBU0NJSSAwLi45XG5cdFx0cmV0dXJuIGRpZ2l0ICsgMjIgKyA3NSAqIChkaWdpdCA8IDI2KSAtICgoZmxhZyAhPSAwKSA8PCA1KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBCaWFzIGFkYXB0YXRpb24gZnVuY3Rpb24gYXMgcGVyIHNlY3Rpb24gMy40IG9mIFJGQyAzNDkyLlxuXHQgKiBodHRwczovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjMzQ5MiNzZWN0aW9uLTMuNFxuXHQgKiBAcHJpdmF0ZVxuXHQgKi9cblx0ZnVuY3Rpb24gYWRhcHQoZGVsdGEsIG51bVBvaW50cywgZmlyc3RUaW1lKSB7XG5cdFx0dmFyIGsgPSAwO1xuXHRcdGRlbHRhID0gZmlyc3RUaW1lID8gZmxvb3IoZGVsdGEgLyBkYW1wKSA6IGRlbHRhID4+IDE7XG5cdFx0ZGVsdGEgKz0gZmxvb3IoZGVsdGEgLyBudW1Qb2ludHMpO1xuXHRcdGZvciAoLyogbm8gaW5pdGlhbGl6YXRpb24gKi87IGRlbHRhID4gYmFzZU1pbnVzVE1pbiAqIHRNYXggPj4gMTsgayArPSBiYXNlKSB7XG5cdFx0XHRkZWx0YSA9IGZsb29yKGRlbHRhIC8gYmFzZU1pbnVzVE1pbik7XG5cdFx0fVxuXHRcdHJldHVybiBmbG9vcihrICsgKGJhc2VNaW51c1RNaW4gKyAxKSAqIGRlbHRhIC8gKGRlbHRhICsgc2tldykpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENvbnZlcnRzIGEgUHVueWNvZGUgc3RyaW5nIG9mIEFTQ0lJLW9ubHkgc3ltYm9scyB0byBhIHN0cmluZyBvZiBVbmljb2RlXG5cdCAqIHN5bWJvbHMuXG5cdCAqIEBtZW1iZXJPZiBwdW55Y29kZVxuXHQgKiBAcGFyYW0ge1N0cmluZ30gaW5wdXQgVGhlIFB1bnljb2RlIHN0cmluZyBvZiBBU0NJSS1vbmx5IHN5bWJvbHMuXG5cdCAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSByZXN1bHRpbmcgc3RyaW5nIG9mIFVuaWNvZGUgc3ltYm9scy5cblx0ICovXG5cdGZ1bmN0aW9uIGRlY29kZShpbnB1dCkge1xuXHRcdC8vIERvbid0IHVzZSBVQ1MtMlxuXHRcdHZhciBvdXRwdXQgPSBbXSxcblx0XHQgICAgaW5wdXRMZW5ndGggPSBpbnB1dC5sZW5ndGgsXG5cdFx0ICAgIG91dCxcblx0XHQgICAgaSA9IDAsXG5cdFx0ICAgIG4gPSBpbml0aWFsTixcblx0XHQgICAgYmlhcyA9IGluaXRpYWxCaWFzLFxuXHRcdCAgICBiYXNpYyxcblx0XHQgICAgaixcblx0XHQgICAgaW5kZXgsXG5cdFx0ICAgIG9sZGksXG5cdFx0ICAgIHcsXG5cdFx0ICAgIGssXG5cdFx0ICAgIGRpZ2l0LFxuXHRcdCAgICB0LFxuXHRcdCAgICAvKiogQ2FjaGVkIGNhbGN1bGF0aW9uIHJlc3VsdHMgKi9cblx0XHQgICAgYmFzZU1pbnVzVDtcblxuXHRcdC8vIEhhbmRsZSB0aGUgYmFzaWMgY29kZSBwb2ludHM6IGxldCBgYmFzaWNgIGJlIHRoZSBudW1iZXIgb2YgaW5wdXQgY29kZVxuXHRcdC8vIHBvaW50cyBiZWZvcmUgdGhlIGxhc3QgZGVsaW1pdGVyLCBvciBgMGAgaWYgdGhlcmUgaXMgbm9uZSwgdGhlbiBjb3B5XG5cdFx0Ly8gdGhlIGZpcnN0IGJhc2ljIGNvZGUgcG9pbnRzIHRvIHRoZSBvdXRwdXQuXG5cblx0XHRiYXNpYyA9IGlucHV0Lmxhc3RJbmRleE9mKGRlbGltaXRlcik7XG5cdFx0aWYgKGJhc2ljIDwgMCkge1xuXHRcdFx0YmFzaWMgPSAwO1xuXHRcdH1cblxuXHRcdGZvciAoaiA9IDA7IGogPCBiYXNpYzsgKytqKSB7XG5cdFx0XHQvLyBpZiBpdCdzIG5vdCBhIGJhc2ljIGNvZGUgcG9pbnRcblx0XHRcdGlmIChpbnB1dC5jaGFyQ29kZUF0KGopID49IDB4ODApIHtcblx0XHRcdFx0ZXJyb3IoJ25vdC1iYXNpYycpO1xuXHRcdFx0fVxuXHRcdFx0b3V0cHV0LnB1c2goaW5wdXQuY2hhckNvZGVBdChqKSk7XG5cdFx0fVxuXG5cdFx0Ly8gTWFpbiBkZWNvZGluZyBsb29wOiBzdGFydCBqdXN0IGFmdGVyIHRoZSBsYXN0IGRlbGltaXRlciBpZiBhbnkgYmFzaWMgY29kZVxuXHRcdC8vIHBvaW50cyB3ZXJlIGNvcGllZDsgc3RhcnQgYXQgdGhlIGJlZ2lubmluZyBvdGhlcndpc2UuXG5cblx0XHRmb3IgKGluZGV4ID0gYmFzaWMgPiAwID8gYmFzaWMgKyAxIDogMDsgaW5kZXggPCBpbnB1dExlbmd0aDsgLyogbm8gZmluYWwgZXhwcmVzc2lvbiAqLykge1xuXG5cdFx0XHQvLyBgaW5kZXhgIGlzIHRoZSBpbmRleCBvZiB0aGUgbmV4dCBjaGFyYWN0ZXIgdG8gYmUgY29uc3VtZWQuXG5cdFx0XHQvLyBEZWNvZGUgYSBnZW5lcmFsaXplZCB2YXJpYWJsZS1sZW5ndGggaW50ZWdlciBpbnRvIGBkZWx0YWAsXG5cdFx0XHQvLyB3aGljaCBnZXRzIGFkZGVkIHRvIGBpYC4gVGhlIG92ZXJmbG93IGNoZWNraW5nIGlzIGVhc2llclxuXHRcdFx0Ly8gaWYgd2UgaW5jcmVhc2UgYGlgIGFzIHdlIGdvLCB0aGVuIHN1YnRyYWN0IG9mZiBpdHMgc3RhcnRpbmdcblx0XHRcdC8vIHZhbHVlIGF0IHRoZSBlbmQgdG8gb2J0YWluIGBkZWx0YWAuXG5cdFx0XHRmb3IgKG9sZGkgPSBpLCB3ID0gMSwgayA9IGJhc2U7IC8qIG5vIGNvbmRpdGlvbiAqLzsgayArPSBiYXNlKSB7XG5cblx0XHRcdFx0aWYgKGluZGV4ID49IGlucHV0TGVuZ3RoKSB7XG5cdFx0XHRcdFx0ZXJyb3IoJ2ludmFsaWQtaW5wdXQnKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGRpZ2l0ID0gYmFzaWNUb0RpZ2l0KGlucHV0LmNoYXJDb2RlQXQoaW5kZXgrKykpO1xuXG5cdFx0XHRcdGlmIChkaWdpdCA+PSBiYXNlIHx8IGRpZ2l0ID4gZmxvb3IoKG1heEludCAtIGkpIC8gdykpIHtcblx0XHRcdFx0XHRlcnJvcignb3ZlcmZsb3cnKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGkgKz0gZGlnaXQgKiB3O1xuXHRcdFx0XHR0ID0gayA8PSBiaWFzID8gdE1pbiA6IChrID49IGJpYXMgKyB0TWF4ID8gdE1heCA6IGsgLSBiaWFzKTtcblxuXHRcdFx0XHRpZiAoZGlnaXQgPCB0KSB7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRiYXNlTWludXNUID0gYmFzZSAtIHQ7XG5cdFx0XHRcdGlmICh3ID4gZmxvb3IobWF4SW50IC8gYmFzZU1pbnVzVCkpIHtcblx0XHRcdFx0XHRlcnJvcignb3ZlcmZsb3cnKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHcgKj0gYmFzZU1pbnVzVDtcblxuXHRcdFx0fVxuXG5cdFx0XHRvdXQgPSBvdXRwdXQubGVuZ3RoICsgMTtcblx0XHRcdGJpYXMgPSBhZGFwdChpIC0gb2xkaSwgb3V0LCBvbGRpID09IDApO1xuXG5cdFx0XHQvLyBgaWAgd2FzIHN1cHBvc2VkIHRvIHdyYXAgYXJvdW5kIGZyb20gYG91dGAgdG8gYDBgLFxuXHRcdFx0Ly8gaW5jcmVtZW50aW5nIGBuYCBlYWNoIHRpbWUsIHNvIHdlJ2xsIGZpeCB0aGF0IG5vdzpcblx0XHRcdGlmIChmbG9vcihpIC8gb3V0KSA+IG1heEludCAtIG4pIHtcblx0XHRcdFx0ZXJyb3IoJ292ZXJmbG93Jyk7XG5cdFx0XHR9XG5cblx0XHRcdG4gKz0gZmxvb3IoaSAvIG91dCk7XG5cdFx0XHRpICU9IG91dDtcblxuXHRcdFx0Ly8gSW5zZXJ0IGBuYCBhdCBwb3NpdGlvbiBgaWAgb2YgdGhlIG91dHB1dFxuXHRcdFx0b3V0cHV0LnNwbGljZShpKyssIDAsIG4pO1xuXG5cdFx0fVxuXG5cdFx0cmV0dXJuIHVjczJlbmNvZGUob3V0cHV0KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDb252ZXJ0cyBhIHN0cmluZyBvZiBVbmljb2RlIHN5bWJvbHMgKGUuZy4gYSBkb21haW4gbmFtZSBsYWJlbCkgdG8gYVxuXHQgKiBQdW55Y29kZSBzdHJpbmcgb2YgQVNDSUktb25seSBzeW1ib2xzLlxuXHQgKiBAbWVtYmVyT2YgcHVueWNvZGVcblx0ICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IFRoZSBzdHJpbmcgb2YgVW5pY29kZSBzeW1ib2xzLlxuXHQgKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgcmVzdWx0aW5nIFB1bnljb2RlIHN0cmluZyBvZiBBU0NJSS1vbmx5IHN5bWJvbHMuXG5cdCAqL1xuXHRmdW5jdGlvbiBlbmNvZGUoaW5wdXQpIHtcblx0XHR2YXIgbixcblx0XHQgICAgZGVsdGEsXG5cdFx0ICAgIGhhbmRsZWRDUENvdW50LFxuXHRcdCAgICBiYXNpY0xlbmd0aCxcblx0XHQgICAgYmlhcyxcblx0XHQgICAgaixcblx0XHQgICAgbSxcblx0XHQgICAgcSxcblx0XHQgICAgayxcblx0XHQgICAgdCxcblx0XHQgICAgY3VycmVudFZhbHVlLFxuXHRcdCAgICBvdXRwdXQgPSBbXSxcblx0XHQgICAgLyoqIGBpbnB1dExlbmd0aGAgd2lsbCBob2xkIHRoZSBudW1iZXIgb2YgY29kZSBwb2ludHMgaW4gYGlucHV0YC4gKi9cblx0XHQgICAgaW5wdXRMZW5ndGgsXG5cdFx0ICAgIC8qKiBDYWNoZWQgY2FsY3VsYXRpb24gcmVzdWx0cyAqL1xuXHRcdCAgICBoYW5kbGVkQ1BDb3VudFBsdXNPbmUsXG5cdFx0ICAgIGJhc2VNaW51c1QsXG5cdFx0ICAgIHFNaW51c1Q7XG5cblx0XHQvLyBDb252ZXJ0IHRoZSBpbnB1dCBpbiBVQ1MtMiB0byBVbmljb2RlXG5cdFx0aW5wdXQgPSB1Y3MyZGVjb2RlKGlucHV0KTtcblxuXHRcdC8vIENhY2hlIHRoZSBsZW5ndGhcblx0XHRpbnB1dExlbmd0aCA9IGlucHV0Lmxlbmd0aDtcblxuXHRcdC8vIEluaXRpYWxpemUgdGhlIHN0YXRlXG5cdFx0biA9IGluaXRpYWxOO1xuXHRcdGRlbHRhID0gMDtcblx0XHRiaWFzID0gaW5pdGlhbEJpYXM7XG5cblx0XHQvLyBIYW5kbGUgdGhlIGJhc2ljIGNvZGUgcG9pbnRzXG5cdFx0Zm9yIChqID0gMDsgaiA8IGlucHV0TGVuZ3RoOyArK2opIHtcblx0XHRcdGN1cnJlbnRWYWx1ZSA9IGlucHV0W2pdO1xuXHRcdFx0aWYgKGN1cnJlbnRWYWx1ZSA8IDB4ODApIHtcblx0XHRcdFx0b3V0cHV0LnB1c2goc3RyaW5nRnJvbUNoYXJDb2RlKGN1cnJlbnRWYWx1ZSkpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGhhbmRsZWRDUENvdW50ID0gYmFzaWNMZW5ndGggPSBvdXRwdXQubGVuZ3RoO1xuXG5cdFx0Ly8gYGhhbmRsZWRDUENvdW50YCBpcyB0aGUgbnVtYmVyIG9mIGNvZGUgcG9pbnRzIHRoYXQgaGF2ZSBiZWVuIGhhbmRsZWQ7XG5cdFx0Ly8gYGJhc2ljTGVuZ3RoYCBpcyB0aGUgbnVtYmVyIG9mIGJhc2ljIGNvZGUgcG9pbnRzLlxuXG5cdFx0Ly8gRmluaXNoIHRoZSBiYXNpYyBzdHJpbmcgLSBpZiBpdCBpcyBub3QgZW1wdHkgLSB3aXRoIGEgZGVsaW1pdGVyXG5cdFx0aWYgKGJhc2ljTGVuZ3RoKSB7XG5cdFx0XHRvdXRwdXQucHVzaChkZWxpbWl0ZXIpO1xuXHRcdH1cblxuXHRcdC8vIE1haW4gZW5jb2RpbmcgbG9vcDpcblx0XHR3aGlsZSAoaGFuZGxlZENQQ291bnQgPCBpbnB1dExlbmd0aCkge1xuXG5cdFx0XHQvLyBBbGwgbm9uLWJhc2ljIGNvZGUgcG9pbnRzIDwgbiBoYXZlIGJlZW4gaGFuZGxlZCBhbHJlYWR5LiBGaW5kIHRoZSBuZXh0XG5cdFx0XHQvLyBsYXJnZXIgb25lOlxuXHRcdFx0Zm9yIChtID0gbWF4SW50LCBqID0gMDsgaiA8IGlucHV0TGVuZ3RoOyArK2opIHtcblx0XHRcdFx0Y3VycmVudFZhbHVlID0gaW5wdXRbal07XG5cdFx0XHRcdGlmIChjdXJyZW50VmFsdWUgPj0gbiAmJiBjdXJyZW50VmFsdWUgPCBtKSB7XG5cdFx0XHRcdFx0bSA9IGN1cnJlbnRWYWx1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBJbmNyZWFzZSBgZGVsdGFgIGVub3VnaCB0byBhZHZhbmNlIHRoZSBkZWNvZGVyJ3MgPG4saT4gc3RhdGUgdG8gPG0sMD4sXG5cdFx0XHQvLyBidXQgZ3VhcmQgYWdhaW5zdCBvdmVyZmxvd1xuXHRcdFx0aGFuZGxlZENQQ291bnRQbHVzT25lID0gaGFuZGxlZENQQ291bnQgKyAxO1xuXHRcdFx0aWYgKG0gLSBuID4gZmxvb3IoKG1heEludCAtIGRlbHRhKSAvIGhhbmRsZWRDUENvdW50UGx1c09uZSkpIHtcblx0XHRcdFx0ZXJyb3IoJ292ZXJmbG93Jyk7XG5cdFx0XHR9XG5cblx0XHRcdGRlbHRhICs9IChtIC0gbikgKiBoYW5kbGVkQ1BDb3VudFBsdXNPbmU7XG5cdFx0XHRuID0gbTtcblxuXHRcdFx0Zm9yIChqID0gMDsgaiA8IGlucHV0TGVuZ3RoOyArK2opIHtcblx0XHRcdFx0Y3VycmVudFZhbHVlID0gaW5wdXRbal07XG5cblx0XHRcdFx0aWYgKGN1cnJlbnRWYWx1ZSA8IG4gJiYgKytkZWx0YSA+IG1heEludCkge1xuXHRcdFx0XHRcdGVycm9yKCdvdmVyZmxvdycpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGN1cnJlbnRWYWx1ZSA9PSBuKSB7XG5cdFx0XHRcdFx0Ly8gUmVwcmVzZW50IGRlbHRhIGFzIGEgZ2VuZXJhbGl6ZWQgdmFyaWFibGUtbGVuZ3RoIGludGVnZXJcblx0XHRcdFx0XHRmb3IgKHEgPSBkZWx0YSwgayA9IGJhc2U7IC8qIG5vIGNvbmRpdGlvbiAqLzsgayArPSBiYXNlKSB7XG5cdFx0XHRcdFx0XHR0ID0gayA8PSBiaWFzID8gdE1pbiA6IChrID49IGJpYXMgKyB0TWF4ID8gdE1heCA6IGsgLSBiaWFzKTtcblx0XHRcdFx0XHRcdGlmIChxIDwgdCkge1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHFNaW51c1QgPSBxIC0gdDtcblx0XHRcdFx0XHRcdGJhc2VNaW51c1QgPSBiYXNlIC0gdDtcblx0XHRcdFx0XHRcdG91dHB1dC5wdXNoKFxuXHRcdFx0XHRcdFx0XHRzdHJpbmdGcm9tQ2hhckNvZGUoZGlnaXRUb0Jhc2ljKHQgKyBxTWludXNUICUgYmFzZU1pbnVzVCwgMCkpXG5cdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdFx0cSA9IGZsb29yKHFNaW51c1QgLyBiYXNlTWludXNUKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRvdXRwdXQucHVzaChzdHJpbmdGcm9tQ2hhckNvZGUoZGlnaXRUb0Jhc2ljKHEsIDApKSk7XG5cdFx0XHRcdFx0YmlhcyA9IGFkYXB0KGRlbHRhLCBoYW5kbGVkQ1BDb3VudFBsdXNPbmUsIGhhbmRsZWRDUENvdW50ID09IGJhc2ljTGVuZ3RoKTtcblx0XHRcdFx0XHRkZWx0YSA9IDA7XG5cdFx0XHRcdFx0KytoYW5kbGVkQ1BDb3VudDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQrK2RlbHRhO1xuXHRcdFx0KytuO1xuXG5cdFx0fVxuXHRcdHJldHVybiBvdXRwdXQuam9pbignJyk7XG5cdH1cblxuXHQvKipcblx0ICogQ29udmVydHMgYSBQdW55Y29kZSBzdHJpbmcgcmVwcmVzZW50aW5nIGEgZG9tYWluIG5hbWUgb3IgYW4gZW1haWwgYWRkcmVzc1xuXHQgKiB0byBVbmljb2RlLiBPbmx5IHRoZSBQdW55Y29kZWQgcGFydHMgb2YgdGhlIGlucHV0IHdpbGwgYmUgY29udmVydGVkLCBpLmUuXG5cdCAqIGl0IGRvZXNuJ3QgbWF0dGVyIGlmIHlvdSBjYWxsIGl0IG9uIGEgc3RyaW5nIHRoYXQgaGFzIGFscmVhZHkgYmVlblxuXHQgKiBjb252ZXJ0ZWQgdG8gVW5pY29kZS5cblx0ICogQG1lbWJlck9mIHB1bnljb2RlXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCBUaGUgUHVueWNvZGVkIGRvbWFpbiBuYW1lIG9yIGVtYWlsIGFkZHJlc3MgdG9cblx0ICogY29udmVydCB0byBVbmljb2RlLlxuXHQgKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgVW5pY29kZSByZXByZXNlbnRhdGlvbiBvZiB0aGUgZ2l2ZW4gUHVueWNvZGVcblx0ICogc3RyaW5nLlxuXHQgKi9cblx0ZnVuY3Rpb24gdG9Vbmljb2RlKGlucHV0KSB7XG5cdFx0cmV0dXJuIG1hcERvbWFpbihpbnB1dCwgZnVuY3Rpb24oc3RyaW5nKSB7XG5cdFx0XHRyZXR1cm4gcmVnZXhQdW55Y29kZS50ZXN0KHN0cmluZylcblx0XHRcdFx0PyBkZWNvZGUoc3RyaW5nLnNsaWNlKDQpLnRvTG93ZXJDYXNlKCkpXG5cdFx0XHRcdDogc3RyaW5nO1xuXHRcdH0pO1xuXHR9XG5cblx0LyoqXG5cdCAqIENvbnZlcnRzIGEgVW5pY29kZSBzdHJpbmcgcmVwcmVzZW50aW5nIGEgZG9tYWluIG5hbWUgb3IgYW4gZW1haWwgYWRkcmVzcyB0b1xuXHQgKiBQdW55Y29kZS4gT25seSB0aGUgbm9uLUFTQ0lJIHBhcnRzIG9mIHRoZSBkb21haW4gbmFtZSB3aWxsIGJlIGNvbnZlcnRlZCxcblx0ICogaS5lLiBpdCBkb2Vzbid0IG1hdHRlciBpZiB5b3UgY2FsbCBpdCB3aXRoIGEgZG9tYWluIHRoYXQncyBhbHJlYWR5IGluXG5cdCAqIEFTQ0lJLlxuXHQgKiBAbWVtYmVyT2YgcHVueWNvZGVcblx0ICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IFRoZSBkb21haW4gbmFtZSBvciBlbWFpbCBhZGRyZXNzIHRvIGNvbnZlcnQsIGFzIGFcblx0ICogVW5pY29kZSBzdHJpbmcuXG5cdCAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBQdW55Y29kZSByZXByZXNlbnRhdGlvbiBvZiB0aGUgZ2l2ZW4gZG9tYWluIG5hbWUgb3Jcblx0ICogZW1haWwgYWRkcmVzcy5cblx0ICovXG5cdGZ1bmN0aW9uIHRvQVNDSUkoaW5wdXQpIHtcblx0XHRyZXR1cm4gbWFwRG9tYWluKGlucHV0LCBmdW5jdGlvbihzdHJpbmcpIHtcblx0XHRcdHJldHVybiByZWdleE5vbkFTQ0lJLnRlc3Qoc3RyaW5nKVxuXHRcdFx0XHQ/ICd4bi0tJyArIGVuY29kZShzdHJpbmcpXG5cdFx0XHRcdDogc3RyaW5nO1xuXHRcdH0pO1xuXHR9XG5cblx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0LyoqIERlZmluZSB0aGUgcHVibGljIEFQSSAqL1xuXHRwdW55Y29kZSA9IHtcblx0XHQvKipcblx0XHQgKiBBIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIGN1cnJlbnQgUHVueWNvZGUuanMgdmVyc2lvbiBudW1iZXIuXG5cdFx0ICogQG1lbWJlck9mIHB1bnljb2RlXG5cdFx0ICogQHR5cGUgU3RyaW5nXG5cdFx0ICovXG5cdFx0J3ZlcnNpb24nOiAnMS40LjEnLFxuXHRcdC8qKlxuXHRcdCAqIEFuIG9iamVjdCBvZiBtZXRob2RzIHRvIGNvbnZlcnQgZnJvbSBKYXZhU2NyaXB0J3MgaW50ZXJuYWwgY2hhcmFjdGVyXG5cdFx0ICogcmVwcmVzZW50YXRpb24gKFVDUy0yKSB0byBVbmljb2RlIGNvZGUgcG9pbnRzLCBhbmQgYmFjay5cblx0XHQgKiBAc2VlIDxodHRwczovL21hdGhpYXNieW5lbnMuYmUvbm90ZXMvamF2YXNjcmlwdC1lbmNvZGluZz5cblx0XHQgKiBAbWVtYmVyT2YgcHVueWNvZGVcblx0XHQgKiBAdHlwZSBPYmplY3Rcblx0XHQgKi9cblx0XHQndWNzMic6IHtcblx0XHRcdCdkZWNvZGUnOiB1Y3MyZGVjb2RlLFxuXHRcdFx0J2VuY29kZSc6IHVjczJlbmNvZGVcblx0XHR9LFxuXHRcdCdkZWNvZGUnOiBkZWNvZGUsXG5cdFx0J2VuY29kZSc6IGVuY29kZSxcblx0XHQndG9BU0NJSSc6IHRvQVNDSUksXG5cdFx0J3RvVW5pY29kZSc6IHRvVW5pY29kZVxuXHR9O1xuXG5cdC8qKiBFeHBvc2UgYHB1bnljb2RlYCAqL1xuXHQvLyBTb21lIEFNRCBidWlsZCBvcHRpbWl6ZXJzLCBsaWtlIHIuanMsIGNoZWNrIGZvciBzcGVjaWZpYyBjb25kaXRpb24gcGF0dGVybnNcblx0Ly8gbGlrZSB0aGUgZm9sbG93aW5nOlxuXHRpZiAoXG5cdFx0dHlwZW9mIGRlZmluZSA9PSAnZnVuY3Rpb24nICYmXG5cdFx0dHlwZW9mIGRlZmluZS5hbWQgPT0gJ29iamVjdCcgJiZcblx0XHRkZWZpbmUuYW1kXG5cdCkge1xuXHRcdGRlZmluZSgncHVueWNvZGUnLCBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiBwdW55Y29kZTtcblx0XHR9KTtcblx0fSBlbHNlIGlmIChmcmVlRXhwb3J0cyAmJiBmcmVlTW9kdWxlKSB7XG5cdFx0aWYgKG1vZHVsZS5leHBvcnRzID09IGZyZWVFeHBvcnRzKSB7XG5cdFx0XHQvLyBpbiBOb2RlLmpzLCBpby5qcywgb3IgUmluZ29KUyB2MC44LjArXG5cdFx0XHRmcmVlTW9kdWxlLmV4cG9ydHMgPSBwdW55Y29kZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gaW4gTmFyd2hhbCBvciBSaW5nb0pTIHYwLjcuMC1cblx0XHRcdGZvciAoa2V5IGluIHB1bnljb2RlKSB7XG5cdFx0XHRcdHB1bnljb2RlLmhhc093blByb3BlcnR5KGtleSkgJiYgKGZyZWVFeHBvcnRzW2tleV0gPSBwdW55Y29kZVtrZXldKTtcblx0XHRcdH1cblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0Ly8gaW4gUmhpbm8gb3IgYSB3ZWIgYnJvd3NlclxuXHRcdHJvb3QucHVueWNvZGUgPSBwdW55Y29kZTtcblx0fVxuXG59KHRoaXMpKTtcblxufSkuY2FsbCh0aGlzLHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWwgOiB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDoge30pXG59LHt9XSwyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbi8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLlxuLy9cbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhXG4vLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlXG4vLyBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmdcbi8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCxcbi8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXRcbi8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZVxuLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWRcbi8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1Ncbi8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0Zcbi8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU5cbi8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SXG4vLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFXG4vLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG4ndXNlIHN0cmljdCc7XG5cbi8vIElmIG9iai5oYXNPd25Qcm9wZXJ0eSBoYXMgYmVlbiBvdmVycmlkZGVuLCB0aGVuIGNhbGxpbmdcbi8vIG9iai5oYXNPd25Qcm9wZXJ0eShwcm9wKSB3aWxsIGJyZWFrLlxuLy8gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vam95ZW50L25vZGUvaXNzdWVzLzE3MDdcbmZ1bmN0aW9uIGhhc093blByb3BlcnR5KG9iaiwgcHJvcCkge1xuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocXMsIHNlcCwgZXEsIG9wdGlvbnMpIHtcbiAgc2VwID0gc2VwIHx8ICcmJztcbiAgZXEgPSBlcSB8fCAnPSc7XG4gIHZhciBvYmogPSB7fTtcblxuICBpZiAodHlwZW9mIHFzICE9PSAnc3RyaW5nJyB8fCBxcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gb2JqO1xuICB9XG5cbiAgdmFyIHJlZ2V4cCA9IC9cXCsvZztcbiAgcXMgPSBxcy5zcGxpdChzZXApO1xuXG4gIHZhciBtYXhLZXlzID0gMTAwMDtcbiAgaWYgKG9wdGlvbnMgJiYgdHlwZW9mIG9wdGlvbnMubWF4S2V5cyA9PT0gJ251bWJlcicpIHtcbiAgICBtYXhLZXlzID0gb3B0aW9ucy5tYXhLZXlzO1xuICB9XG5cbiAgdmFyIGxlbiA9IHFzLmxlbmd0aDtcbiAgLy8gbWF4S2V5cyA8PSAwIG1lYW5zIHRoYXQgd2Ugc2hvdWxkIG5vdCBsaW1pdCBrZXlzIGNvdW50XG4gIGlmIChtYXhLZXlzID4gMCAmJiBsZW4gPiBtYXhLZXlzKSB7XG4gICAgbGVuID0gbWF4S2V5cztcbiAgfVxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICB2YXIgeCA9IHFzW2ldLnJlcGxhY2UocmVnZXhwLCAnJTIwJyksXG4gICAgICAgIGlkeCA9IHguaW5kZXhPZihlcSksXG4gICAgICAgIGtzdHIsIHZzdHIsIGssIHY7XG5cbiAgICBpZiAoaWR4ID49IDApIHtcbiAgICAgIGtzdHIgPSB4LnN1YnN0cigwLCBpZHgpO1xuICAgICAgdnN0ciA9IHguc3Vic3RyKGlkeCArIDEpO1xuICAgIH0gZWxzZSB7XG4gICAgICBrc3RyID0geDtcbiAgICAgIHZzdHIgPSAnJztcbiAgICB9XG5cbiAgICBrID0gZGVjb2RlVVJJQ29tcG9uZW50KGtzdHIpO1xuICAgIHYgPSBkZWNvZGVVUklDb21wb25lbnQodnN0cik7XG5cbiAgICBpZiAoIWhhc093blByb3BlcnR5KG9iaiwgaykpIHtcbiAgICAgIG9ialtrXSA9IHY7XG4gICAgfSBlbHNlIGlmIChpc0FycmF5KG9ialtrXSkpIHtcbiAgICAgIG9ialtrXS5wdXNoKHYpO1xuICAgIH0gZWxzZSB7XG4gICAgICBvYmpba10gPSBbb2JqW2tdLCB2XTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gb2JqO1xufTtcblxudmFyIGlzQXJyYXkgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uICh4cykge1xuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHhzKSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbn07XG5cbn0se31dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGFcbi8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGVcbi8vIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZ1xuLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdFxuLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlXG4vLyBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZFxuLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTU1xuLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRlxuLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTlxuLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1Jcbi8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEVcbi8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbid1c2Ugc3RyaWN0JztcblxudmFyIHN0cmluZ2lmeVByaW1pdGl2ZSA9IGZ1bmN0aW9uKHYpIHtcbiAgc3dpdGNoICh0eXBlb2Ygdikge1xuICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICByZXR1cm4gdjtcblxuICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgcmV0dXJuIHYgPyAndHJ1ZScgOiAnZmFsc2UnO1xuXG4gICAgY2FzZSAnbnVtYmVyJzpcbiAgICAgIHJldHVybiBpc0Zpbml0ZSh2KSA/IHYgOiAnJztcblxuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gJyc7XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob2JqLCBzZXAsIGVxLCBuYW1lKSB7XG4gIHNlcCA9IHNlcCB8fCAnJic7XG4gIGVxID0gZXEgfHwgJz0nO1xuICBpZiAob2JqID09PSBudWxsKSB7XG4gICAgb2JqID0gdW5kZWZpbmVkO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBvYmogPT09ICdvYmplY3QnKSB7XG4gICAgcmV0dXJuIG1hcChvYmplY3RLZXlzKG9iaiksIGZ1bmN0aW9uKGspIHtcbiAgICAgIHZhciBrcyA9IGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUoaykpICsgZXE7XG4gICAgICBpZiAoaXNBcnJheShvYmpba10pKSB7XG4gICAgICAgIHJldHVybiBtYXAob2JqW2tdLCBmdW5jdGlvbih2KSB7XG4gICAgICAgICAgcmV0dXJuIGtzICsgZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZSh2KSk7XG4gICAgICAgIH0pLmpvaW4oc2VwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBrcyArIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUob2JqW2tdKSk7XG4gICAgICB9XG4gICAgfSkuam9pbihzZXApO1xuXG4gIH1cblxuICBpZiAoIW5hbWUpIHJldHVybiAnJztcbiAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUobmFtZSkpICsgZXEgK1xuICAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShvYmopKTtcbn07XG5cbnZhciBpc0FycmF5ID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAoeHMpIHtcbiAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh4cykgPT09ICdbb2JqZWN0IEFycmF5XSc7XG59O1xuXG5mdW5jdGlvbiBtYXAgKHhzLCBmKSB7XG4gIGlmICh4cy5tYXApIHJldHVybiB4cy5tYXAoZik7XG4gIHZhciByZXMgPSBbXTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB4cy5sZW5ndGg7IGkrKykge1xuICAgIHJlcy5wdXNoKGYoeHNbaV0sIGkpKTtcbiAgfVxuICByZXR1cm4gcmVzO1xufVxuXG52YXIgb2JqZWN0S2V5cyA9IE9iamVjdC5rZXlzIHx8IGZ1bmN0aW9uIChvYmopIHtcbiAgdmFyIHJlcyA9IFtdO1xuICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHJlcy5wdXNoKGtleSk7XG4gIH1cbiAgcmV0dXJuIHJlcztcbn07XG5cbn0se31dLDQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5leHBvcnRzLmRlY29kZSA9IGV4cG9ydHMucGFyc2UgPSByZXF1aXJlKCcuL2RlY29kZScpO1xuZXhwb3J0cy5lbmNvZGUgPSBleHBvcnRzLnN0cmluZ2lmeSA9IHJlcXVpcmUoJy4vZW5jb2RlJyk7XG5cbn0se1wiLi9kZWNvZGVcIjoyLFwiLi9lbmNvZGVcIjozfV0sNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4vLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy5cbi8vXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYVxuLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZVxuLy8gXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nXG4vLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsXG4vLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0XG4vLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGVcbi8vIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkXG4vLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTXG4vLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GXG4vLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOXG4vLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUlxuLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRVxuLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgcHVueWNvZGUgPSByZXF1aXJlKCdwdW55Y29kZScpO1xudmFyIHV0aWwgPSByZXF1aXJlKCcuL3V0aWwnKTtcblxuZXhwb3J0cy5wYXJzZSA9IHVybFBhcnNlO1xuZXhwb3J0cy5yZXNvbHZlID0gdXJsUmVzb2x2ZTtcbmV4cG9ydHMucmVzb2x2ZU9iamVjdCA9IHVybFJlc29sdmVPYmplY3Q7XG5leHBvcnRzLmZvcm1hdCA9IHVybEZvcm1hdDtcblxuZXhwb3J0cy5VcmwgPSBVcmw7XG5cbmZ1bmN0aW9uIFVybCgpIHtcbiAgdGhpcy5wcm90b2NvbCA9IG51bGw7XG4gIHRoaXMuc2xhc2hlcyA9IG51bGw7XG4gIHRoaXMuYXV0aCA9IG51bGw7XG4gIHRoaXMuaG9zdCA9IG51bGw7XG4gIHRoaXMucG9ydCA9IG51bGw7XG4gIHRoaXMuaG9zdG5hbWUgPSBudWxsO1xuICB0aGlzLmhhc2ggPSBudWxsO1xuICB0aGlzLnNlYXJjaCA9IG51bGw7XG4gIHRoaXMucXVlcnkgPSBudWxsO1xuICB0aGlzLnBhdGhuYW1lID0gbnVsbDtcbiAgdGhpcy5wYXRoID0gbnVsbDtcbiAgdGhpcy5ocmVmID0gbnVsbDtcbn1cblxuLy8gUmVmZXJlbmNlOiBSRkMgMzk4NiwgUkZDIDE4MDgsIFJGQyAyMzk2XG5cbi8vIGRlZmluZSB0aGVzZSBoZXJlIHNvIGF0IGxlYXN0IHRoZXkgb25seSBoYXZlIHRvIGJlXG4vLyBjb21waWxlZCBvbmNlIG9uIHRoZSBmaXJzdCBtb2R1bGUgbG9hZC5cbnZhciBwcm90b2NvbFBhdHRlcm4gPSAvXihbYS16MC05ListXSs6KS9pLFxuICAgIHBvcnRQYXR0ZXJuID0gLzpbMC05XSokLyxcblxuICAgIC8vIFNwZWNpYWwgY2FzZSBmb3IgYSBzaW1wbGUgcGF0aCBVUkxcbiAgICBzaW1wbGVQYXRoUGF0dGVybiA9IC9eKFxcL1xcLz8oPyFcXC8pW15cXD9cXHNdKikoXFw/W15cXHNdKik/JC8sXG5cbiAgICAvLyBSRkMgMjM5NjogY2hhcmFjdGVycyByZXNlcnZlZCBmb3IgZGVsaW1pdGluZyBVUkxzLlxuICAgIC8vIFdlIGFjdHVhbGx5IGp1c3QgYXV0by1lc2NhcGUgdGhlc2UuXG4gICAgZGVsaW1zID0gWyc8JywgJz4nLCAnXCInLCAnYCcsICcgJywgJ1xccicsICdcXG4nLCAnXFx0J10sXG5cbiAgICAvLyBSRkMgMjM5NjogY2hhcmFjdGVycyBub3QgYWxsb3dlZCBmb3IgdmFyaW91cyByZWFzb25zLlxuICAgIHVud2lzZSA9IFsneycsICd9JywgJ3wnLCAnXFxcXCcsICdeJywgJ2AnXS5jb25jYXQoZGVsaW1zKSxcblxuICAgIC8vIEFsbG93ZWQgYnkgUkZDcywgYnV0IGNhdXNlIG9mIFhTUyBhdHRhY2tzLiAgQWx3YXlzIGVzY2FwZSB0aGVzZS5cbiAgICBhdXRvRXNjYXBlID0gWydcXCcnXS5jb25jYXQodW53aXNlKSxcbiAgICAvLyBDaGFyYWN0ZXJzIHRoYXQgYXJlIG5ldmVyIGV2ZXIgYWxsb3dlZCBpbiBhIGhvc3RuYW1lLlxuICAgIC8vIE5vdGUgdGhhdCBhbnkgaW52YWxpZCBjaGFycyBhcmUgYWxzbyBoYW5kbGVkLCBidXQgdGhlc2VcbiAgICAvLyBhcmUgdGhlIG9uZXMgdGhhdCBhcmUgKmV4cGVjdGVkKiB0byBiZSBzZWVuLCBzbyB3ZSBmYXN0LXBhdGhcbiAgICAvLyB0aGVtLlxuICAgIG5vbkhvc3RDaGFycyA9IFsnJScsICcvJywgJz8nLCAnOycsICcjJ10uY29uY2F0KGF1dG9Fc2NhcGUpLFxuICAgIGhvc3RFbmRpbmdDaGFycyA9IFsnLycsICc/JywgJyMnXSxcbiAgICBob3N0bmFtZU1heExlbiA9IDI1NSxcbiAgICBob3N0bmFtZVBhcnRQYXR0ZXJuID0gL15bK2EtejAtOUEtWl8tXXswLDYzfSQvLFxuICAgIGhvc3RuYW1lUGFydFN0YXJ0ID0gL14oWythLXowLTlBLVpfLV17MCw2M30pKC4qKSQvLFxuICAgIC8vIHByb3RvY29scyB0aGF0IGNhbiBhbGxvdyBcInVuc2FmZVwiIGFuZCBcInVud2lzZVwiIGNoYXJzLlxuICAgIHVuc2FmZVByb3RvY29sID0ge1xuICAgICAgJ2phdmFzY3JpcHQnOiB0cnVlLFxuICAgICAgJ2phdmFzY3JpcHQ6JzogdHJ1ZVxuICAgIH0sXG4gICAgLy8gcHJvdG9jb2xzIHRoYXQgbmV2ZXIgaGF2ZSBhIGhvc3RuYW1lLlxuICAgIGhvc3RsZXNzUHJvdG9jb2wgPSB7XG4gICAgICAnamF2YXNjcmlwdCc6IHRydWUsXG4gICAgICAnamF2YXNjcmlwdDonOiB0cnVlXG4gICAgfSxcbiAgICAvLyBwcm90b2NvbHMgdGhhdCBhbHdheXMgY29udGFpbiBhIC8vIGJpdC5cbiAgICBzbGFzaGVkUHJvdG9jb2wgPSB7XG4gICAgICAnaHR0cCc6IHRydWUsXG4gICAgICAnaHR0cHMnOiB0cnVlLFxuICAgICAgJ2Z0cCc6IHRydWUsXG4gICAgICAnZ29waGVyJzogdHJ1ZSxcbiAgICAgICdmaWxlJzogdHJ1ZSxcbiAgICAgICdodHRwOic6IHRydWUsXG4gICAgICAnaHR0cHM6JzogdHJ1ZSxcbiAgICAgICdmdHA6JzogdHJ1ZSxcbiAgICAgICdnb3BoZXI6JzogdHJ1ZSxcbiAgICAgICdmaWxlOic6IHRydWVcbiAgICB9LFxuICAgIHF1ZXJ5c3RyaW5nID0gcmVxdWlyZSgncXVlcnlzdHJpbmcnKTtcblxuZnVuY3Rpb24gdXJsUGFyc2UodXJsLCBwYXJzZVF1ZXJ5U3RyaW5nLCBzbGFzaGVzRGVub3RlSG9zdCkge1xuICBpZiAodXJsICYmIHV0aWwuaXNPYmplY3QodXJsKSAmJiB1cmwgaW5zdGFuY2VvZiBVcmwpIHJldHVybiB1cmw7XG5cbiAgdmFyIHUgPSBuZXcgVXJsO1xuICB1LnBhcnNlKHVybCwgcGFyc2VRdWVyeVN0cmluZywgc2xhc2hlc0Rlbm90ZUhvc3QpO1xuICByZXR1cm4gdTtcbn1cblxuVXJsLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uKHVybCwgcGFyc2VRdWVyeVN0cmluZywgc2xhc2hlc0Rlbm90ZUhvc3QpIHtcbiAgaWYgKCF1dGlsLmlzU3RyaW5nKHVybCkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUGFyYW1ldGVyICd1cmwnIG11c3QgYmUgYSBzdHJpbmcsIG5vdCBcIiArIHR5cGVvZiB1cmwpO1xuICB9XG5cbiAgLy8gQ29weSBjaHJvbWUsIElFLCBvcGVyYSBiYWNrc2xhc2gtaGFuZGxpbmcgYmVoYXZpb3IuXG4gIC8vIEJhY2sgc2xhc2hlcyBiZWZvcmUgdGhlIHF1ZXJ5IHN0cmluZyBnZXQgY29udmVydGVkIHRvIGZvcndhcmQgc2xhc2hlc1xuICAvLyBTZWU6IGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD0yNTkxNlxuICB2YXIgcXVlcnlJbmRleCA9IHVybC5pbmRleE9mKCc/JyksXG4gICAgICBzcGxpdHRlciA9XG4gICAgICAgICAgKHF1ZXJ5SW5kZXggIT09IC0xICYmIHF1ZXJ5SW5kZXggPCB1cmwuaW5kZXhPZignIycpKSA/ICc/JyA6ICcjJyxcbiAgICAgIHVTcGxpdCA9IHVybC5zcGxpdChzcGxpdHRlciksXG4gICAgICBzbGFzaFJlZ2V4ID0gL1xcXFwvZztcbiAgdVNwbGl0WzBdID0gdVNwbGl0WzBdLnJlcGxhY2Uoc2xhc2hSZWdleCwgJy8nKTtcbiAgdXJsID0gdVNwbGl0LmpvaW4oc3BsaXR0ZXIpO1xuXG4gIHZhciByZXN0ID0gdXJsO1xuXG4gIC8vIHRyaW0gYmVmb3JlIHByb2NlZWRpbmcuXG4gIC8vIFRoaXMgaXMgdG8gc3VwcG9ydCBwYXJzZSBzdHVmZiBsaWtlIFwiICBodHRwOi8vZm9vLmNvbSAgXFxuXCJcbiAgcmVzdCA9IHJlc3QudHJpbSgpO1xuXG4gIGlmICghc2xhc2hlc0Rlbm90ZUhvc3QgJiYgdXJsLnNwbGl0KCcjJykubGVuZ3RoID09PSAxKSB7XG4gICAgLy8gVHJ5IGZhc3QgcGF0aCByZWdleHBcbiAgICB2YXIgc2ltcGxlUGF0aCA9IHNpbXBsZVBhdGhQYXR0ZXJuLmV4ZWMocmVzdCk7XG4gICAgaWYgKHNpbXBsZVBhdGgpIHtcbiAgICAgIHRoaXMucGF0aCA9IHJlc3Q7XG4gICAgICB0aGlzLmhyZWYgPSByZXN0O1xuICAgICAgdGhpcy5wYXRobmFtZSA9IHNpbXBsZVBhdGhbMV07XG4gICAgICBpZiAoc2ltcGxlUGF0aFsyXSkge1xuICAgICAgICB0aGlzLnNlYXJjaCA9IHNpbXBsZVBhdGhbMl07XG4gICAgICAgIGlmIChwYXJzZVF1ZXJ5U3RyaW5nKSB7XG4gICAgICAgICAgdGhpcy5xdWVyeSA9IHF1ZXJ5c3RyaW5nLnBhcnNlKHRoaXMuc2VhcmNoLnN1YnN0cigxKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5xdWVyeSA9IHRoaXMuc2VhcmNoLnN1YnN0cigxKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChwYXJzZVF1ZXJ5U3RyaW5nKSB7XG4gICAgICAgIHRoaXMuc2VhcmNoID0gJyc7XG4gICAgICAgIHRoaXMucXVlcnkgPSB7fTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgfVxuXG4gIHZhciBwcm90byA9IHByb3RvY29sUGF0dGVybi5leGVjKHJlc3QpO1xuICBpZiAocHJvdG8pIHtcbiAgICBwcm90byA9IHByb3RvWzBdO1xuICAgIHZhciBsb3dlclByb3RvID0gcHJvdG8udG9Mb3dlckNhc2UoKTtcbiAgICB0aGlzLnByb3RvY29sID0gbG93ZXJQcm90bztcbiAgICByZXN0ID0gcmVzdC5zdWJzdHIocHJvdG8ubGVuZ3RoKTtcbiAgfVxuXG4gIC8vIGZpZ3VyZSBvdXQgaWYgaXQncyBnb3QgYSBob3N0XG4gIC8vIHVzZXJAc2VydmVyIGlzICphbHdheXMqIGludGVycHJldGVkIGFzIGEgaG9zdG5hbWUsIGFuZCB1cmxcbiAgLy8gcmVzb2x1dGlvbiB3aWxsIHRyZWF0IC8vZm9vL2JhciBhcyBob3N0PWZvbyxwYXRoPWJhciBiZWNhdXNlIHRoYXQnc1xuICAvLyBob3cgdGhlIGJyb3dzZXIgcmVzb2x2ZXMgcmVsYXRpdmUgVVJMcy5cbiAgaWYgKHNsYXNoZXNEZW5vdGVIb3N0IHx8IHByb3RvIHx8IHJlc3QubWF0Y2goL15cXC9cXC9bXkBcXC9dK0BbXkBcXC9dKy8pKSB7XG4gICAgdmFyIHNsYXNoZXMgPSByZXN0LnN1YnN0cigwLCAyKSA9PT0gJy8vJztcbiAgICBpZiAoc2xhc2hlcyAmJiAhKHByb3RvICYmIGhvc3RsZXNzUHJvdG9jb2xbcHJvdG9dKSkge1xuICAgICAgcmVzdCA9IHJlc3Quc3Vic3RyKDIpO1xuICAgICAgdGhpcy5zbGFzaGVzID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBpZiAoIWhvc3RsZXNzUHJvdG9jb2xbcHJvdG9dICYmXG4gICAgICAoc2xhc2hlcyB8fCAocHJvdG8gJiYgIXNsYXNoZWRQcm90b2NvbFtwcm90b10pKSkge1xuXG4gICAgLy8gdGhlcmUncyBhIGhvc3RuYW1lLlxuICAgIC8vIHRoZSBmaXJzdCBpbnN0YW5jZSBvZiAvLCA/LCA7LCBvciAjIGVuZHMgdGhlIGhvc3QuXG4gICAgLy9cbiAgICAvLyBJZiB0aGVyZSBpcyBhbiBAIGluIHRoZSBob3N0bmFtZSwgdGhlbiBub24taG9zdCBjaGFycyAqYXJlKiBhbGxvd2VkXG4gICAgLy8gdG8gdGhlIGxlZnQgb2YgdGhlIGxhc3QgQCBzaWduLCB1bmxlc3Mgc29tZSBob3N0LWVuZGluZyBjaGFyYWN0ZXJcbiAgICAvLyBjb21lcyAqYmVmb3JlKiB0aGUgQC1zaWduLlxuICAgIC8vIFVSTHMgYXJlIG9ibm94aW91cy5cbiAgICAvL1xuICAgIC8vIGV4OlxuICAgIC8vIGh0dHA6Ly9hQGJAYy8gPT4gdXNlcjphQGIgaG9zdDpjXG4gICAgLy8gaHR0cDovL2FAYj9AYyA9PiB1c2VyOmEgaG9zdDpjIHBhdGg6Lz9AY1xuXG4gICAgLy8gdjAuMTIgVE9ETyhpc2FhY3MpOiBUaGlzIGlzIG5vdCBxdWl0ZSBob3cgQ2hyb21lIGRvZXMgdGhpbmdzLlxuICAgIC8vIFJldmlldyBvdXIgdGVzdCBjYXNlIGFnYWluc3QgYnJvd3NlcnMgbW9yZSBjb21wcmVoZW5zaXZlbHkuXG5cbiAgICAvLyBmaW5kIHRoZSBmaXJzdCBpbnN0YW5jZSBvZiBhbnkgaG9zdEVuZGluZ0NoYXJzXG4gICAgdmFyIGhvc3RFbmQgPSAtMTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhvc3RFbmRpbmdDaGFycy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGhlYyA9IHJlc3QuaW5kZXhPZihob3N0RW5kaW5nQ2hhcnNbaV0pO1xuICAgICAgaWYgKGhlYyAhPT0gLTEgJiYgKGhvc3RFbmQgPT09IC0xIHx8IGhlYyA8IGhvc3RFbmQpKVxuICAgICAgICBob3N0RW5kID0gaGVjO1xuICAgIH1cblxuICAgIC8vIGF0IHRoaXMgcG9pbnQsIGVpdGhlciB3ZSBoYXZlIGFuIGV4cGxpY2l0IHBvaW50IHdoZXJlIHRoZVxuICAgIC8vIGF1dGggcG9ydGlvbiBjYW5ub3QgZ28gcGFzdCwgb3IgdGhlIGxhc3QgQCBjaGFyIGlzIHRoZSBkZWNpZGVyLlxuICAgIHZhciBhdXRoLCBhdFNpZ247XG4gICAgaWYgKGhvc3RFbmQgPT09IC0xKSB7XG4gICAgICAvLyBhdFNpZ24gY2FuIGJlIGFueXdoZXJlLlxuICAgICAgYXRTaWduID0gcmVzdC5sYXN0SW5kZXhPZignQCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBhdFNpZ24gbXVzdCBiZSBpbiBhdXRoIHBvcnRpb24uXG4gICAgICAvLyBodHRwOi8vYUBiL2NAZCA9PiBob3N0OmIgYXV0aDphIHBhdGg6L2NAZFxuICAgICAgYXRTaWduID0gcmVzdC5sYXN0SW5kZXhPZignQCcsIGhvc3RFbmQpO1xuICAgIH1cblxuICAgIC8vIE5vdyB3ZSBoYXZlIGEgcG9ydGlvbiB3aGljaCBpcyBkZWZpbml0ZWx5IHRoZSBhdXRoLlxuICAgIC8vIFB1bGwgdGhhdCBvZmYuXG4gICAgaWYgKGF0U2lnbiAhPT0gLTEpIHtcbiAgICAgIGF1dGggPSByZXN0LnNsaWNlKDAsIGF0U2lnbik7XG4gICAgICByZXN0ID0gcmVzdC5zbGljZShhdFNpZ24gKyAxKTtcbiAgICAgIHRoaXMuYXV0aCA9IGRlY29kZVVSSUNvbXBvbmVudChhdXRoKTtcbiAgICB9XG5cbiAgICAvLyB0aGUgaG9zdCBpcyB0aGUgcmVtYWluaW5nIHRvIHRoZSBsZWZ0IG9mIHRoZSBmaXJzdCBub24taG9zdCBjaGFyXG4gICAgaG9zdEVuZCA9IC0xO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9uSG9zdENoYXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgaGVjID0gcmVzdC5pbmRleE9mKG5vbkhvc3RDaGFyc1tpXSk7XG4gICAgICBpZiAoaGVjICE9PSAtMSAmJiAoaG9zdEVuZCA9PT0gLTEgfHwgaGVjIDwgaG9zdEVuZCkpXG4gICAgICAgIGhvc3RFbmQgPSBoZWM7XG4gICAgfVxuICAgIC8vIGlmIHdlIHN0aWxsIGhhdmUgbm90IGhpdCBpdCwgdGhlbiB0aGUgZW50aXJlIHRoaW5nIGlzIGEgaG9zdC5cbiAgICBpZiAoaG9zdEVuZCA9PT0gLTEpXG4gICAgICBob3N0RW5kID0gcmVzdC5sZW5ndGg7XG5cbiAgICB0aGlzLmhvc3QgPSByZXN0LnNsaWNlKDAsIGhvc3RFbmQpO1xuICAgIHJlc3QgPSByZXN0LnNsaWNlKGhvc3RFbmQpO1xuXG4gICAgLy8gcHVsbCBvdXQgcG9ydC5cbiAgICB0aGlzLnBhcnNlSG9zdCgpO1xuXG4gICAgLy8gd2UndmUgaW5kaWNhdGVkIHRoYXQgdGhlcmUgaXMgYSBob3N0bmFtZSxcbiAgICAvLyBzbyBldmVuIGlmIGl0J3MgZW1wdHksIGl0IGhhcyB0byBiZSBwcmVzZW50LlxuICAgIHRoaXMuaG9zdG5hbWUgPSB0aGlzLmhvc3RuYW1lIHx8ICcnO1xuXG4gICAgLy8gaWYgaG9zdG5hbWUgYmVnaW5zIHdpdGggWyBhbmQgZW5kcyB3aXRoIF1cbiAgICAvLyBhc3N1bWUgdGhhdCBpdCdzIGFuIElQdjYgYWRkcmVzcy5cbiAgICB2YXIgaXB2Nkhvc3RuYW1lID0gdGhpcy5ob3N0bmFtZVswXSA9PT0gJ1snICYmXG4gICAgICAgIHRoaXMuaG9zdG5hbWVbdGhpcy5ob3N0bmFtZS5sZW5ndGggLSAxXSA9PT0gJ10nO1xuXG4gICAgLy8gdmFsaWRhdGUgYSBsaXR0bGUuXG4gICAgaWYgKCFpcHY2SG9zdG5hbWUpIHtcbiAgICAgIHZhciBob3N0cGFydHMgPSB0aGlzLmhvc3RuYW1lLnNwbGl0KC9cXC4vKTtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gaG9zdHBhcnRzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICB2YXIgcGFydCA9IGhvc3RwYXJ0c1tpXTtcbiAgICAgICAgaWYgKCFwYXJ0KSBjb250aW51ZTtcbiAgICAgICAgaWYgKCFwYXJ0Lm1hdGNoKGhvc3RuYW1lUGFydFBhdHRlcm4pKSB7XG4gICAgICAgICAgdmFyIG5ld3BhcnQgPSAnJztcbiAgICAgICAgICBmb3IgKHZhciBqID0gMCwgayA9IHBhcnQubGVuZ3RoOyBqIDwgazsgaisrKSB7XG4gICAgICAgICAgICBpZiAocGFydC5jaGFyQ29kZUF0KGopID4gMTI3KSB7XG4gICAgICAgICAgICAgIC8vIHdlIHJlcGxhY2Ugbm9uLUFTQ0lJIGNoYXIgd2l0aCBhIHRlbXBvcmFyeSBwbGFjZWhvbGRlclxuICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRoaXMgdG8gbWFrZSBzdXJlIHNpemUgb2YgaG9zdG5hbWUgaXMgbm90XG4gICAgICAgICAgICAgIC8vIGJyb2tlbiBieSByZXBsYWNpbmcgbm9uLUFTQ0lJIGJ5IG5vdGhpbmdcbiAgICAgICAgICAgICAgbmV3cGFydCArPSAneCc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBuZXdwYXJ0ICs9IHBhcnRbal07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIHdlIHRlc3QgYWdhaW4gd2l0aCBBU0NJSSBjaGFyIG9ubHlcbiAgICAgICAgICBpZiAoIW5ld3BhcnQubWF0Y2goaG9zdG5hbWVQYXJ0UGF0dGVybikpIHtcbiAgICAgICAgICAgIHZhciB2YWxpZFBhcnRzID0gaG9zdHBhcnRzLnNsaWNlKDAsIGkpO1xuICAgICAgICAgICAgdmFyIG5vdEhvc3QgPSBob3N0cGFydHMuc2xpY2UoaSArIDEpO1xuICAgICAgICAgICAgdmFyIGJpdCA9IHBhcnQubWF0Y2goaG9zdG5hbWVQYXJ0U3RhcnQpO1xuICAgICAgICAgICAgaWYgKGJpdCkge1xuICAgICAgICAgICAgICB2YWxpZFBhcnRzLnB1c2goYml0WzFdKTtcbiAgICAgICAgICAgICAgbm90SG9zdC51bnNoaWZ0KGJpdFsyXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobm90SG9zdC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgcmVzdCA9ICcvJyArIG5vdEhvc3Quam9pbignLicpICsgcmVzdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaG9zdG5hbWUgPSB2YWxpZFBhcnRzLmpvaW4oJy4nKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLmhvc3RuYW1lLmxlbmd0aCA+IGhvc3RuYW1lTWF4TGVuKSB7XG4gICAgICB0aGlzLmhvc3RuYW1lID0gJyc7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGhvc3RuYW1lcyBhcmUgYWx3YXlzIGxvd2VyIGNhc2UuXG4gICAgICB0aGlzLmhvc3RuYW1lID0gdGhpcy5ob3N0bmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIH1cblxuICAgIGlmICghaXB2Nkhvc3RuYW1lKSB7XG4gICAgICAvLyBJRE5BIFN1cHBvcnQ6IFJldHVybnMgYSBwdW55Y29kZWQgcmVwcmVzZW50YXRpb24gb2YgXCJkb21haW5cIi5cbiAgICAgIC8vIEl0IG9ubHkgY29udmVydHMgcGFydHMgb2YgdGhlIGRvbWFpbiBuYW1lIHRoYXRcbiAgICAgIC8vIGhhdmUgbm9uLUFTQ0lJIGNoYXJhY3RlcnMsIGkuZS4gaXQgZG9lc24ndCBtYXR0ZXIgaWZcbiAgICAgIC8vIHlvdSBjYWxsIGl0IHdpdGggYSBkb21haW4gdGhhdCBhbHJlYWR5IGlzIEFTQ0lJLW9ubHkuXG4gICAgICB0aGlzLmhvc3RuYW1lID0gcHVueWNvZGUudG9BU0NJSSh0aGlzLmhvc3RuYW1lKTtcbiAgICB9XG5cbiAgICB2YXIgcCA9IHRoaXMucG9ydCA/ICc6JyArIHRoaXMucG9ydCA6ICcnO1xuICAgIHZhciBoID0gdGhpcy5ob3N0bmFtZSB8fCAnJztcbiAgICB0aGlzLmhvc3QgPSBoICsgcDtcbiAgICB0aGlzLmhyZWYgKz0gdGhpcy5ob3N0O1xuXG4gICAgLy8gc3RyaXAgWyBhbmQgXSBmcm9tIHRoZSBob3N0bmFtZVxuICAgIC8vIHRoZSBob3N0IGZpZWxkIHN0aWxsIHJldGFpbnMgdGhlbSwgdGhvdWdoXG4gICAgaWYgKGlwdjZIb3N0bmFtZSkge1xuICAgICAgdGhpcy5ob3N0bmFtZSA9IHRoaXMuaG9zdG5hbWUuc3Vic3RyKDEsIHRoaXMuaG9zdG5hbWUubGVuZ3RoIC0gMik7XG4gICAgICBpZiAocmVzdFswXSAhPT0gJy8nKSB7XG4gICAgICAgIHJlc3QgPSAnLycgKyByZXN0O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIG5vdyByZXN0IGlzIHNldCB0byB0aGUgcG9zdC1ob3N0IHN0dWZmLlxuICAvLyBjaG9wIG9mZiBhbnkgZGVsaW0gY2hhcnMuXG4gIGlmICghdW5zYWZlUHJvdG9jb2xbbG93ZXJQcm90b10pIHtcblxuICAgIC8vIEZpcnN0LCBtYWtlIDEwMCUgc3VyZSB0aGF0IGFueSBcImF1dG9Fc2NhcGVcIiBjaGFycyBnZXRcbiAgICAvLyBlc2NhcGVkLCBldmVuIGlmIGVuY29kZVVSSUNvbXBvbmVudCBkb2Vzbid0IHRoaW5rIHRoZXlcbiAgICAvLyBuZWVkIHRvIGJlLlxuICAgIGZvciAodmFyIGkgPSAwLCBsID0gYXV0b0VzY2FwZS5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgIHZhciBhZSA9IGF1dG9Fc2NhcGVbaV07XG4gICAgICBpZiAocmVzdC5pbmRleE9mKGFlKSA9PT0gLTEpXG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgdmFyIGVzYyA9IGVuY29kZVVSSUNvbXBvbmVudChhZSk7XG4gICAgICBpZiAoZXNjID09PSBhZSkge1xuICAgICAgICBlc2MgPSBlc2NhcGUoYWUpO1xuICAgICAgfVxuICAgICAgcmVzdCA9IHJlc3Quc3BsaXQoYWUpLmpvaW4oZXNjKTtcbiAgICB9XG4gIH1cblxuXG4gIC8vIGNob3Agb2ZmIGZyb20gdGhlIHRhaWwgZmlyc3QuXG4gIHZhciBoYXNoID0gcmVzdC5pbmRleE9mKCcjJyk7XG4gIGlmIChoYXNoICE9PSAtMSkge1xuICAgIC8vIGdvdCBhIGZyYWdtZW50IHN0cmluZy5cbiAgICB0aGlzLmhhc2ggPSByZXN0LnN1YnN0cihoYXNoKTtcbiAgICByZXN0ID0gcmVzdC5zbGljZSgwLCBoYXNoKTtcbiAgfVxuICB2YXIgcW0gPSByZXN0LmluZGV4T2YoJz8nKTtcbiAgaWYgKHFtICE9PSAtMSkge1xuICAgIHRoaXMuc2VhcmNoID0gcmVzdC5zdWJzdHIocW0pO1xuICAgIHRoaXMucXVlcnkgPSByZXN0LnN1YnN0cihxbSArIDEpO1xuICAgIGlmIChwYXJzZVF1ZXJ5U3RyaW5nKSB7XG4gICAgICB0aGlzLnF1ZXJ5ID0gcXVlcnlzdHJpbmcucGFyc2UodGhpcy5xdWVyeSk7XG4gICAgfVxuICAgIHJlc3QgPSByZXN0LnNsaWNlKDAsIHFtKTtcbiAgfSBlbHNlIGlmIChwYXJzZVF1ZXJ5U3RyaW5nKSB7XG4gICAgLy8gbm8gcXVlcnkgc3RyaW5nLCBidXQgcGFyc2VRdWVyeVN0cmluZyBzdGlsbCByZXF1ZXN0ZWRcbiAgICB0aGlzLnNlYXJjaCA9ICcnO1xuICAgIHRoaXMucXVlcnkgPSB7fTtcbiAgfVxuICBpZiAocmVzdCkgdGhpcy5wYXRobmFtZSA9IHJlc3Q7XG4gIGlmIChzbGFzaGVkUHJvdG9jb2xbbG93ZXJQcm90b10gJiZcbiAgICAgIHRoaXMuaG9zdG5hbWUgJiYgIXRoaXMucGF0aG5hbWUpIHtcbiAgICB0aGlzLnBhdGhuYW1lID0gJy8nO1xuICB9XG5cbiAgLy90byBzdXBwb3J0IGh0dHAucmVxdWVzdFxuICBpZiAodGhpcy5wYXRobmFtZSB8fCB0aGlzLnNlYXJjaCkge1xuICAgIHZhciBwID0gdGhpcy5wYXRobmFtZSB8fCAnJztcbiAgICB2YXIgcyA9IHRoaXMuc2VhcmNoIHx8ICcnO1xuICAgIHRoaXMucGF0aCA9IHAgKyBzO1xuICB9XG5cbiAgLy8gZmluYWxseSwgcmVjb25zdHJ1Y3QgdGhlIGhyZWYgYmFzZWQgb24gd2hhdCBoYXMgYmVlbiB2YWxpZGF0ZWQuXG4gIHRoaXMuaHJlZiA9IHRoaXMuZm9ybWF0KCk7XG4gIHJldHVybiB0aGlzO1xufTtcblxuLy8gZm9ybWF0IGEgcGFyc2VkIG9iamVjdCBpbnRvIGEgdXJsIHN0cmluZ1xuZnVuY3Rpb24gdXJsRm9ybWF0KG9iaikge1xuICAvLyBlbnN1cmUgaXQncyBhbiBvYmplY3QsIGFuZCBub3QgYSBzdHJpbmcgdXJsLlxuICAvLyBJZiBpdCdzIGFuIG9iaiwgdGhpcyBpcyBhIG5vLW9wLlxuICAvLyB0aGlzIHdheSwgeW91IGNhbiBjYWxsIHVybF9mb3JtYXQoKSBvbiBzdHJpbmdzXG4gIC8vIHRvIGNsZWFuIHVwIHBvdGVudGlhbGx5IHdvbmt5IHVybHMuXG4gIGlmICh1dGlsLmlzU3RyaW5nKG9iaikpIG9iaiA9IHVybFBhcnNlKG9iaik7XG4gIGlmICghKG9iaiBpbnN0YW5jZW9mIFVybCkpIHJldHVybiBVcmwucHJvdG90eXBlLmZvcm1hdC5jYWxsKG9iaik7XG4gIHJldHVybiBvYmouZm9ybWF0KCk7XG59XG5cblVybC5wcm90b3R5cGUuZm9ybWF0ID0gZnVuY3Rpb24oKSB7XG4gIHZhciBhdXRoID0gdGhpcy5hdXRoIHx8ICcnO1xuICBpZiAoYXV0aCkge1xuICAgIGF1dGggPSBlbmNvZGVVUklDb21wb25lbnQoYXV0aCk7XG4gICAgYXV0aCA9IGF1dGgucmVwbGFjZSgvJTNBL2ksICc6Jyk7XG4gICAgYXV0aCArPSAnQCc7XG4gIH1cblxuICB2YXIgcHJvdG9jb2wgPSB0aGlzLnByb3RvY29sIHx8ICcnLFxuICAgICAgcGF0aG5hbWUgPSB0aGlzLnBhdGhuYW1lIHx8ICcnLFxuICAgICAgaGFzaCA9IHRoaXMuaGFzaCB8fCAnJyxcbiAgICAgIGhvc3QgPSBmYWxzZSxcbiAgICAgIHF1ZXJ5ID0gJyc7XG5cbiAgaWYgKHRoaXMuaG9zdCkge1xuICAgIGhvc3QgPSBhdXRoICsgdGhpcy5ob3N0O1xuICB9IGVsc2UgaWYgKHRoaXMuaG9zdG5hbWUpIHtcbiAgICBob3N0ID0gYXV0aCArICh0aGlzLmhvc3RuYW1lLmluZGV4T2YoJzonKSA9PT0gLTEgP1xuICAgICAgICB0aGlzLmhvc3RuYW1lIDpcbiAgICAgICAgJ1snICsgdGhpcy5ob3N0bmFtZSArICddJyk7XG4gICAgaWYgKHRoaXMucG9ydCkge1xuICAgICAgaG9zdCArPSAnOicgKyB0aGlzLnBvcnQ7XG4gICAgfVxuICB9XG5cbiAgaWYgKHRoaXMucXVlcnkgJiZcbiAgICAgIHV0aWwuaXNPYmplY3QodGhpcy5xdWVyeSkgJiZcbiAgICAgIE9iamVjdC5rZXlzKHRoaXMucXVlcnkpLmxlbmd0aCkge1xuICAgIHF1ZXJ5ID0gcXVlcnlzdHJpbmcuc3RyaW5naWZ5KHRoaXMucXVlcnkpO1xuICB9XG5cbiAgdmFyIHNlYXJjaCA9IHRoaXMuc2VhcmNoIHx8IChxdWVyeSAmJiAoJz8nICsgcXVlcnkpKSB8fCAnJztcblxuICBpZiAocHJvdG9jb2wgJiYgcHJvdG9jb2wuc3Vic3RyKC0xKSAhPT0gJzonKSBwcm90b2NvbCArPSAnOic7XG5cbiAgLy8gb25seSB0aGUgc2xhc2hlZFByb3RvY29scyBnZXQgdGhlIC8vLiAgTm90IG1haWx0bzosIHhtcHA6LCBldGMuXG4gIC8vIHVubGVzcyB0aGV5IGhhZCB0aGVtIHRvIGJlZ2luIHdpdGguXG4gIGlmICh0aGlzLnNsYXNoZXMgfHxcbiAgICAgICghcHJvdG9jb2wgfHwgc2xhc2hlZFByb3RvY29sW3Byb3RvY29sXSkgJiYgaG9zdCAhPT0gZmFsc2UpIHtcbiAgICBob3N0ID0gJy8vJyArIChob3N0IHx8ICcnKTtcbiAgICBpZiAocGF0aG5hbWUgJiYgcGF0aG5hbWUuY2hhckF0KDApICE9PSAnLycpIHBhdGhuYW1lID0gJy8nICsgcGF0aG5hbWU7XG4gIH0gZWxzZSBpZiAoIWhvc3QpIHtcbiAgICBob3N0ID0gJyc7XG4gIH1cblxuICBpZiAoaGFzaCAmJiBoYXNoLmNoYXJBdCgwKSAhPT0gJyMnKSBoYXNoID0gJyMnICsgaGFzaDtcbiAgaWYgKHNlYXJjaCAmJiBzZWFyY2guY2hhckF0KDApICE9PSAnPycpIHNlYXJjaCA9ICc/JyArIHNlYXJjaDtcblxuICBwYXRobmFtZSA9IHBhdGhuYW1lLnJlcGxhY2UoL1s/I10vZywgZnVuY3Rpb24obWF0Y2gpIHtcbiAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KG1hdGNoKTtcbiAgfSk7XG4gIHNlYXJjaCA9IHNlYXJjaC5yZXBsYWNlKCcjJywgJyUyMycpO1xuXG4gIHJldHVybiBwcm90b2NvbCArIGhvc3QgKyBwYXRobmFtZSArIHNlYXJjaCArIGhhc2g7XG59O1xuXG5mdW5jdGlvbiB1cmxSZXNvbHZlKHNvdXJjZSwgcmVsYXRpdmUpIHtcbiAgcmV0dXJuIHVybFBhcnNlKHNvdXJjZSwgZmFsc2UsIHRydWUpLnJlc29sdmUocmVsYXRpdmUpO1xufVxuXG5VcmwucHJvdG90eXBlLnJlc29sdmUgPSBmdW5jdGlvbihyZWxhdGl2ZSkge1xuICByZXR1cm4gdGhpcy5yZXNvbHZlT2JqZWN0KHVybFBhcnNlKHJlbGF0aXZlLCBmYWxzZSwgdHJ1ZSkpLmZvcm1hdCgpO1xufTtcblxuZnVuY3Rpb24gdXJsUmVzb2x2ZU9iamVjdChzb3VyY2UsIHJlbGF0aXZlKSB7XG4gIGlmICghc291cmNlKSByZXR1cm4gcmVsYXRpdmU7XG4gIHJldHVybiB1cmxQYXJzZShzb3VyY2UsIGZhbHNlLCB0cnVlKS5yZXNvbHZlT2JqZWN0KHJlbGF0aXZlKTtcbn1cblxuVXJsLnByb3RvdHlwZS5yZXNvbHZlT2JqZWN0ID0gZnVuY3Rpb24ocmVsYXRpdmUpIHtcbiAgaWYgKHV0aWwuaXNTdHJpbmcocmVsYXRpdmUpKSB7XG4gICAgdmFyIHJlbCA9IG5ldyBVcmwoKTtcbiAgICByZWwucGFyc2UocmVsYXRpdmUsIGZhbHNlLCB0cnVlKTtcbiAgICByZWxhdGl2ZSA9IHJlbDtcbiAgfVxuXG4gIHZhciByZXN1bHQgPSBuZXcgVXJsKCk7XG4gIHZhciB0a2V5cyA9IE9iamVjdC5rZXlzKHRoaXMpO1xuICBmb3IgKHZhciB0ayA9IDA7IHRrIDwgdGtleXMubGVuZ3RoOyB0aysrKSB7XG4gICAgdmFyIHRrZXkgPSB0a2V5c1t0a107XG4gICAgcmVzdWx0W3RrZXldID0gdGhpc1t0a2V5XTtcbiAgfVxuXG4gIC8vIGhhc2ggaXMgYWx3YXlzIG92ZXJyaWRkZW4sIG5vIG1hdHRlciB3aGF0LlxuICAvLyBldmVuIGhyZWY9XCJcIiB3aWxsIHJlbW92ZSBpdC5cbiAgcmVzdWx0Lmhhc2ggPSByZWxhdGl2ZS5oYXNoO1xuXG4gIC8vIGlmIHRoZSByZWxhdGl2ZSB1cmwgaXMgZW1wdHksIHRoZW4gdGhlcmUncyBub3RoaW5nIGxlZnQgdG8gZG8gaGVyZS5cbiAgaWYgKHJlbGF0aXZlLmhyZWYgPT09ICcnKSB7XG4gICAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8vIGhyZWZzIGxpa2UgLy9mb28vYmFyIGFsd2F5cyBjdXQgdG8gdGhlIHByb3RvY29sLlxuICBpZiAocmVsYXRpdmUuc2xhc2hlcyAmJiAhcmVsYXRpdmUucHJvdG9jb2wpIHtcbiAgICAvLyB0YWtlIGV2ZXJ5dGhpbmcgZXhjZXB0IHRoZSBwcm90b2NvbCBmcm9tIHJlbGF0aXZlXG4gICAgdmFyIHJrZXlzID0gT2JqZWN0LmtleXMocmVsYXRpdmUpO1xuICAgIGZvciAodmFyIHJrID0gMDsgcmsgPCBya2V5cy5sZW5ndGg7IHJrKyspIHtcbiAgICAgIHZhciBya2V5ID0gcmtleXNbcmtdO1xuICAgICAgaWYgKHJrZXkgIT09ICdwcm90b2NvbCcpXG4gICAgICAgIHJlc3VsdFtya2V5XSA9IHJlbGF0aXZlW3JrZXldO1xuICAgIH1cblxuICAgIC8vdXJsUGFyc2UgYXBwZW5kcyB0cmFpbGluZyAvIHRvIHVybHMgbGlrZSBodHRwOi8vd3d3LmV4YW1wbGUuY29tXG4gICAgaWYgKHNsYXNoZWRQcm90b2NvbFtyZXN1bHQucHJvdG9jb2xdICYmXG4gICAgICAgIHJlc3VsdC5ob3N0bmFtZSAmJiAhcmVzdWx0LnBhdGhuYW1lKSB7XG4gICAgICByZXN1bHQucGF0aCA9IHJlc3VsdC5wYXRobmFtZSA9ICcvJztcbiAgICB9XG5cbiAgICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgaWYgKHJlbGF0aXZlLnByb3RvY29sICYmIHJlbGF0aXZlLnByb3RvY29sICE9PSByZXN1bHQucHJvdG9jb2wpIHtcbiAgICAvLyBpZiBpdCdzIGEga25vd24gdXJsIHByb3RvY29sLCB0aGVuIGNoYW5naW5nXG4gICAgLy8gdGhlIHByb3RvY29sIGRvZXMgd2VpcmQgdGhpbmdzXG4gICAgLy8gZmlyc3QsIGlmIGl0J3Mgbm90IGZpbGU6LCB0aGVuIHdlIE1VU1QgaGF2ZSBhIGhvc3QsXG4gICAgLy8gYW5kIGlmIHRoZXJlIHdhcyBhIHBhdGhcbiAgICAvLyB0byBiZWdpbiB3aXRoLCB0aGVuIHdlIE1VU1QgaGF2ZSBhIHBhdGguXG4gICAgLy8gaWYgaXQgaXMgZmlsZTosIHRoZW4gdGhlIGhvc3QgaXMgZHJvcHBlZCxcbiAgICAvLyBiZWNhdXNlIHRoYXQncyBrbm93biB0byBiZSBob3N0bGVzcy5cbiAgICAvLyBhbnl0aGluZyBlbHNlIGlzIGFzc3VtZWQgdG8gYmUgYWJzb2x1dGUuXG4gICAgaWYgKCFzbGFzaGVkUHJvdG9jb2xbcmVsYXRpdmUucHJvdG9jb2xdKSB7XG4gICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHJlbGF0aXZlKTtcbiAgICAgIGZvciAodmFyIHYgPSAwOyB2IDwga2V5cy5sZW5ndGg7IHYrKykge1xuICAgICAgICB2YXIgayA9IGtleXNbdl07XG4gICAgICAgIHJlc3VsdFtrXSA9IHJlbGF0aXZlW2tdO1xuICAgICAgfVxuICAgICAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIHJlc3VsdC5wcm90b2NvbCA9IHJlbGF0aXZlLnByb3RvY29sO1xuICAgIGlmICghcmVsYXRpdmUuaG9zdCAmJiAhaG9zdGxlc3NQcm90b2NvbFtyZWxhdGl2ZS5wcm90b2NvbF0pIHtcbiAgICAgIHZhciByZWxQYXRoID0gKHJlbGF0aXZlLnBhdGhuYW1lIHx8ICcnKS5zcGxpdCgnLycpO1xuICAgICAgd2hpbGUgKHJlbFBhdGgubGVuZ3RoICYmICEocmVsYXRpdmUuaG9zdCA9IHJlbFBhdGguc2hpZnQoKSkpO1xuICAgICAgaWYgKCFyZWxhdGl2ZS5ob3N0KSByZWxhdGl2ZS5ob3N0ID0gJyc7XG4gICAgICBpZiAoIXJlbGF0aXZlLmhvc3RuYW1lKSByZWxhdGl2ZS5ob3N0bmFtZSA9ICcnO1xuICAgICAgaWYgKHJlbFBhdGhbMF0gIT09ICcnKSByZWxQYXRoLnVuc2hpZnQoJycpO1xuICAgICAgaWYgKHJlbFBhdGgubGVuZ3RoIDwgMikgcmVsUGF0aC51bnNoaWZ0KCcnKTtcbiAgICAgIHJlc3VsdC5wYXRobmFtZSA9IHJlbFBhdGguam9pbignLycpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHQucGF0aG5hbWUgPSByZWxhdGl2ZS5wYXRobmFtZTtcbiAgICB9XG4gICAgcmVzdWx0LnNlYXJjaCA9IHJlbGF0aXZlLnNlYXJjaDtcbiAgICByZXN1bHQucXVlcnkgPSByZWxhdGl2ZS5xdWVyeTtcbiAgICByZXN1bHQuaG9zdCA9IHJlbGF0aXZlLmhvc3QgfHwgJyc7XG4gICAgcmVzdWx0LmF1dGggPSByZWxhdGl2ZS5hdXRoO1xuICAgIHJlc3VsdC5ob3N0bmFtZSA9IHJlbGF0aXZlLmhvc3RuYW1lIHx8IHJlbGF0aXZlLmhvc3Q7XG4gICAgcmVzdWx0LnBvcnQgPSByZWxhdGl2ZS5wb3J0O1xuICAgIC8vIHRvIHN1cHBvcnQgaHR0cC5yZXF1ZXN0XG4gICAgaWYgKHJlc3VsdC5wYXRobmFtZSB8fCByZXN1bHQuc2VhcmNoKSB7XG4gICAgICB2YXIgcCA9IHJlc3VsdC5wYXRobmFtZSB8fCAnJztcbiAgICAgIHZhciBzID0gcmVzdWx0LnNlYXJjaCB8fCAnJztcbiAgICAgIHJlc3VsdC5wYXRoID0gcCArIHM7XG4gICAgfVxuICAgIHJlc3VsdC5zbGFzaGVzID0gcmVzdWx0LnNsYXNoZXMgfHwgcmVsYXRpdmUuc2xhc2hlcztcbiAgICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgdmFyIGlzU291cmNlQWJzID0gKHJlc3VsdC5wYXRobmFtZSAmJiByZXN1bHQucGF0aG5hbWUuY2hhckF0KDApID09PSAnLycpLFxuICAgICAgaXNSZWxBYnMgPSAoXG4gICAgICAgICAgcmVsYXRpdmUuaG9zdCB8fFxuICAgICAgICAgIHJlbGF0aXZlLnBhdGhuYW1lICYmIHJlbGF0aXZlLnBhdGhuYW1lLmNoYXJBdCgwKSA9PT0gJy8nXG4gICAgICApLFxuICAgICAgbXVzdEVuZEFicyA9IChpc1JlbEFicyB8fCBpc1NvdXJjZUFicyB8fFxuICAgICAgICAgICAgICAgICAgICAocmVzdWx0Lmhvc3QgJiYgcmVsYXRpdmUucGF0aG5hbWUpKSxcbiAgICAgIHJlbW92ZUFsbERvdHMgPSBtdXN0RW5kQWJzLFxuICAgICAgc3JjUGF0aCA9IHJlc3VsdC5wYXRobmFtZSAmJiByZXN1bHQucGF0aG5hbWUuc3BsaXQoJy8nKSB8fCBbXSxcbiAgICAgIHJlbFBhdGggPSByZWxhdGl2ZS5wYXRobmFtZSAmJiByZWxhdGl2ZS5wYXRobmFtZS5zcGxpdCgnLycpIHx8IFtdLFxuICAgICAgcHN5Y2hvdGljID0gcmVzdWx0LnByb3RvY29sICYmICFzbGFzaGVkUHJvdG9jb2xbcmVzdWx0LnByb3RvY29sXTtcblxuICAvLyBpZiB0aGUgdXJsIGlzIGEgbm9uLXNsYXNoZWQgdXJsLCB0aGVuIHJlbGF0aXZlXG4gIC8vIGxpbmtzIGxpa2UgLi4vLi4gc2hvdWxkIGJlIGFibGVcbiAgLy8gdG8gY3Jhd2wgdXAgdG8gdGhlIGhvc3RuYW1lLCBhcyB3ZWxsLiAgVGhpcyBpcyBzdHJhbmdlLlxuICAvLyByZXN1bHQucHJvdG9jb2wgaGFzIGFscmVhZHkgYmVlbiBzZXQgYnkgbm93LlxuICAvLyBMYXRlciBvbiwgcHV0IHRoZSBmaXJzdCBwYXRoIHBhcnQgaW50byB0aGUgaG9zdCBmaWVsZC5cbiAgaWYgKHBzeWNob3RpYykge1xuICAgIHJlc3VsdC5ob3N0bmFtZSA9ICcnO1xuICAgIHJlc3VsdC5wb3J0ID0gbnVsbDtcbiAgICBpZiAocmVzdWx0Lmhvc3QpIHtcbiAgICAgIGlmIChzcmNQYXRoWzBdID09PSAnJykgc3JjUGF0aFswXSA9IHJlc3VsdC5ob3N0O1xuICAgICAgZWxzZSBzcmNQYXRoLnVuc2hpZnQocmVzdWx0Lmhvc3QpO1xuICAgIH1cbiAgICByZXN1bHQuaG9zdCA9ICcnO1xuICAgIGlmIChyZWxhdGl2ZS5wcm90b2NvbCkge1xuICAgICAgcmVsYXRpdmUuaG9zdG5hbWUgPSBudWxsO1xuICAgICAgcmVsYXRpdmUucG9ydCA9IG51bGw7XG4gICAgICBpZiAocmVsYXRpdmUuaG9zdCkge1xuICAgICAgICBpZiAocmVsUGF0aFswXSA9PT0gJycpIHJlbFBhdGhbMF0gPSByZWxhdGl2ZS5ob3N0O1xuICAgICAgICBlbHNlIHJlbFBhdGgudW5zaGlmdChyZWxhdGl2ZS5ob3N0KTtcbiAgICAgIH1cbiAgICAgIHJlbGF0aXZlLmhvc3QgPSBudWxsO1xuICAgIH1cbiAgICBtdXN0RW5kQWJzID0gbXVzdEVuZEFicyAmJiAocmVsUGF0aFswXSA9PT0gJycgfHwgc3JjUGF0aFswXSA9PT0gJycpO1xuICB9XG5cbiAgaWYgKGlzUmVsQWJzKSB7XG4gICAgLy8gaXQncyBhYnNvbHV0ZS5cbiAgICByZXN1bHQuaG9zdCA9IChyZWxhdGl2ZS5ob3N0IHx8IHJlbGF0aXZlLmhvc3QgPT09ICcnKSA/XG4gICAgICAgICAgICAgICAgICByZWxhdGl2ZS5ob3N0IDogcmVzdWx0Lmhvc3Q7XG4gICAgcmVzdWx0Lmhvc3RuYW1lID0gKHJlbGF0aXZlLmhvc3RuYW1lIHx8IHJlbGF0aXZlLmhvc3RuYW1lID09PSAnJykgP1xuICAgICAgICAgICAgICAgICAgICAgIHJlbGF0aXZlLmhvc3RuYW1lIDogcmVzdWx0Lmhvc3RuYW1lO1xuICAgIHJlc3VsdC5zZWFyY2ggPSByZWxhdGl2ZS5zZWFyY2g7XG4gICAgcmVzdWx0LnF1ZXJ5ID0gcmVsYXRpdmUucXVlcnk7XG4gICAgc3JjUGF0aCA9IHJlbFBhdGg7XG4gICAgLy8gZmFsbCB0aHJvdWdoIHRvIHRoZSBkb3QtaGFuZGxpbmcgYmVsb3cuXG4gIH0gZWxzZSBpZiAocmVsUGF0aC5sZW5ndGgpIHtcbiAgICAvLyBpdCdzIHJlbGF0aXZlXG4gICAgLy8gdGhyb3cgYXdheSB0aGUgZXhpc3RpbmcgZmlsZSwgYW5kIHRha2UgdGhlIG5ldyBwYXRoIGluc3RlYWQuXG4gICAgaWYgKCFzcmNQYXRoKSBzcmNQYXRoID0gW107XG4gICAgc3JjUGF0aC5wb3AoKTtcbiAgICBzcmNQYXRoID0gc3JjUGF0aC5jb25jYXQocmVsUGF0aCk7XG4gICAgcmVzdWx0LnNlYXJjaCA9IHJlbGF0aXZlLnNlYXJjaDtcbiAgICByZXN1bHQucXVlcnkgPSByZWxhdGl2ZS5xdWVyeTtcbiAgfSBlbHNlIGlmICghdXRpbC5pc051bGxPclVuZGVmaW5lZChyZWxhdGl2ZS5zZWFyY2gpKSB7XG4gICAgLy8ganVzdCBwdWxsIG91dCB0aGUgc2VhcmNoLlxuICAgIC8vIGxpa2UgaHJlZj0nP2ZvbycuXG4gICAgLy8gUHV0IHRoaXMgYWZ0ZXIgdGhlIG90aGVyIHR3byBjYXNlcyBiZWNhdXNlIGl0IHNpbXBsaWZpZXMgdGhlIGJvb2xlYW5zXG4gICAgaWYgKHBzeWNob3RpYykge1xuICAgICAgcmVzdWx0Lmhvc3RuYW1lID0gcmVzdWx0Lmhvc3QgPSBzcmNQYXRoLnNoaWZ0KCk7XG4gICAgICAvL29jY2F0aW9uYWx5IHRoZSBhdXRoIGNhbiBnZXQgc3R1Y2sgb25seSBpbiBob3N0XG4gICAgICAvL3RoaXMgZXNwZWNpYWxseSBoYXBwZW5zIGluIGNhc2VzIGxpa2VcbiAgICAgIC8vdXJsLnJlc29sdmVPYmplY3QoJ21haWx0bzpsb2NhbDFAZG9tYWluMScsICdsb2NhbDJAZG9tYWluMicpXG4gICAgICB2YXIgYXV0aEluSG9zdCA9IHJlc3VsdC5ob3N0ICYmIHJlc3VsdC5ob3N0LmluZGV4T2YoJ0AnKSA+IDAgP1xuICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuaG9zdC5zcGxpdCgnQCcpIDogZmFsc2U7XG4gICAgICBpZiAoYXV0aEluSG9zdCkge1xuICAgICAgICByZXN1bHQuYXV0aCA9IGF1dGhJbkhvc3Quc2hpZnQoKTtcbiAgICAgICAgcmVzdWx0Lmhvc3QgPSByZXN1bHQuaG9zdG5hbWUgPSBhdXRoSW5Ib3N0LnNoaWZ0KCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJlc3VsdC5zZWFyY2ggPSByZWxhdGl2ZS5zZWFyY2g7XG4gICAgcmVzdWx0LnF1ZXJ5ID0gcmVsYXRpdmUucXVlcnk7XG4gICAgLy90byBzdXBwb3J0IGh0dHAucmVxdWVzdFxuICAgIGlmICghdXRpbC5pc051bGwocmVzdWx0LnBhdGhuYW1lKSB8fCAhdXRpbC5pc051bGwocmVzdWx0LnNlYXJjaCkpIHtcbiAgICAgIHJlc3VsdC5wYXRoID0gKHJlc3VsdC5wYXRobmFtZSA/IHJlc3VsdC5wYXRobmFtZSA6ICcnKSArXG4gICAgICAgICAgICAgICAgICAgIChyZXN1bHQuc2VhcmNoID8gcmVzdWx0LnNlYXJjaCA6ICcnKTtcbiAgICB9XG4gICAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIGlmICghc3JjUGF0aC5sZW5ndGgpIHtcbiAgICAvLyBubyBwYXRoIGF0IGFsbC4gIGVhc3kuXG4gICAgLy8gd2UndmUgYWxyZWFkeSBoYW5kbGVkIHRoZSBvdGhlciBzdHVmZiBhYm92ZS5cbiAgICByZXN1bHQucGF0aG5hbWUgPSBudWxsO1xuICAgIC8vdG8gc3VwcG9ydCBodHRwLnJlcXVlc3RcbiAgICBpZiAocmVzdWx0LnNlYXJjaCkge1xuICAgICAgcmVzdWx0LnBhdGggPSAnLycgKyByZXN1bHQuc2VhcmNoO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHQucGF0aCA9IG51bGw7XG4gICAgfVxuICAgIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvLyBpZiBhIHVybCBFTkRzIGluIC4gb3IgLi4sIHRoZW4gaXQgbXVzdCBnZXQgYSB0cmFpbGluZyBzbGFzaC5cbiAgLy8gaG93ZXZlciwgaWYgaXQgZW5kcyBpbiBhbnl0aGluZyBlbHNlIG5vbi1zbGFzaHksXG4gIC8vIHRoZW4gaXQgbXVzdCBOT1QgZ2V0IGEgdHJhaWxpbmcgc2xhc2guXG4gIHZhciBsYXN0ID0gc3JjUGF0aC5zbGljZSgtMSlbMF07XG4gIHZhciBoYXNUcmFpbGluZ1NsYXNoID0gKFxuICAgICAgKHJlc3VsdC5ob3N0IHx8IHJlbGF0aXZlLmhvc3QgfHwgc3JjUGF0aC5sZW5ndGggPiAxKSAmJlxuICAgICAgKGxhc3QgPT09ICcuJyB8fCBsYXN0ID09PSAnLi4nKSB8fCBsYXN0ID09PSAnJyk7XG5cbiAgLy8gc3RyaXAgc2luZ2xlIGRvdHMsIHJlc29sdmUgZG91YmxlIGRvdHMgdG8gcGFyZW50IGRpclxuICAvLyBpZiB0aGUgcGF0aCB0cmllcyB0byBnbyBhYm92ZSB0aGUgcm9vdCwgYHVwYCBlbmRzIHVwID4gMFxuICB2YXIgdXAgPSAwO1xuICBmb3IgKHZhciBpID0gc3JjUGF0aC5sZW5ndGg7IGkgPj0gMDsgaS0tKSB7XG4gICAgbGFzdCA9IHNyY1BhdGhbaV07XG4gICAgaWYgKGxhc3QgPT09ICcuJykge1xuICAgICAgc3JjUGF0aC5zcGxpY2UoaSwgMSk7XG4gICAgfSBlbHNlIGlmIChsYXN0ID09PSAnLi4nKSB7XG4gICAgICBzcmNQYXRoLnNwbGljZShpLCAxKTtcbiAgICAgIHVwKys7XG4gICAgfSBlbHNlIGlmICh1cCkge1xuICAgICAgc3JjUGF0aC5zcGxpY2UoaSwgMSk7XG4gICAgICB1cC0tO1xuICAgIH1cbiAgfVxuXG4gIC8vIGlmIHRoZSBwYXRoIGlzIGFsbG93ZWQgdG8gZ28gYWJvdmUgdGhlIHJvb3QsIHJlc3RvcmUgbGVhZGluZyAuLnNcbiAgaWYgKCFtdXN0RW5kQWJzICYmICFyZW1vdmVBbGxEb3RzKSB7XG4gICAgZm9yICg7IHVwLS07IHVwKSB7XG4gICAgICBzcmNQYXRoLnVuc2hpZnQoJy4uJyk7XG4gICAgfVxuICB9XG5cbiAgaWYgKG11c3RFbmRBYnMgJiYgc3JjUGF0aFswXSAhPT0gJycgJiZcbiAgICAgICghc3JjUGF0aFswXSB8fCBzcmNQYXRoWzBdLmNoYXJBdCgwKSAhPT0gJy8nKSkge1xuICAgIHNyY1BhdGgudW5zaGlmdCgnJyk7XG4gIH1cblxuICBpZiAoaGFzVHJhaWxpbmdTbGFzaCAmJiAoc3JjUGF0aC5qb2luKCcvJykuc3Vic3RyKC0xKSAhPT0gJy8nKSkge1xuICAgIHNyY1BhdGgucHVzaCgnJyk7XG4gIH1cblxuICB2YXIgaXNBYnNvbHV0ZSA9IHNyY1BhdGhbMF0gPT09ICcnIHx8XG4gICAgICAoc3JjUGF0aFswXSAmJiBzcmNQYXRoWzBdLmNoYXJBdCgwKSA9PT0gJy8nKTtcblxuICAvLyBwdXQgdGhlIGhvc3QgYmFja1xuICBpZiAocHN5Y2hvdGljKSB7XG4gICAgcmVzdWx0Lmhvc3RuYW1lID0gcmVzdWx0Lmhvc3QgPSBpc0Fic29sdXRlID8gJycgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjUGF0aC5sZW5ndGggPyBzcmNQYXRoLnNoaWZ0KCkgOiAnJztcbiAgICAvL29jY2F0aW9uYWx5IHRoZSBhdXRoIGNhbiBnZXQgc3R1Y2sgb25seSBpbiBob3N0XG4gICAgLy90aGlzIGVzcGVjaWFsbHkgaGFwcGVucyBpbiBjYXNlcyBsaWtlXG4gICAgLy91cmwucmVzb2x2ZU9iamVjdCgnbWFpbHRvOmxvY2FsMUBkb21haW4xJywgJ2xvY2FsMkBkb21haW4yJylcbiAgICB2YXIgYXV0aEluSG9zdCA9IHJlc3VsdC5ob3N0ICYmIHJlc3VsdC5ob3N0LmluZGV4T2YoJ0AnKSA+IDAgP1xuICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Lmhvc3Quc3BsaXQoJ0AnKSA6IGZhbHNlO1xuICAgIGlmIChhdXRoSW5Ib3N0KSB7XG4gICAgICByZXN1bHQuYXV0aCA9IGF1dGhJbkhvc3Quc2hpZnQoKTtcbiAgICAgIHJlc3VsdC5ob3N0ID0gcmVzdWx0Lmhvc3RuYW1lID0gYXV0aEluSG9zdC5zaGlmdCgpO1xuICAgIH1cbiAgfVxuXG4gIG11c3RFbmRBYnMgPSBtdXN0RW5kQWJzIHx8IChyZXN1bHQuaG9zdCAmJiBzcmNQYXRoLmxlbmd0aCk7XG5cbiAgaWYgKG11c3RFbmRBYnMgJiYgIWlzQWJzb2x1dGUpIHtcbiAgICBzcmNQYXRoLnVuc2hpZnQoJycpO1xuICB9XG5cbiAgaWYgKCFzcmNQYXRoLmxlbmd0aCkge1xuICAgIHJlc3VsdC5wYXRobmFtZSA9IG51bGw7XG4gICAgcmVzdWx0LnBhdGggPSBudWxsO1xuICB9IGVsc2Uge1xuICAgIHJlc3VsdC5wYXRobmFtZSA9IHNyY1BhdGguam9pbignLycpO1xuICB9XG5cbiAgLy90byBzdXBwb3J0IHJlcXVlc3QuaHR0cFxuICBpZiAoIXV0aWwuaXNOdWxsKHJlc3VsdC5wYXRobmFtZSkgfHwgIXV0aWwuaXNOdWxsKHJlc3VsdC5zZWFyY2gpKSB7XG4gICAgcmVzdWx0LnBhdGggPSAocmVzdWx0LnBhdGhuYW1lID8gcmVzdWx0LnBhdGhuYW1lIDogJycpICtcbiAgICAgICAgICAgICAgICAgIChyZXN1bHQuc2VhcmNoID8gcmVzdWx0LnNlYXJjaCA6ICcnKTtcbiAgfVxuICByZXN1bHQuYXV0aCA9IHJlbGF0aXZlLmF1dGggfHwgcmVzdWx0LmF1dGg7XG4gIHJlc3VsdC5zbGFzaGVzID0gcmVzdWx0LnNsYXNoZXMgfHwgcmVsYXRpdmUuc2xhc2hlcztcbiAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5VcmwucHJvdG90eXBlLnBhcnNlSG9zdCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcbiAgdmFyIHBvcnQgPSBwb3J0UGF0dGVybi5leGVjKGhvc3QpO1xuICBpZiAocG9ydCkge1xuICAgIHBvcnQgPSBwb3J0WzBdO1xuICAgIGlmIChwb3J0ICE9PSAnOicpIHtcbiAgICAgIHRoaXMucG9ydCA9IHBvcnQuc3Vic3RyKDEpO1xuICAgIH1cbiAgICBob3N0ID0gaG9zdC5zdWJzdHIoMCwgaG9zdC5sZW5ndGggLSBwb3J0Lmxlbmd0aCk7XG4gIH1cbiAgaWYgKGhvc3QpIHRoaXMuaG9zdG5hbWUgPSBob3N0O1xufTtcblxufSx7XCIuL3V0aWxcIjo2LFwicHVueWNvZGVcIjoxLFwicXVlcnlzdHJpbmdcIjo0fV0sNjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBpc1N0cmluZzogZnVuY3Rpb24oYXJnKSB7XG4gICAgcmV0dXJuIHR5cGVvZihhcmcpID09PSAnc3RyaW5nJztcbiAgfSxcbiAgaXNPYmplY3Q6IGZ1bmN0aW9uKGFyZykge1xuICAgIHJldHVybiB0eXBlb2YoYXJnKSA9PT0gJ29iamVjdCcgJiYgYXJnICE9PSBudWxsO1xuICB9LFxuICBpc051bGw6IGZ1bmN0aW9uKGFyZykge1xuICAgIHJldHVybiBhcmcgPT09IG51bGw7XG4gIH0sXG4gIGlzTnVsbE9yVW5kZWZpbmVkOiBmdW5jdGlvbihhcmcpIHtcbiAgICByZXR1cm4gYXJnID09IG51bGw7XG4gIH1cbn07XG5cbn0se31dLDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxudmFyIHRoaW5nX2Rlc2NyaXB0aW9uXzEgPSByZXF1aXJlKFwiLi90aGluZy1kZXNjcmlwdGlvblwiKTtcclxudmFyIFREID0gcmVxdWlyZShcIi4vdGhpbmctZGVzY3JpcHRpb25cIik7XHJcbnZhciB0eXBlZGpzb25fbnBtXzEgPSByZXF1aXJlKFwidHlwZWRqc29uLW5wbVwiKTtcclxuZnVuY3Rpb24gcGFyc2VURE9iamVjdCh0ZCkge1xyXG4gICAgcmV0dXJuIHBhcnNlVERTdHJpbmcodHlwZWRqc29uX25wbV8xLlR5cGVkSlNPTi5zdHJpbmdpZnkodGQsIHsgZW5hYmxlVHlwZUhpbnRzOiBmYWxzZSB9KSk7XHJcbn1cclxuZXhwb3J0cy5wYXJzZVRET2JqZWN0ID0gcGFyc2VURE9iamVjdDtcclxuZnVuY3Rpb24gcGFyc2VURFN0cmluZyhqc29uKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcInBhcnNlVERTdHJpbmcoKSBwYXJzaW5nXFxuYGBgXFxuXCIgKyBqc29uICsgXCJcXG5gYGBcIik7XHJcbiAgICB2YXIgdGQgPSB0eXBlZGpzb25fbnBtXzEuVHlwZWRKU09OLnBhcnNlKGpzb24sIHRoaW5nX2Rlc2NyaXB0aW9uXzEuZGVmYXVsdCk7XHJcbiAgICBjb25zb2xlLmxvZyhcInBhcnNlVERTdHJpbmcoKSBmb3VuZCBcIiArIHRkLmludGVyYWN0aW9uLmxlbmd0aCArIFwiIEludGVyYWN0aW9uXCIgKyAodGQuaW50ZXJhY3Rpb24ubGVuZ3RoID09PSAxID8gJycgOiAncycpKTtcclxuICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0ZC5pbnRlcmFjdGlvbjsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICB2YXIgaW50ZXJhY3Rpb24gPSBfYVtfaV07XHJcbiAgICAgICAgaWYgKGludGVyYWN0aW9uLnNlbWFudGljVHlwZXMuaW5kZXhPZihURC5JbnRlcmFjdGlvblBhdHRlcm4uUHJvcGVydHkudG9TdHJpbmcoKSkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiICogUHJvcGVydHkgJ1wiICsgaW50ZXJhY3Rpb24ubmFtZSArIFwiJ1wiKTtcclxuICAgICAgICAgICAgaW50ZXJhY3Rpb24ucGF0dGVybiA9IFRELkludGVyYWN0aW9uUGF0dGVybi5Qcm9wZXJ0eTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaW50ZXJhY3Rpb24uc2VtYW50aWNUeXBlcy5pbmRleE9mKFRELkludGVyYWN0aW9uUGF0dGVybi5BY3Rpb24udG9TdHJpbmcoKSkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiICogQWN0aW9uICdcIiArIGludGVyYWN0aW9uLm5hbWUgKyBcIidcIik7XHJcbiAgICAgICAgICAgIGludGVyYWN0aW9uLnBhdHRlcm4gPSBURC5JbnRlcmFjdGlvblBhdHRlcm4uQWN0aW9uO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChpbnRlcmFjdGlvbi5zZW1hbnRpY1R5cGVzLmluZGV4T2YoVEQuSW50ZXJhY3Rpb25QYXR0ZXJuLkV2ZW50LnRvU3RyaW5nKCkpICE9PSAtMSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIiAqIEV2ZW50ICdcIiArIGludGVyYWN0aW9uLm5hbWUgKyBcIidcIik7XHJcbiAgICAgICAgICAgIGludGVyYWN0aW9uLnBhdHRlcm4gPSBURC5JbnRlcmFjdGlvblBhdHRlcm4uRXZlbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwicGFyc2VURFN0cmluZygpIGZvdW5kIHVua25vd24gSW50ZXJhY3Rpb24gcGF0dGVybiAnXCIgKyBpbnRlcmFjdGlvbi5zZW1hbnRpY1R5cGVzICsgXCInXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGQuYmFzZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGFyc2VURFN0cmluZygpIGFwcGx5aW5nIGJhc2UgJ1wiICsgdGQuYmFzZSArIFwiJyB0byBocmVmICdcIiArIGludGVyYWN0aW9uLmxpbmtbMF0uaHJlZiArIFwiJ1wiKTtcclxuICAgICAgICAgICAgdmFyIGhyZWYgPSBpbnRlcmFjdGlvbi5saW5rWzBdLmhyZWY7XHJcbiAgICAgICAgICAgIHZhciB1cmwgPSByZXF1aXJlKCd1cmwnKTtcclxuICAgICAgICAgICAgdmFyIG4gPSB0ZC5iYXNlLmluZGV4T2YoJzonKTtcclxuICAgICAgICAgICAgdmFyIHByID0gdGQuYmFzZS5zdWJzdHIoMCwgbiArIDEpO1xyXG4gICAgICAgICAgICB2YXIgdXJpVGVtcCA9IHRkLmJhc2UucmVwbGFjZShwciwgJ2h0dHA6Jyk7XHJcbiAgICAgICAgICAgIHVyaVRlbXAgPSB1cmwucmVzb2x2ZSh1cmlUZW1wLCBocmVmKTtcclxuICAgICAgICAgICAgdXJpVGVtcCA9IHVyaVRlbXAucmVwbGFjZSgnaHR0cDonLCBwcik7XHJcbiAgICAgICAgICAgIGludGVyYWN0aW9uLmxpbmtbMF0uaHJlZiA9IHVyaVRlbXA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRkO1xyXG59XHJcbmV4cG9ydHMucGFyc2VURFN0cmluZyA9IHBhcnNlVERTdHJpbmc7XHJcbmZ1bmN0aW9uIHNlcmlhbGl6ZVREKHRkKSB7XHJcbiAgICB0eXBlZGpzb25fbnBtXzEuVHlwZWRKU09OLmNvbmZpZyh7IFwiZW5hYmxlVHlwZUhpbnRzXCI6IGZhbHNlIH0pO1xyXG4gICAgdmFyIGpzb24gPSB0eXBlZGpzb25fbnBtXzEuVHlwZWRKU09OLnN0cmluZ2lmeSh0ZCk7XHJcbiAgICB2YXIgcmF3ID0gSlNPTi5wYXJzZShqc29uKTtcclxuICAgIGlmICh0ZC5iYXNlID09PSBudWxsIHx8IHRkLmJhc2UgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGRlbGV0ZSByYXcuYmFzZTtcclxuICAgIH1cclxuICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSByYXcuaW50ZXJhY3Rpb247IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgdmFyIGludGVyYWN0aW9uID0gX2FbX2ldO1xyXG4gICAgICAgIGlmIChpbnRlcmFjdGlvbi5pbnB1dERhdGEgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgZGVsZXRlIGludGVyYWN0aW9uLmlucHV0RGF0YTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGludGVyYWN0aW9uLm91dHB1dERhdGEgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgZGVsZXRlIGludGVyYWN0aW9uLm91dHB1dERhdGE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpbnRlcmFjdGlvbi53cml0YWJsZSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICBkZWxldGUgaW50ZXJhY3Rpb24ud3JpdGFibGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpbnRlcmFjdGlvbi5vdXRwdXREYXRhICYmIGludGVyYWN0aW9uLm91dHB1dERhdGEucmVxdWlyZWQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIiMjIyBIT1RGSVggZm9yIFR5cGVkSlNPTiAjIyNcIik7XHJcbiAgICAgICAgICAgIHZhciByZXFzID0gW107XHJcbiAgICAgICAgICAgIGZvciAodmFyIHJlcSBpbiBpbnRlcmFjdGlvbi5vdXRwdXREYXRhLnJlcXVpcmVkKVxyXG4gICAgICAgICAgICAgICAgcmVxcy5wdXNoKGludGVyYWN0aW9uLm91dHB1dERhdGEucmVxdWlyZWRbcmVxXSk7XHJcbiAgICAgICAgICAgIGludGVyYWN0aW9uLm91dHB1dERhdGEucmVxdWlyZWQgPSByZXFzO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGpzb24gPSBKU09OLnN0cmluZ2lmeShyYXcpO1xyXG4gICAgY29uc29sZS5sb2coXCJzZXJpYWxpemVURCgpIHByb2R1Y2VkXFxuYGBgXFxuXCIgKyBqc29uICsgXCJcXG5gYGBcIik7XHJcbiAgICByZXR1cm4ganNvbjtcclxufVxyXG5leHBvcnRzLnNlcmlhbGl6ZVREID0gc2VyaWFsaXplVEQ7XHJcblxufSx7XCIuL3RoaW5nLWRlc2NyaXB0aW9uXCI6OCxcInR5cGVkanNvbi1ucG1cIjo5LFwidXJsXCI6NX1dLDg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBfX2RlY29yYXRlID0gKHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlKSB8fCBmdW5jdGlvbiAoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn07XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxudmFyIHR5cGVkanNvbl9ucG1fMSA9IHJlcXVpcmUoXCJ0eXBlZGpzb24tbnBtXCIpO1xyXG52YXIgSW50ZXJhY3Rpb25QYXR0ZXJuO1xyXG4oZnVuY3Rpb24gKEludGVyYWN0aW9uUGF0dGVybikge1xyXG4gICAgSW50ZXJhY3Rpb25QYXR0ZXJuW0ludGVyYWN0aW9uUGF0dGVybltcIlByb3BlcnR5XCJdID0gJ1Byb3BlcnR5J10gPSBcIlByb3BlcnR5XCI7XHJcbiAgICBJbnRlcmFjdGlvblBhdHRlcm5bSW50ZXJhY3Rpb25QYXR0ZXJuW1wiQWN0aW9uXCJdID0gJ0FjdGlvbiddID0gXCJBY3Rpb25cIjtcclxuICAgIEludGVyYWN0aW9uUGF0dGVybltJbnRlcmFjdGlvblBhdHRlcm5bXCJFdmVudFwiXSA9ICdFdmVudCddID0gXCJFdmVudFwiO1xyXG59KShJbnRlcmFjdGlvblBhdHRlcm4gPSBleHBvcnRzLkludGVyYWN0aW9uUGF0dGVybiB8fCAoZXhwb3J0cy5JbnRlcmFjdGlvblBhdHRlcm4gPSB7fSkpO1xyXG52YXIgSW50ZXJhY3Rpb25MaW5rID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEludGVyYWN0aW9uTGluaygpIHtcclxuICAgIH1cclxuICAgIHJldHVybiBJbnRlcmFjdGlvbkxpbms7XHJcbn0oKSk7XHJcbl9fZGVjb3JhdGUoW1xyXG4gICAgdHlwZWRqc29uX25wbV8xLkpzb25NZW1iZXIoeyBpc1JlcXVpcmVkOiB0cnVlLCB0eXBlOiBTdHJpbmcgfSlcclxuXSwgSW50ZXJhY3Rpb25MaW5rLnByb3RvdHlwZSwgXCJocmVmXCIsIHZvaWQgMCk7XHJcbl9fZGVjb3JhdGUoW1xyXG4gICAgdHlwZWRqc29uX25wbV8xLkpzb25NZW1iZXIoeyBpc1JlcXVpcmVkOiB0cnVlLCB0eXBlOiBTdHJpbmcgfSlcclxuXSwgSW50ZXJhY3Rpb25MaW5rLnByb3RvdHlwZSwgXCJtZWRpYVR5cGVcIiwgdm9pZCAwKTtcclxuSW50ZXJhY3Rpb25MaW5rID0gX19kZWNvcmF0ZShbXHJcbiAgICB0eXBlZGpzb25fbnBtXzEuSnNvbk9iamVjdCgpXHJcbl0sIEludGVyYWN0aW9uTGluayk7XHJcbmV4cG9ydHMuSW50ZXJhY3Rpb25MaW5rID0gSW50ZXJhY3Rpb25MaW5rO1xyXG52YXIgSW50ZXJhY3Rpb24gPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gSW50ZXJhY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5zZW1hbnRpY1R5cGVzID0gW107XHJcbiAgICAgICAgdGhpcy5saW5rID0gW107XHJcbiAgICB9XHJcbiAgICByZXR1cm4gSW50ZXJhY3Rpb247XHJcbn0oKSk7XHJcbl9fZGVjb3JhdGUoW1xyXG4gICAgdHlwZWRqc29uX25wbV8xLkpzb25NZW1iZXIoeyBuYW1lOiAnQHR5cGUnLCBpc1JlcXVpcmVkOiB0cnVlLCBlbGVtZW50czogU3RyaW5nIH0pXHJcbl0sIEludGVyYWN0aW9uLnByb3RvdHlwZSwgXCJzZW1hbnRpY1R5cGVzXCIsIHZvaWQgMCk7XHJcbl9fZGVjb3JhdGUoW1xyXG4gICAgdHlwZWRqc29uX25wbV8xLkpzb25NZW1iZXIoeyBpc1JlcXVpcmVkOiB0cnVlLCB0eXBlOiBTdHJpbmcgfSlcclxuXSwgSW50ZXJhY3Rpb24ucHJvdG90eXBlLCBcIm5hbWVcIiwgdm9pZCAwKTtcclxuX19kZWNvcmF0ZShbXHJcbiAgICB0eXBlZGpzb25fbnBtXzEuSnNvbk1lbWJlcih7IGlzUmVxdWlyZWQ6IHRydWUsIGVsZW1lbnRzOiBJbnRlcmFjdGlvbkxpbmsgfSlcclxuXSwgSW50ZXJhY3Rpb24ucHJvdG90eXBlLCBcImxpbmtcIiwgdm9pZCAwKTtcclxuX19kZWNvcmF0ZShbXHJcbiAgICB0eXBlZGpzb25fbnBtXzEuSnNvbk1lbWJlcih7IHR5cGU6IEJvb2xlYW4gfSlcclxuXSwgSW50ZXJhY3Rpb24ucHJvdG90eXBlLCBcIndyaXRhYmxlXCIsIHZvaWQgMCk7XHJcbl9fZGVjb3JhdGUoW1xyXG4gICAgdHlwZWRqc29uX25wbV8xLkpzb25NZW1iZXIoeyB0eXBlOiBPYmplY3QgfSlcclxuXSwgSW50ZXJhY3Rpb24ucHJvdG90eXBlLCBcImlucHV0RGF0YVwiLCB2b2lkIDApO1xyXG5fX2RlY29yYXRlKFtcclxuICAgIHR5cGVkanNvbl9ucG1fMS5Kc29uTWVtYmVyKHsgdHlwZTogT2JqZWN0IH0pXHJcbl0sIEludGVyYWN0aW9uLnByb3RvdHlwZSwgXCJvdXRwdXREYXRhXCIsIHZvaWQgMCk7XHJcbkludGVyYWN0aW9uID0gX19kZWNvcmF0ZShbXHJcbiAgICB0eXBlZGpzb25fbnBtXzEuSnNvbk9iamVjdCh7IGtub3duVHlwZXM6IFtJbnRlcmFjdGlvbkxpbmtdIH0pXHJcbl0sIEludGVyYWN0aW9uKTtcclxuZXhwb3J0cy5JbnRlcmFjdGlvbiA9IEludGVyYWN0aW9uO1xyXG52YXIgVGhpbmdEZXNjcmlwdGlvbiA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBUaGluZ0Rlc2NyaXB0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuY29udGV4dCA9IFsnaHR0cDovL3czYy5naXRodWIuaW8vd290L3czYy13b3QtdGQtY29udGV4dC5qc29ubGQnXTtcclxuICAgICAgICB0aGlzLnNlbWFudGljVHlwZSA9IFsnVGhpbmcnXTtcclxuICAgICAgICB0aGlzLmludGVyYWN0aW9uID0gW107XHJcbiAgICB9XHJcbiAgICByZXR1cm4gVGhpbmdEZXNjcmlwdGlvbjtcclxufSgpKTtcclxuX19kZWNvcmF0ZShbXHJcbiAgICB0eXBlZGpzb25fbnBtXzEuSnNvbk1lbWJlcih7IG5hbWU6ICdAdHlwZScsIGVsZW1lbnRzOiBTdHJpbmcgfSlcclxuXSwgVGhpbmdEZXNjcmlwdGlvbi5wcm90b3R5cGUsIFwic2VtYW50aWNUeXBlXCIsIHZvaWQgMCk7XHJcbl9fZGVjb3JhdGUoW1xyXG4gICAgdHlwZWRqc29uX25wbV8xLkpzb25NZW1iZXIoeyBpc1JlcXVpcmVkOiB0cnVlLCB0eXBlOiBTdHJpbmcgfSlcclxuXSwgVGhpbmdEZXNjcmlwdGlvbi5wcm90b3R5cGUsIFwibmFtZVwiLCB2b2lkIDApO1xyXG5fX2RlY29yYXRlKFtcclxuICAgIHR5cGVkanNvbl9ucG1fMS5Kc29uTWVtYmVyKHsgdHlwZTogU3RyaW5nIH0pXHJcbl0sIFRoaW5nRGVzY3JpcHRpb24ucHJvdG90eXBlLCBcImJhc2VcIiwgdm9pZCAwKTtcclxuX19kZWNvcmF0ZShbXHJcbiAgICB0eXBlZGpzb25fbnBtXzEuSnNvbk1lbWJlcih7IGlzUmVxdWlyZWQ6IHRydWUsIGVsZW1lbnRzOiBJbnRlcmFjdGlvbiB9KVxyXG5dLCBUaGluZ0Rlc2NyaXB0aW9uLnByb3RvdHlwZSwgXCJpbnRlcmFjdGlvblwiLCB2b2lkIDApO1xyXG5fX2RlY29yYXRlKFtcclxuICAgIHR5cGVkanNvbl9ucG1fMS5Kc29uTWVtYmVyKHsgbmFtZTogJ0Bjb250ZXh0JywgZWxlbWVudHM6IFN0cmluZyB9KVxyXG5dLCBUaGluZ0Rlc2NyaXB0aW9uLnByb3RvdHlwZSwgXCJjb250ZXh0XCIsIHZvaWQgMCk7XHJcblRoaW5nRGVzY3JpcHRpb24gPSBfX2RlY29yYXRlKFtcclxuICAgIHR5cGVkanNvbl9ucG1fMS5Kc29uT2JqZWN0KHsga25vd25UeXBlczogW0ludGVyYWN0aW9uXSB9KVxyXG5dLCBUaGluZ0Rlc2NyaXB0aW9uKTtcclxuZXhwb3J0cy5kZWZhdWx0ID0gVGhpbmdEZXNjcmlwdGlvbjtcclxuXG59LHtcInR5cGVkanNvbi1ucG1cIjo5fV0sOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4vKiFcblR5cGVkSlNPTiB2MC4yLjAgLSBodHRwczovL2dpdGh1Yi5jb20vSm9obldoaXRlVEIvVHlwZWRKU09OXG5cblR5cGVkIEpTT04gcGFyc2luZyBhbmQgc2VyaWFsaXppbmcgdGhhdCBwcmVzZXJ2ZXMgdHlwZSBpbmZvcm1hdGlvbi4gUGFyc2UgSlNPTiBpbnRvIGFjdHVhbCBjbGFzcyBpbnN0YW5jZXMuIFJlY29tbWVuZGVkIChidXQgbm90IHJlcXVpcmVkKVxudG8gYmUgdXNlZCB3aXRoIHJlZmxlY3QtbWV0YWRhdGEgKGdsb2JhbCBpbnN0YWxsYXRpb24pOiBodHRwczovL2dpdGh1Yi5jb20vcmJ1Y2t0b24vUmVmbGVjdERlY29yYXRvcnMuXG5cblxuVGhlIE1JVCBMaWNlbnNlIChNSVQpXG5Db3B5cmlnaHQgKGMpIDIwMTYgSm9obiBXaGl0ZVxuXG5QZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlXG5cIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0b1xudGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuXG5UaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cblxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GXG5NRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZXG5DTEFJTSwgREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRVxuU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG4qL1xuKGZ1bmN0aW9uIChmYWN0b3J5KSB7XG4gICAgaWYgKHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUuZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgdmFyIHYgPSBmYWN0b3J5KHJlcXVpcmUsIGV4cG9ydHMpOyBpZiAodiAhPT0gdW5kZWZpbmVkKSBtb2R1bGUuZXhwb3J0cyA9IHY7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgICAgICBkZWZpbmUoW1wicmVxdWlyZVwiLCBcImV4cG9ydHNcIl0sIGZhY3RvcnkpO1xuICAgIH1cbn0pKGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgdmFyIE1FVEFEQVRBX0ZJRUxEX0tFWSA9IFwiX190eXBlZEpzb25Kc29uT2JqZWN0TWV0YWRhdGFJbmZvcm1hdGlvbl9fXCI7XG4gICAgdmFyIEpTT047XG4gICAgaWYgKCFKU09OKSB7XG4gICAgICAgIEpTT04gPSB7XG4gICAgICAgICAgICBwYXJzZTogZnVuY3Rpb24gKHNKU09OKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJldHVybnZhbCA9IHNKU09OO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmV0dXJudmFsID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmV0dXJudmFsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGV2YWwoJygnICsgc0pTT04gKyAnKScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdHJpbmdpZnk6IChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcbiAgICAgICAgICAgICAgICB2YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHRvU3RyaW5nLmNhbGwoYSkgPT09ICdbb2JqZWN0IEFycmF5XSc7IH07XG4gICAgICAgICAgICAgICAgdmFyIGVzY01hcCA9IHsgJ1wiJzogJ1xcXFxcIicsICdcXFxcJzogJ1xcXFxcXFxcJywgJ1xcYic6ICdcXFxcYicsICdcXGYnOiAnXFxcXGYnLCAnXFxuJzogJ1xcXFxuJywgJ1xccic6ICdcXFxccicsICdcXHQnOiAnXFxcXHQnIH07XG4gICAgICAgICAgICAgICAgdmFyIGVzY0Z1bmMgPSBmdW5jdGlvbiAobSkgeyByZXR1cm4gZXNjTWFwW21dIHx8ICdcXFxcdScgKyAobS5jaGFyQ29kZUF0KDApICsgMHgxMDAwMCkudG9TdHJpbmcoMTYpLnN1YnN0cigxKTsgfTtcbiAgICAgICAgICAgICAgICB2YXIgZXNjUkUgPSAvW1xcXFxcIlxcdTAwMDAtXFx1MDAxRlxcdTIwMjhcXHUyMDI5XS9nO1xuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBzdHJpbmdpZnkodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnbnVsbCc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzRmluaXRlKHZhbHVlKSA/IHZhbHVlLnRvU3RyaW5nKCkgOiAnbnVsbCc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUudG9KU09OID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0cmluZ2lmeSh2YWx1ZS50b0pTT04oKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSAnWyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWx1ZS5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzICs9IChpID8gJywgJyA6ICcnKSArIHN0cmluZ2lmeSh2YWx1ZVtpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcyArICddJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRvU3RyaW5nLmNhbGwodmFsdWUpID09PSAnW29iamVjdCBPYmplY3RdJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0bXAgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrIGluIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5oYXNPd25Qcm9wZXJ0eShrKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcC5wdXNoKHN0cmluZ2lmeShrKSArICc6ICcgKyBzdHJpbmdpZnkodmFsdWVba10pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICd7JyArIHRtcC5qb2luKCcsICcpICsgJ30nO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnXCInICsgdmFsdWUudG9TdHJpbmcoKS5yZXBsYWNlKGVzY1JFLCBlc2NGdW5jKSArICdcIic7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pKClcbiAgICAgICAgfTtcbiAgICB9XG4gICAgdmFyIEhlbHBlcnM7XG4gICAgKGZ1bmN0aW9uIChIZWxwZXJzKSB7XG4gICAgICAgIGZ1bmN0aW9uIGFzc2lnbih0YXJnZXQpIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2VzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIHNvdXJjZXNbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgb3V0cHV0O1xuICAgICAgICAgICAgdmFyIHNvdXJjZTtcbiAgICAgICAgICAgIGlmICh0YXJnZXQgPT09IHVuZGVmaW5lZCB8fCB0YXJnZXQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNvbnZlcnQgdW5kZWZpbmVkIG9yIG51bGwgdG8gb2JqZWN0XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0cHV0ID0gT2JqZWN0KHRhcmdldCk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICAgICAgICBpZiAoc291cmNlICE9PSB1bmRlZmluZWQgJiYgc291cmNlICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIG5leHRLZXkgaW4gc291cmNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlLmhhc093blByb3BlcnR5KG5leHRLZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0W25leHRLZXldID0gc291cmNlW25leHRLZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgfVxuICAgICAgICBIZWxwZXJzLmFzc2lnbiA9IGFzc2lnbjtcbiAgICAgICAgZnVuY3Rpb24gZXJyb3IobWVzc2FnZSkge1xuICAgICAgICAgICAgdmFyIG9wdGlvbmFsUGFyYW1zID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsUGFyYW1zW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBjb25zb2xlLmVycm9yID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yLmFwcGx5KGNvbnNvbGUsIFttZXNzYWdlXS5jb25jYXQob3B0aW9uYWxQYXJhbXMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBjb25zb2xlID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBjb25zb2xlLmxvZyA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgW1wiRVJST1I6IFwiICsgbWVzc2FnZV0uY29uY2F0KG9wdGlvbmFsUGFyYW1zKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgSGVscGVycy5lcnJvciA9IGVycm9yO1xuICAgICAgICBmdW5jdGlvbiBnZXRDbGFzc05hbWUodGFyZ2V0KSB7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0VHlwZTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdGFyZ2V0ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXRUeXBlID0gdGFyZ2V0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIHRhcmdldCA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgICAgIHRhcmdldFR5cGUgPSB0YXJnZXQuY29uc3RydWN0b3I7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRhcmdldFR5cGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJ1bmRlZmluZWRcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChcIm5hbWVcIiBpbiB0YXJnZXRUeXBlICYmIHR5cGVvZiB0YXJnZXRUeXBlLm5hbWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0VHlwZS5uYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldFR5cGUudG9TdHJpbmcoKS5tYXRjaCgvZnVuY3Rpb24gKFxcdyopLylbMV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgSGVscGVycy5nZXRDbGFzc05hbWUgPSBnZXRDbGFzc05hbWU7XG4gICAgICAgIGZ1bmN0aW9uIGdldERlZmF1bHRWYWx1ZSh0eXBlKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIE51bWJlcjpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgY2FzZSBTdHJpbmc6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICAgICAgICAgIGNhc2UgQm9vbGVhbjpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIGNhc2UgQXJyYXk6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBIZWxwZXJzLmdldERlZmF1bHRWYWx1ZSA9IGdldERlZmF1bHRWYWx1ZTtcbiAgICAgICAgZnVuY3Rpb24gZ2V0UHJvcGVydHlEaXNwbGF5TmFtZSh0YXJnZXQsIHByb3BlcnR5S2V5KSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0Q2xhc3NOYW1lKHRhcmdldCkgKyBcIi5cIiArIHByb3BlcnR5S2V5LnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgSGVscGVycy5nZXRQcm9wZXJ0eURpc3BsYXlOYW1lID0gZ2V0UHJvcGVydHlEaXNwbGF5TmFtZTtcbiAgICAgICAgZnVuY3Rpb24gaXNBcnJheShvYmplY3QpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgQXJyYXkuaXNBcnJheSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkob2JqZWN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChvYmplY3QgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgSGVscGVycy5pc0FycmF5ID0gaXNBcnJheTtcbiAgICAgICAgZnVuY3Rpb24gaXNQcmltaXRpdmUob2JqKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHR5cGVvZiBvYmopIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwic3RyaW5nXCI6XG4gICAgICAgICAgICAgICAgY2FzZSBcIm51bWJlclwiOlxuICAgICAgICAgICAgICAgIGNhc2UgXCJib29sZWFuXCI6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIFN0cmluZyB8fCBvYmogPT09IFN0cmluZyB8fFxuICAgICAgICAgICAgICAgIG9iaiBpbnN0YW5jZW9mIE51bWJlciB8fCBvYmogPT09IE51bWJlciB8fFxuICAgICAgICAgICAgICAgIG9iaiBpbnN0YW5jZW9mIEJvb2xlYW4gfHwgb2JqID09PSBCb29sZWFuKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgSGVscGVycy5pc1ByaW1pdGl2ZSA9IGlzUHJpbWl0aXZlO1xuICAgICAgICBmdW5jdGlvbiBpc1Jlc2VydmVkTWVtYmVyTmFtZShuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gKG5hbWUgPT09IE1FVEFEQVRBX0ZJRUxEX0tFWSk7XG4gICAgICAgIH1cbiAgICAgICAgSGVscGVycy5pc1Jlc2VydmVkTWVtYmVyTmFtZSA9IGlzUmVzZXJ2ZWRNZW1iZXJOYW1lO1xuICAgICAgICBmdW5jdGlvbiBpc1N1YnR5cGVPZihBLCBCKSB7XG4gICAgICAgICAgICB2YXIgYVByb3RvdHlwZSA9IEEucHJvdG90eXBlO1xuICAgICAgICAgICAgaWYgKEEgPT09IEIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdoaWxlIChhUHJvdG90eXBlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFQcm90b3R5cGUgaW5zdGFuY2VvZiBCKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhUHJvdG90eXBlID0gYVByb3RvdHlwZS5wcm90b3R5cGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgSGVscGVycy5pc1N1YnR5cGVPZiA9IGlzU3VidHlwZU9mO1xuICAgICAgICBmdW5jdGlvbiBsb2cobWVzc2FnZSkge1xuICAgICAgICAgICAgdmFyIG9wdGlvbmFsUGFyYW1zID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsUGFyYW1zW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBjb25zb2xlLmxvZyA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgW21lc3NhZ2VdLmNvbmNhdChvcHRpb25hbFBhcmFtcykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIEhlbHBlcnMubG9nID0gbG9nO1xuICAgICAgICBmdW5jdGlvbiBtZXJnZSh0YXJnZXQpIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2VzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIHNvdXJjZXNbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgb3V0cHV0O1xuICAgICAgICAgICAgdmFyIHNvdXJjZTtcbiAgICAgICAgICAgIGlmICh0YXJnZXQgPT09IHVuZGVmaW5lZCB8fCB0YXJnZXQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNvbnZlcnQgdW5kZWZpbmVkIG9yIG51bGwgdG8gb2JqZWN0XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0cHV0ID0ge307XG4gICAgICAgICAgICBPYmplY3Qua2V5cyh0YXJnZXQpLmZvckVhY2goZnVuY3Rpb24gKG5leHRLZXkpIHtcbiAgICAgICAgICAgICAgICBvdXRwdXRbbmV4dEtleV0gPSB0YXJnZXRbbmV4dEtleV07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgICAgIGlmIChzb3VyY2UgIT09IHVuZGVmaW5lZCAmJiBzb3VyY2UgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbmV4dEtleSBpbiBzb3VyY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2UuaGFzT3duUHJvcGVydHkobmV4dEtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRbbmV4dEtleV0gPSBzb3VyY2VbbmV4dEtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICB9XG4gICAgICAgIEhlbHBlcnMubWVyZ2UgPSBtZXJnZTtcbiAgICAgICAgZnVuY3Rpb24gdmFsdWVJc0RlZmluZWQodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCIgfHwgdmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBIZWxwZXJzLnZhbHVlSXNEZWZpbmVkID0gdmFsdWVJc0RlZmluZWQ7XG4gICAgICAgIGZ1bmN0aW9uIHdhcm4obWVzc2FnZSkge1xuICAgICAgICAgICAgdmFyIG9wdGlvbmFsUGFyYW1zID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIG9wdGlvbmFsUGFyYW1zW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBjb25zb2xlLndhcm4gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2Fybi5hcHBseShjb25zb2xlLCBbbWVzc2FnZV0uY29uY2F0KG9wdGlvbmFsUGFyYW1zKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgY29uc29sZSA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgY29uc29sZS5sb2cgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIFtcIldBUk5JTkc6IFwiICsgbWVzc2FnZV0uY29uY2F0KG9wdGlvbmFsUGFyYW1zKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgSGVscGVycy53YXJuID0gd2FybjtcbiAgICB9KShIZWxwZXJzIHx8IChIZWxwZXJzID0ge30pKTtcbiAgICB2YXIgSnNvbk1lbWJlck1ldGFkYXRhID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gSnNvbk1lbWJlck1ldGFkYXRhKCkge1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBKc29uTWVtYmVyTWV0YWRhdGE7XG4gICAgfSgpKTtcbiAgICB2YXIgSnNvbk9iamVjdE1ldGFkYXRhID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gSnNvbk9iamVjdE1ldGFkYXRhKCkge1xuICAgICAgICAgICAgdGhpcy5fZGF0YU1lbWJlcnMgPSB7fTtcbiAgICAgICAgICAgIHRoaXMuX2tub3duVHlwZXMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuX2tub3duVHlwZUNhY2hlID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuaXNFeHBsaWNpdGx5TWFya2VkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgSnNvbk9iamVjdE1ldGFkYXRhLmdldEpzb25PYmplY3ROYW1lID0gZnVuY3Rpb24gKHR5cGUsIGluaGVyaXRlZCkge1xuICAgICAgICAgICAgaWYgKGluaGVyaXRlZCA9PT0gdm9pZCAwKSB7IGluaGVyaXRlZCA9IHRydWU7IH1cbiAgICAgICAgICAgIHZhciBtZXRhZGF0YSA9IHRoaXMuZ2V0RnJvbVR5cGUodHlwZSwgaW5oZXJpdGVkKTtcbiAgICAgICAgICAgIGlmIChtZXRhZGF0YSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBtZXRhZGF0YS5jbGFzc05hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gSGVscGVycy5nZXRDbGFzc05hbWUodHlwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEpzb25PYmplY3RNZXRhZGF0YS5nZXRGcm9tVHlwZSA9IGZ1bmN0aW9uICh0YXJnZXQsIGluaGVyaXRlZCkge1xuICAgICAgICAgICAgaWYgKGluaGVyaXRlZCA9PT0gdm9pZCAwKSB7IGluaGVyaXRlZCA9IHRydWU7IH1cbiAgICAgICAgICAgIHZhciB0YXJnZXRQcm90b3R5cGU7XG4gICAgICAgICAgICB2YXIgbWV0YWRhdGE7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRhcmdldCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0UHJvdG90eXBlID0gdGFyZ2V0LnByb3RvdHlwZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRhcmdldFByb3RvdHlwZSA9IHRhcmdldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghdGFyZ2V0UHJvdG90eXBlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGFyZ2V0UHJvdG90eXBlLmhhc093blByb3BlcnR5KE1FVEFEQVRBX0ZJRUxEX0tFWSkpIHtcbiAgICAgICAgICAgICAgICBtZXRhZGF0YSA9IHRhcmdldFByb3RvdHlwZVtNRVRBREFUQV9GSUVMRF9LRVldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaW5oZXJpdGVkICYmIHRhcmdldFByb3RvdHlwZVtNRVRBREFUQV9GSUVMRF9LRVldKSB7XG4gICAgICAgICAgICAgICAgbWV0YWRhdGEgPSB0YXJnZXRQcm90b3R5cGVbTUVUQURBVEFfRklFTERfS0VZXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChtZXRhZGF0YSAmJiBtZXRhZGF0YS5pc0V4cGxpY2l0bHlNYXJrZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWV0YWRhdGE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgSnNvbk9iamVjdE1ldGFkYXRhLmdldEZyb21JbnN0YW5jZSA9IGZ1bmN0aW9uICh0YXJnZXQsIGluaGVyaXRlZCkge1xuICAgICAgICAgICAgaWYgKGluaGVyaXRlZCA9PT0gdm9pZCAwKSB7IGluaGVyaXRlZCA9IHRydWU7IH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEZyb21UeXBlKE9iamVjdC5nZXRQcm90b3R5cGVPZih0YXJnZXQpLCBpbmhlcml0ZWQpO1xuICAgICAgICB9O1xuICAgICAgICBKc29uT2JqZWN0TWV0YWRhdGEuZ2V0S25vd25UeXBlTmFtZUZyb21UeXBlID0gZnVuY3Rpb24gKHRhcmdldCkge1xuICAgICAgICAgICAgdmFyIG1ldGFkYXRhID0gdGhpcy5nZXRGcm9tVHlwZSh0YXJnZXQsIGZhbHNlKTtcbiAgICAgICAgICAgIGlmIChtZXRhZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBtZXRhZGF0YS5jbGFzc05hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gSGVscGVycy5nZXRDbGFzc05hbWUodGFyZ2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgSnNvbk9iamVjdE1ldGFkYXRhLmdldEtub3duVHlwZU5hbWVGcm9tSW5zdGFuY2UgPSBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgICAgICAgICB2YXIgbWV0YWRhdGEgPSB0aGlzLmdldEZyb21JbnN0YW5jZSh0YXJnZXQsIGZhbHNlKTtcbiAgICAgICAgICAgIGlmIChtZXRhZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBtZXRhZGF0YS5jbGFzc05hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gSGVscGVycy5nZXRDbGFzc05hbWUodGFyZ2V0LmNvbnN0cnVjdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEpzb25PYmplY3RNZXRhZGF0YS5wcm90b3R5cGUsIFwiZGF0YU1lbWJlcnNcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGFNZW1iZXJzO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShKc29uT2JqZWN0TWV0YWRhdGEucHJvdG90eXBlLCBcImNsYXNzTmFtZVwiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuX2NsYXNzTmFtZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2xhc3NOYW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEhlbHBlcnMuZ2V0Q2xhc3NOYW1lKHRoaXMuY2xhc3NUeXBlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jbGFzc05hbWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSnNvbk9iamVjdE1ldGFkYXRhLnByb3RvdHlwZSwgXCJrbm93blR5cGVzXCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBrbm93blR5cGVzO1xuICAgICAgICAgICAgICAgIHZhciBrbm93blR5cGVOYW1lO1xuICAgICAgICAgICAgICAgIGtub3duVHlwZXMgPSB7fTtcbiAgICAgICAgICAgICAgICB0aGlzLl9rbm93blR5cGVzLmZvckVhY2goZnVuY3Rpb24gKGtub3duVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBrbm93blR5cGVOYW1lID0gSnNvbk9iamVjdE1ldGFkYXRhLmdldEtub3duVHlwZU5hbWVGcm9tVHlwZShrbm93blR5cGUpO1xuICAgICAgICAgICAgICAgICAgICBrbm93blR5cGVzW2tub3duVHlwZU5hbWVdID0ga25vd25UeXBlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuX2tub3duVHlwZUNhY2hlID0ga25vd25UeXBlcztcbiAgICAgICAgICAgICAgICByZXR1cm4ga25vd25UeXBlcztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICBKc29uT2JqZWN0TWV0YWRhdGEucHJvdG90eXBlLnNldEtub3duVHlwZSA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fa25vd25UeXBlcy5pbmRleE9mKHR5cGUpID09PSAtMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2tub3duVHlwZXMucHVzaCh0eXBlKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9rbm93blR5cGVDYWNoZSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEpzb25PYmplY3RNZXRhZGF0YS5wcm90b3R5cGUuYWRkTWVtYmVyID0gZnVuY3Rpb24gKG1lbWJlcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHRoaXMuX2RhdGFNZW1iZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wZXJ0eUtleSkge1xuICAgICAgICAgICAgICAgIGlmIChfdGhpcy5fZGF0YU1lbWJlcnNbcHJvcGVydHlLZXldLm5hbWUgPT09IG1lbWJlci5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkEgbWVtYmVyIHdpdGggdGhlIG5hbWUgJ1wiICsgbWVtYmVyLm5hbWUgKyBcIicgYWxyZWFkeSBleGlzdHMuXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fZGF0YU1lbWJlcnNbbWVtYmVyLmtleV0gPSBtZW1iZXI7XG4gICAgICAgIH07XG4gICAgICAgIEpzb25PYmplY3RNZXRhZGF0YS5wcm90b3R5cGUuc29ydE1lbWJlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIG1lbWJlckFycmF5ID0gW107XG4gICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLl9kYXRhTWVtYmVycykuZm9yRWFjaChmdW5jdGlvbiAocHJvcGVydHlLZXkpIHtcbiAgICAgICAgICAgICAgICBtZW1iZXJBcnJheS5wdXNoKF90aGlzLl9kYXRhTWVtYmVyc1twcm9wZXJ0eUtleV0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBtZW1iZXJBcnJheSA9IG1lbWJlckFycmF5LnNvcnQodGhpcy5zb3J0TWVtYmVyc0NvbXBhcmUpO1xuICAgICAgICAgICAgdGhpcy5fZGF0YU1lbWJlcnMgPSB7fTtcbiAgICAgICAgICAgIG1lbWJlckFycmF5LmZvckVhY2goZnVuY3Rpb24gKGRhdGFNZW1iZXIpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5fZGF0YU1lbWJlcnNbZGF0YU1lbWJlci5rZXldID0gZGF0YU1lbWJlcjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBKc29uT2JqZWN0TWV0YWRhdGEucHJvdG90eXBlLnNvcnRNZW1iZXJzQ29tcGFyZSA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGEub3JkZXIgIT09IFwibnVtYmVyXCIgJiYgdHlwZW9mIGIub3JkZXIgIT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgICAgICBpZiAoYS5uYW1lIDwgYi5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoYS5uYW1lID4gYi5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBhLm9yZGVyICE9PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgYi5vcmRlciAhPT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChhLm9yZGVyIDwgYi5vcmRlcikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGEub3JkZXIgPiBiLm9yZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGEubmFtZSA8IGIubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGEubmFtZSA+IGIubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIEpzb25PYmplY3RNZXRhZGF0YTtcbiAgICB9KCkpO1xuICAgIGZ1bmN0aW9uIEpzb25PYmplY3Qob3B0aW9uc09yVGFyZ2V0KSB7XG4gICAgICAgIHZhciBvcHRpb25zO1xuICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnNPclRhcmdldCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICBvcHRpb25zID0ge307XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBvcHRpb25zID0gb3B0aW9uc09yVGFyZ2V0IHx8IHt9O1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbml0aWFsaXplciA9IG9wdGlvbnMuaW5pdGlhbGl6ZXI7XG4gICAgICAgIHZhciBzZXJpYWxpemVyID0gb3B0aW9ucy5zZXJpYWxpemVyO1xuICAgICAgICB2YXIgZGVjb3JhdG9yID0gZnVuY3Rpb24gKHRhcmdldCkge1xuICAgICAgICAgICAgdmFyIG9iamVjdE1ldGFkYXRhO1xuICAgICAgICAgICAgdmFyIHBhcmVudE1ldGFkYXRhO1xuICAgICAgICAgICAgdmFyIGk7XG4gICAgICAgICAgICBpZiAoIXRhcmdldC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkoTUVUQURBVEFfRklFTERfS0VZKSkge1xuICAgICAgICAgICAgICAgIG9iamVjdE1ldGFkYXRhID0gbmV3IEpzb25PYmplY3RNZXRhZGF0YSgpO1xuICAgICAgICAgICAgICAgIGlmIChwYXJlbnRNZXRhZGF0YSA9IHRhcmdldC5wcm90b3R5cGVbTUVUQURBVEFfRklFTERfS0VZXSkge1xuICAgICAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhwYXJlbnRNZXRhZGF0YS5kYXRhTWVtYmVycykuZm9yRWFjaChmdW5jdGlvbiAobWVtYmVyUHJvcGVydHlLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdE1ldGFkYXRhLmRhdGFNZW1iZXJzW21lbWJlclByb3BlcnR5S2V5XSA9IHBhcmVudE1ldGFkYXRhLmRhdGFNZW1iZXJzW21lbWJlclByb3BlcnR5S2V5XTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKHBhcmVudE1ldGFkYXRhLmtub3duVHlwZXMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0TWV0YWRhdGEuc2V0S25vd25UeXBlKHBhcmVudE1ldGFkYXRhLmtub3duVHlwZXNba2V5XSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LnByb3RvdHlwZSwgTUVUQURBVEFfRklFTERfS0VZLCB7XG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB3cml0YWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBvYmplY3RNZXRhZGF0YVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb2JqZWN0TWV0YWRhdGEgPSB0YXJnZXQucHJvdG90eXBlW01FVEFEQVRBX0ZJRUxEX0tFWV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvYmplY3RNZXRhZGF0YS5jbGFzc1R5cGUgPSB0YXJnZXQ7XG4gICAgICAgICAgICBvYmplY3RNZXRhZGF0YS5pc0V4cGxpY2l0bHlNYXJrZWQgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMubmFtZSkge1xuICAgICAgICAgICAgICAgIG9iamVjdE1ldGFkYXRhLmNsYXNzTmFtZSA9IG9wdGlvbnMubmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmtub3duVHlwZXMpIHtcbiAgICAgICAgICAgICAgICBpID0gMDtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmtub3duVHlwZXMuZm9yRWFjaChmdW5jdGlvbiAoa25vd25UeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGtub3duVHlwZSA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJLbm93biB0eXBlICNcIiArIGkrKyArIFwiIGlzIHVuZGVmaW5lZC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RNZXRhZGF0YS5zZXRLbm93blR5cGUoa25vd25UeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIEhlbHBlcnMuZXJyb3IobmV3IFR5cGVFcnJvcihcIkBKc29uT2JqZWN0OiBcIiArIGUubWVzc2FnZSArIFwiIChvbiAnXCIgKyBIZWxwZXJzLmdldENsYXNzTmFtZSh0YXJnZXQpICsgXCInKVwiKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBpbml0aWFsaXplciA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgb2JqZWN0TWV0YWRhdGEuaW5pdGlhbGl6ZXIgPSBpbml0aWFsaXplcjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBzZXJpYWxpemVyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICBvYmplY3RNZXRhZGF0YS5zZXJpYWxpemVyID0gc2VyaWFsaXplcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zT3JUYXJnZXQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgcmV0dXJuIGRlY29yYXRvcihvcHRpb25zT3JUYXJnZXQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGRlY29yYXRvcjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBleHBvcnRzLkpzb25PYmplY3QgPSBKc29uT2JqZWN0O1xuICAgIGZ1bmN0aW9uIGpzb25NZW1iZXJUeXBlSW5pdChtZXRhZGF0YSwgcHJvcGVydHlOYW1lLCB3YXJuQXJyYXkpIHtcbiAgICAgICAgaWYgKHdhcm5BcnJheSA9PT0gdm9pZCAwKSB7IHdhcm5BcnJheSA9IGZhbHNlOyB9XG4gICAgICAgIGlmIChtZXRhZGF0YS5lbGVtZW50cykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBtZXRhZGF0YS5lbGVtZW50cyA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgbWV0YWRhdGEuZWxlbWVudHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IG1ldGFkYXRhLmVsZW1lbnRzXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghbWV0YWRhdGEudHlwZSkge1xuICAgICAgICAgICAgICAgIG1ldGFkYXRhLnR5cGUgPSBBcnJheTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAobWV0YWRhdGEudHlwZSA9PT0gQXJyYXkpIHtcbiAgICAgICAgICAgIGlmICghbWV0YWRhdGEuZWxlbWVudHMpIHtcbiAgICAgICAgICAgICAgICBpZiAod2FybkFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgIEhlbHBlcnMud2FybihcIk5vIHZhbGlkICdlbGVtZW50cycgb3B0aW9uIHdhcyBzcGVjaWZpZWQgZm9yICdcIiArIHByb3BlcnR5TmFtZSArIFwiJy5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyB2YWxpZCAnZWxlbWVudHMnIG9wdGlvbiB3YXMgc3BlY2lmaWVkIGZvciAnXCIgKyBwcm9wZXJ0eU5hbWUgKyBcIicuXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGpzb25NZW1iZXJUeXBlSW5pdChtZXRhZGF0YS5lbGVtZW50cywgcHJvcGVydHlOYW1lICsgJ1tdJywgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBtZXRhZGF0YS50eXBlICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIHZhbGlkICd0eXBlJyBvcHRpb24gd2FzIHNwZWNpZmllZCBmb3IgJ1wiICsgcHJvcGVydHlOYW1lICsgXCInLlwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBqc29uTWVtYmVyS25vd25UeXBlcyhtZXRhZGF0YSkge1xuICAgICAgICB2YXIga25vd25UeXBlcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICBrbm93blR5cGVzLnB1c2gobWV0YWRhdGEudHlwZSk7XG4gICAgICAgIGlmIChtZXRhZGF0YS5lbGVtZW50cykge1xuICAgICAgICAgICAga25vd25UeXBlcyA9IGtub3duVHlwZXMuY29uY2F0KGpzb25NZW1iZXJLbm93blR5cGVzKG1ldGFkYXRhLmVsZW1lbnRzKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGtub3duVHlwZXM7XG4gICAgfVxuICAgIGZ1bmN0aW9uIEpzb25NZW1iZXIob3B0aW9uc09yVGFyZ2V0LCBwcm9wZXJ0eUtleSkge1xuICAgICAgICB2YXIgbWVtYmVyTWV0YWRhdGEgPSBuZXcgSnNvbk1lbWJlck1ldGFkYXRhKCk7XG4gICAgICAgIHZhciBvcHRpb25zO1xuICAgICAgICB2YXIgZGVjb3JhdG9yO1xuICAgICAgICBpZiAodHlwZW9mIHByb3BlcnR5S2V5ID09PSBcInN0cmluZ1wiIHx8IHR5cGVvZiBwcm9wZXJ0eUtleSA9PT0gXCJzeW1ib2xcIikge1xuICAgICAgICAgICAgb3B0aW9ucyA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnNPclRhcmdldCB8fCB7fTtcbiAgICAgICAgfVxuICAgICAgICBkZWNvcmF0b3IgPSBmdW5jdGlvbiAodGFyZ2V0LCBwcm9wZXJ0eUtleSkge1xuICAgICAgICAgICAgdmFyIGRlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwgcHJvcGVydHlLZXkudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICA7XG4gICAgICAgICAgICB2YXIgb2JqZWN0TWV0YWRhdGE7XG4gICAgICAgICAgICB2YXIgcGFyZW50TWV0YWRhdGE7XG4gICAgICAgICAgICB2YXIgcmVmbGVjdFR5cGU7XG4gICAgICAgICAgICB2YXIgcHJvcGVydHlOYW1lID0gSGVscGVycy5nZXRQcm9wZXJ0eURpc3BsYXlOYW1lKHRhcmdldCwgcHJvcGVydHlLZXkpO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB0YXJnZXQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJASnNvbk1lbWJlciBjYW5ub3QgYmUgdXNlZCBvbiBhIHN0YXRpYyBwcm9wZXJ0eSAoJ1wiICsgcHJvcGVydHlOYW1lICsgXCInKS5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRhcmdldFtwcm9wZXJ0eUtleV0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJASnNvbk1lbWJlciBjYW5ub3QgYmUgdXNlZCBvbiBhIG1ldGhvZCBwcm9wZXJ0eSAoJ1wiICsgcHJvcGVydHlOYW1lICsgXCInKS5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShcImVsZW1lbnRUeXBlXCIpKSB7XG4gICAgICAgICAgICAgICAgSGVscGVycy53YXJuKHByb3BlcnR5TmFtZSArIFwiOiB0aGUgJ2VsZW1lbnRUeXBlJyBvcHRpb24gaXMgZGVwcmVjYXRlZCwgdXNlICdlbGVtZW50cycgaW5zdGVhZC5cIik7XG4gICAgICAgICAgICAgICAgb3B0aW9ucy5lbGVtZW50cyA9IG9wdGlvbnMuZWxlbWVudFR5cGU7XG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuZWxlbWVudFR5cGUgPT09IEFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgIG1lbWJlck1ldGFkYXRhLmZvcmNlRW5hYmxlVHlwZUhpbnRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1lbWJlck1ldGFkYXRhID0gSGVscGVycy5hc3NpZ24obWVtYmVyTWV0YWRhdGEsIG9wdGlvbnMpO1xuICAgICAgICAgICAgbWVtYmVyTWV0YWRhdGEua2V5ID0gcHJvcGVydHlLZXkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIG1lbWJlck1ldGFkYXRhLm5hbWUgPSBvcHRpb25zLm5hbWUgfHwgcHJvcGVydHlLZXkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIGlmIChIZWxwZXJzLmlzUmVzZXJ2ZWRNZW1iZXJOYW1lKG1lbWJlck1ldGFkYXRhLm5hbWUpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQEpzb25NZW1iZXI6ICdcIiArIG1lbWJlck1ldGFkYXRhLm5hbWUgKyBcIicgaXMgYSByZXNlcnZlZCBuYW1lLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmhhc093blByb3BlcnR5KFwidHlwZVwiKSAmJiB0eXBlb2Ygb3B0aW9ucy50eXBlID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkBKc29uTWVtYmVyOiAndHlwZScgb2YgJ1wiICsgcHJvcGVydHlOYW1lICsgXCInIGlzIHVuZGVmaW5lZC5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZ2V0TWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIHJlZmxlY3RUeXBlID0gUmVmbGVjdC5nZXRNZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIHRhcmdldCwgcHJvcGVydHlLZXkpO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVmbGVjdFR5cGUgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkBKc29uTWVtYmVyOiB0eXBlIGRldGVjdGVkIGZvciAnXCIgKyBwcm9wZXJ0eU5hbWUgKyBcIicgaXMgdW5kZWZpbmVkLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFtZW1iZXJNZXRhZGF0YS50eXBlIHx8IHR5cGVvZiBtZW1iZXJNZXRhZGF0YS50eXBlICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgbWVtYmVyTWV0YWRhdGEudHlwZSA9IHJlZmxlY3RUeXBlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChtZW1iZXJNZXRhZGF0YS50eXBlICE9PSByZWZsZWN0VHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBIZWxwZXJzLndhcm4oXCJASnNvbk1lbWJlcjogJ3R5cGUnIHNwZWNpZmllZCBmb3IgJ1wiICsgcHJvcGVydHlOYW1lICsgXCInIGRvZXMgbm90IG1hdGNoIGRldGVjdGVkIHR5cGUuXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGpzb25NZW1iZXJUeXBlSW5pdChtZW1iZXJNZXRhZGF0YSwgcHJvcGVydHlOYW1lKTtcbiAgICAgICAgICAgIGlmICghdGFyZ2V0Lmhhc093blByb3BlcnR5KE1FVEFEQVRBX0ZJRUxEX0tFWSkpIHtcbiAgICAgICAgICAgICAgICBvYmplY3RNZXRhZGF0YSA9IG5ldyBKc29uT2JqZWN0TWV0YWRhdGEoKTtcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50TWV0YWRhdGEgPSB0YXJnZXRbTUVUQURBVEFfRklFTERfS0VZXSkge1xuICAgICAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhwYXJlbnRNZXRhZGF0YS5kYXRhTWVtYmVycykuZm9yRWFjaChmdW5jdGlvbiAobWVtYmVyUHJvcGVydHlLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdE1ldGFkYXRhLmRhdGFNZW1iZXJzW21lbWJlclByb3BlcnR5S2V5XSA9IHBhcmVudE1ldGFkYXRhLmRhdGFNZW1iZXJzW21lbWJlclByb3BlcnR5S2V5XTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIE1FVEFEQVRBX0ZJRUxEX0tFWSwge1xuICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgd3JpdGFibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogb2JqZWN0TWV0YWRhdGFcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG9iamVjdE1ldGFkYXRhID0gdGFyZ2V0W01FVEFEQVRBX0ZJRUxEX0tFWV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBqc29uTWVtYmVyS25vd25UeXBlcyhtZW1iZXJNZXRhZGF0YSkuZm9yRWFjaChmdW5jdGlvbiAoa25vd25UeXBlKSB7XG4gICAgICAgICAgICAgICAgb2JqZWN0TWV0YWRhdGEuc2V0S25vd25UeXBlKGtub3duVHlwZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgb2JqZWN0TWV0YWRhdGEuYWRkTWVtYmVyKG1lbWJlck1ldGFkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWVtYmVyICdcIiArIG1lbWJlck1ldGFkYXRhLm5hbWUgKyBcIicgYWxyZWFkeSBleGlzdHMgb24gJ1wiICsgSGVscGVycy5nZXRDbGFzc05hbWUob2JqZWN0TWV0YWRhdGEuY2xhc3NUeXBlKSArIFwiJy5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGlmICh0eXBlb2YgcHJvcGVydHlLZXkgPT09IFwic3RyaW5nXCIgfHwgdHlwZW9mIHByb3BlcnR5S2V5ID09PSBcInN5bWJvbFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gZGVjb3JhdG9yKG9wdGlvbnNPclRhcmdldCwgcHJvcGVydHlLZXkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGRlY29yYXRvcjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBleHBvcnRzLkpzb25NZW1iZXIgPSBKc29uTWVtYmVyO1xuICAgIHZhciBTZXJpYWxpemVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gU2VyaWFsaXplcigpIHtcbiAgICAgICAgfVxuICAgICAgICBTZXJpYWxpemVyLndyaXRlT2JqZWN0ID0gZnVuY3Rpb24gKG9iamVjdCwgc2V0dGluZ3MpIHtcbiAgICAgICAgICAgIHZhciBvYmplY3RNZXRhZGF0YSA9IEpzb25PYmplY3RNZXRhZGF0YS5nZXRGcm9tSW5zdGFuY2Uob2JqZWN0KTtcbiAgICAgICAgICAgIHZhciBPYmplY3RUeXBlO1xuICAgICAgICAgICAgaWYgKG9iamVjdE1ldGFkYXRhKSB7XG4gICAgICAgICAgICAgICAgT2JqZWN0VHlwZSA9IG9iamVjdE1ldGFkYXRhLmNsYXNzVHlwZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIE9iamVjdFR5cGUgPSBvYmplY3QuY29uc3RydWN0b3I7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcy53cml0ZVRvSnNvbk9iamVjdChvYmplY3QsIHtcbiAgICAgICAgICAgICAgICBvYmplY3RUeXBlOiBPYmplY3RUeXBlLFxuICAgICAgICAgICAgICAgIGVuYWJsZVR5cGVIaW50czogc2V0dGluZ3MuZW5hYmxlVHlwZUhpbnRzLFxuICAgICAgICAgICAgICAgIHR5cGVIaW50UHJvcGVydHlLZXk6IHNldHRpbmdzLnR5cGVIaW50UHJvcGVydHlLZXlcbiAgICAgICAgICAgIH0pLCBzZXR0aW5ncy5yZXBsYWNlcik7XG4gICAgICAgIH07XG4gICAgICAgIFNlcmlhbGl6ZXIud3JpdGVUb0pzb25PYmplY3QgPSBmdW5jdGlvbiAob2JqZWN0LCBzZXR0aW5ncykge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHZhciBqc29uO1xuICAgICAgICAgICAgdmFyIG9iamVjdE1ldGFkYXRhO1xuICAgICAgICAgICAgaWYgKG9iamVjdCA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqZWN0ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLmVtaXREZWZhdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIGpzb24gPSBIZWxwZXJzLmdldERlZmF1bHRWYWx1ZShzZXR0aW5ncy5vYmplY3RUeXBlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGpzb24gPSBvYmplY3Q7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoSGVscGVycy5pc1ByaW1pdGl2ZShvYmplY3QpIHx8IG9iamVjdCBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgICAgICAgICBqc29uID0gb2JqZWN0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAob2JqZWN0IGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgICAgICAgICBqc29uID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG4gPSBvYmplY3QubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGpzb24ucHVzaCh0aGlzLndyaXRlVG9Kc29uT2JqZWN0KG9iamVjdFtpXSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudHM6IHNldHRpbmdzLmVsZW1lbnRzID8gc2V0dGluZ3MuZWxlbWVudHMuZWxlbWVudHMgOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlVHlwZUhpbnRzOiBzZXR0aW5ncy5lbmFibGVUeXBlSGludHMsXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RUeXBlOiBzZXR0aW5ncy5lbGVtZW50cyA/IHNldHRpbmdzLmVsZW1lbnRzLnR5cGUgOiBPYmplY3QsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlVHlwZUhpbnRzOiBzZXR0aW5ncy5yZXF1aXJlVHlwZUhpbnRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZUhpbnRQcm9wZXJ0eUtleTogc2V0dGluZ3MudHlwZUhpbnRQcm9wZXJ0eUtleVxuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb2JqZWN0TWV0YWRhdGEgPSBKc29uT2JqZWN0TWV0YWRhdGEuZ2V0RnJvbUluc3RhbmNlKG9iamVjdCk7XG4gICAgICAgICAgICAgICAgaWYgKG9iamVjdE1ldGFkYXRhICYmIHR5cGVvZiBvYmplY3RNZXRhZGF0YS5zZXJpYWxpemVyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICAgICAganNvbiA9IG9iamVjdE1ldGFkYXRhLnNlcmlhbGl6ZXIob2JqZWN0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGpzb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLmVuYWJsZVR5cGVIaW50cyAmJiAoc2V0dGluZ3MucmVxdWlyZVR5cGVIaW50cyB8fCBvYmplY3QuY29uc3RydWN0b3IgIT09IHNldHRpbmdzLm9iamVjdFR5cGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBqc29uW3NldHRpbmdzLnR5cGVIaW50UHJvcGVydHlLZXldID0gSnNvbk9iamVjdE1ldGFkYXRhLmdldEtub3duVHlwZU5hbWVGcm9tSW5zdGFuY2Uob2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob2JqZWN0TWV0YWRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdE1ldGFkYXRhLnNvcnRNZW1iZXJzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhvYmplY3RNZXRhZGF0YS5kYXRhTWVtYmVycykuZm9yRWFjaChmdW5jdGlvbiAocHJvcGVydHlLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvcGVydHlNZXRhZGF0YSA9IG9iamVjdE1ldGFkYXRhLmRhdGFNZW1iZXJzW3Byb3BlcnR5S2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uW3Byb3BlcnR5TWV0YWRhdGEubmFtZV0gPSBfdGhpcy53cml0ZVRvSnNvbk9iamVjdChvYmplY3RbcHJvcGVydHlLZXldLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRzOiBwcm9wZXJ0eU1ldGFkYXRhLmVsZW1lbnRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0RGVmYXVsdDogcHJvcGVydHlNZXRhZGF0YS5lbWl0RGVmYXVsdFZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVUeXBlSGludHM6IHNldHRpbmdzLmVuYWJsZVR5cGVIaW50cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcHJvcGVydHlNZXRhZGF0YS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RUeXBlOiBwcm9wZXJ0eU1ldGFkYXRhLnR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVUeXBlSGludHM6IHNldHRpbmdzLnJlcXVpcmVUeXBlSGludHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVIaW50UHJvcGVydHlLZXk6IHNldHRpbmdzLnR5cGVIaW50UHJvcGVydHlLZXlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXMob2JqZWN0KS5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wZXJ0eUtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzb25bcHJvcGVydHlLZXldID0gX3RoaXMud3JpdGVUb0pzb25PYmplY3Qob2JqZWN0W3Byb3BlcnR5S2V5XSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVUeXBlSGludHM6IHNldHRpbmdzLmVuYWJsZVR5cGVIaW50cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0VHlwZTogT2JqZWN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlVHlwZUhpbnRzOiBzZXR0aW5ncy5yZXF1aXJlVHlwZUhpbnRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlSGludFByb3BlcnR5S2V5OiBzZXR0aW5ncy50eXBlSGludFByb3BlcnR5S2V5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBqc29uO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gU2VyaWFsaXplcjtcbiAgICB9KCkpO1xuICAgIHZhciBEZXNlcmlhbGl6ZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBEZXNlcmlhbGl6ZXIoKSB7XG4gICAgICAgIH1cbiAgICAgICAgRGVzZXJpYWxpemVyLnJlYWRPYmplY3QgPSBmdW5jdGlvbiAoanNvbiwgdHlwZSwgc2V0dGluZ3MpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZTtcbiAgICAgICAgICAgIHZhciBpbnN0YW5jZTtcbiAgICAgICAgICAgIHZhciBtZXRhZGF0YSA9IEpzb25PYmplY3RNZXRhZGF0YS5nZXRGcm9tVHlwZSh0eXBlKTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YganNvbiA9PT0gJ09iamVjdCcpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGpzb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IEpTT04ucGFyc2UoanNvbiwgc2V0dGluZ3MucmV2aXZlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIHNldHRpbmdzLm1heE9iamVjdHMgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb3VudE9iamVjdHModmFsdWUpID4gc2V0dGluZ3MubWF4T2JqZWN0cykge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJKU09OIGV4Y2VlZHMgb2JqZWN0IGNvdW50IGxpbWl0IChcIiArIHNldHRpbmdzLm1heE9iamVjdHMgKyBcIikuXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGluc3RhbmNlID0gdGhpcy5yZWFkSnNvblRvSW5zdGFuY2UodmFsdWUsIHtcbiAgICAgICAgICAgICAgICBvYmplY3RUeXBlOiB0eXBlLFxuICAgICAgICAgICAgICAgIHR5cGVIaW50UHJvcGVydHlLZXk6IHNldHRpbmdzLnR5cGVIaW50UHJvcGVydHlLZXksXG4gICAgICAgICAgICAgICAgZW5hYmxlVHlwZUhpbnRzOiBzZXR0aW5ncy5lbmFibGVUeXBlSGludHMsXG4gICAgICAgICAgICAgICAgc3RyaWN0VHlwZUhpbnRNb2RlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGtub3duVHlwZXM6IG1ldGFkYXRhID8gbWV0YWRhdGEua25vd25UeXBlcyA6IHt9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBpbnN0YW5jZTtcbiAgICAgICAgfTtcbiAgICAgICAgRGVzZXJpYWxpemVyLmNvdW50T2JqZWN0cyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHN3aXRjaCAodHlwZW9mIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcIm9iamVjdFwiOlxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKEhlbHBlcnMuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb3VudF8xID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudF8xICs9IF90aGlzLmNvdW50T2JqZWN0cyhpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvdW50XzE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnRfMiA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyh2YWx1ZSkuZm9yRWFjaChmdW5jdGlvbiAocHJvcGVydHlLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudF8yICs9IF90aGlzLmNvdW50T2JqZWN0cyh2YWx1ZVtwcm9wZXJ0eUtleV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY291bnRfMjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgXCJ1bmRlZmluZWRcIjpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIERlc2VyaWFsaXplci5yZWFkSnNvblRvSW5zdGFuY2UgPSBmdW5jdGlvbiAoanNvbiwgc2V0dGluZ3MpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgb2JqZWN0O1xuICAgICAgICAgICAgdmFyIG9iamVjdE1ldGFkYXRhO1xuICAgICAgICAgICAgdmFyIE9iamVjdFR5cGU7XG4gICAgICAgICAgICB2YXIgdHlwZUhpbnQ7XG4gICAgICAgICAgICB2YXIgdGVtcDtcbiAgICAgICAgICAgIHZhciBrbm93blR5cGVzO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBqc29uID09PSBcInVuZGVmaW5lZFwiIHx8IGpzb24gPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3MuaXNSZXF1aXJlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJNaXNzaW5nIHJlcXVpcmVkIG1lbWJlci5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoSGVscGVycy5pc1ByaW1pdGl2ZShzZXR0aW5ncy5vYmplY3RUeXBlKSkge1xuICAgICAgICAgICAgICAgIGlmIChqc29uLmNvbnN0cnVjdG9yICE9PSBzZXR0aW5ncy5vYmplY3RUeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBleHBlY3RlZFR5cGVOYW1lID0gSGVscGVycy5nZXRDbGFzc05hbWUoc2V0dGluZ3Mub2JqZWN0VHlwZSkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZvdW5kVHlwZU5hbWUgPSBIZWxwZXJzLmdldENsYXNzTmFtZShqc29uLmNvbnN0cnVjdG9yKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRXhwZWN0ZWQgdmFsdWUgdG8gYmUgb2YgdHlwZSAnXCIgKyBleHBlY3RlZFR5cGVOYW1lICsgXCInLCBnb3QgJ1wiICsgZm91bmRUeXBlTmFtZSArIFwiJy5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG9iamVjdCA9IGpzb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzZXR0aW5ncy5vYmplY3RUeXBlID09PSBBcnJheSkge1xuICAgICAgICAgICAgICAgIGlmICghSGVscGVycy5pc0FycmF5KGpzb24pKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJFeHBlY3RlZCB2YWx1ZSB0byBiZSBvZiB0eXBlICdBcnJheScsIGdvdCAnXCIgKyBIZWxwZXJzLmdldENsYXNzTmFtZShqc29uLmNvbnN0cnVjdG9yKSArIFwiJy5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG9iamVjdCA9IFtdO1xuICAgICAgICAgICAgICAgIGpzb24uZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICBvYmplY3QucHVzaChfdGhpcy5yZWFkSnNvblRvSW5zdGFuY2UoZWxlbWVudCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudHM6IHNldHRpbmdzLmVsZW1lbnRzID8gc2V0dGluZ3MuZWxlbWVudHMuZWxlbWVudHMgOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlVHlwZUhpbnRzOiBzZXR0aW5ncy5lbmFibGVUeXBlSGludHMsXG4gICAgICAgICAgICAgICAgICAgICAgICBrbm93blR5cGVzOiBzZXR0aW5ncy5rbm93blR5cGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0VHlwZTogc2V0dGluZ3MuZWxlbWVudHMgPyBzZXR0aW5ncy5lbGVtZW50cy50eXBlIDogZWxlbWVudC5jb25zdHJ1Y3RvcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVUeXBlSGludHM6IHNldHRpbmdzLnJlcXVpcmVUeXBlSGludHMsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJpY3RUeXBlSGludE1vZGU6IHNldHRpbmdzLnN0cmljdFR5cGVIaW50TW9kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVIaW50UHJvcGVydHlLZXk6IHNldHRpbmdzLnR5cGVIaW50UHJvcGVydHlLZXlcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2V0dGluZ3Mub2JqZWN0VHlwZSA9PT0gRGF0ZSkge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YganNvbiA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICBvYmplY3QgPSBuZXcgRGF0ZShqc29uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoanNvbiBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0ID0ganNvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJFeHBlY3RlZCB2YWx1ZSB0byBiZSBvZiB0eXBlICdzdHJpbmcnLCBnb3QgJ1wiICsgdHlwZW9mIGpzb24gKyBcIicuXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHR5cGVIaW50ID0ganNvbltzZXR0aW5ncy50eXBlSGludFByb3BlcnR5S2V5XTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZUhpbnQgJiYgc2V0dGluZ3MuZW5hYmxlVHlwZUhpbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdHlwZUhpbnQgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJUeXBlLWhpbnQgKFwiICsgc2V0dGluZ3MudHlwZUhpbnRQcm9wZXJ0eUtleSArIFwiKSBtdXN0IGJlIGEgc3RyaW5nLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIXNldHRpbmdzLmtub3duVHlwZXNbdHlwZUhpbnRdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCInXCIgKyB0eXBlSGludCArIFwiJyBpcyBub3QgYSBrbm93biB0eXBlLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3Muc3RyaWN0VHlwZUhpbnRNb2RlICYmICFIZWxwZXJzLmlzU3VidHlwZU9mKHNldHRpbmdzLmtub3duVHlwZXNbdHlwZUhpbnRdLCBzZXR0aW5ncy5vYmplY3RUeXBlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiJ1wiICsgdHlwZUhpbnQgKyBcIicgaXMgbm90IGEgc3VidHlwZSBvZiAnXCIgKyBIZWxwZXJzLmdldENsYXNzTmFtZShzZXR0aW5ncy5vYmplY3RUeXBlKSArIFwiJy5cIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0VHlwZSA9IHNldHRpbmdzLmtub3duVHlwZXNbdHlwZUhpbnRdO1xuICAgICAgICAgICAgICAgICAgICBvYmplY3RNZXRhZGF0YSA9IEpzb25PYmplY3RNZXRhZGF0YS5nZXRGcm9tVHlwZShPYmplY3RUeXBlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5lbmFibGVUeXBlSGludHMgJiYgc2V0dGluZ3MucmVxdWlyZVR5cGVIaW50cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyByZXF1aXJlZCB0eXBlLWhpbnQuXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIE9iamVjdFR5cGUgPSBzZXR0aW5ncy5vYmplY3RUeXBlO1xuICAgICAgICAgICAgICAgICAgICBvYmplY3RNZXRhZGF0YSA9IEpzb25PYmplY3RNZXRhZGF0YS5nZXRGcm9tVHlwZShzZXR0aW5ncy5vYmplY3RUeXBlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG9iamVjdE1ldGFkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb2JqZWN0TWV0YWRhdGEuaW5pdGlhbGl6ZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0ID0gb2JqZWN0TWV0YWRhdGEuaW5pdGlhbGl6ZXIoanNvbikgfHwgbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdE1ldGFkYXRhLnNvcnRNZW1iZXJzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QgPSBuZXcgT2JqZWN0VHlwZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXMob2JqZWN0TWV0YWRhdGEuZGF0YU1lbWJlcnMpLmZvckVhY2goZnVuY3Rpb24gKHByb3BlcnR5S2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb3BlcnR5TWV0YWRhdGEgPSBvYmplY3RNZXRhZGF0YS5kYXRhTWVtYmVyc1twcm9wZXJ0eUtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcCA9IF90aGlzLnJlYWRKc29uVG9JbnN0YW5jZShqc29uW3Byb3BlcnR5TWV0YWRhdGEubmFtZV0sIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudHM6IHByb3BlcnR5TWV0YWRhdGEuZWxlbWVudHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZVR5cGVIaW50czogc2V0dGluZ3MuZW5hYmxlVHlwZUhpbnRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1JlcXVpcmVkOiBwcm9wZXJ0eU1ldGFkYXRhLmlzUmVxdWlyZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtub3duVHlwZXM6IEhlbHBlcnMubWVyZ2Uoc2V0dGluZ3Mua25vd25UeXBlcywgb2JqZWN0TWV0YWRhdGEua25vd25UeXBlcyB8fCB7fSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdFR5cGU6IHByb3BlcnR5TWV0YWRhdGEudHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZVR5cGVIaW50czogc2V0dGluZ3MucmVxdWlyZVR5cGVIaW50cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyaWN0VHlwZUhpbnRNb2RlOiBzZXR0aW5ncy5zdHJpY3RUeXBlSGludE1vZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVIaW50UHJvcGVydHlLZXk6IHNldHRpbmdzLnR5cGVIaW50UHJvcGVydHlLZXlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoSGVscGVycy52YWx1ZUlzRGVmaW5lZCh0ZW1wKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RbcHJvcGVydHlLZXldID0gdGVtcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0ID0ge307XG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGpzb24pLmZvckVhY2goZnVuY3Rpb24gKHByb3BlcnR5S2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoanNvbltwcm9wZXJ0eUtleV0gJiYgcHJvcGVydHlLZXkgIT09IHNldHRpbmdzLnR5cGVIaW50UHJvcGVydHlLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RbcHJvcGVydHlLZXldID0gX3RoaXMucmVhZEpzb25Ub0luc3RhbmNlKGpzb25bcHJvcGVydHlLZXldLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZVR5cGVIaW50czogc2V0dGluZ3MuZW5hYmxlVHlwZUhpbnRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrbm93blR5cGVzOiBzZXR0aW5ncy5rbm93blR5cGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RUeXBlOiBqc29uW3Byb3BlcnR5S2V5XS5jb25zdHJ1Y3RvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZVR5cGVIaW50czogc2V0dGluZ3MucmVxdWlyZVR5cGVIaW50cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZUhpbnRQcm9wZXJ0eUtleTogc2V0dGluZ3MudHlwZUhpbnRQcm9wZXJ0eUtleVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gb2JqZWN0O1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gRGVzZXJpYWxpemVyO1xuICAgIH0oKSk7XG4gICAgdmFyIGNvbmZpZ1NldHRpbmdzID0ge1xuICAgICAgICBlbmFibGVUeXBlSGludHM6IHRydWUsXG4gICAgICAgIHR5cGVIaW50UHJvcGVydHlLZXk6IFwiX190eXBlXCJcbiAgICB9O1xuICAgIHZhciBUeXBlZEpTT04gPSB7XG4gICAgICAgIGNvbmZpZzogZnVuY3Rpb24gKHNldHRpbmdzKSB7XG4gICAgICAgICAgICBjb25maWdTZXR0aW5ncyA9IEhlbHBlcnMubWVyZ2UoY29uZmlnU2V0dGluZ3MsIHNldHRpbmdzKTtcbiAgICAgICAgfSxcbiAgICAgICAgc3RyaW5naWZ5OiBmdW5jdGlvbiAodmFsdWUsIHNldHRpbmdzKSB7XG4gICAgICAgICAgICByZXR1cm4gU2VyaWFsaXplci53cml0ZU9iamVjdCh2YWx1ZSwgSGVscGVycy5tZXJnZShjb25maWdTZXR0aW5ncywgc2V0dGluZ3MgfHwge30pKTtcbiAgICAgICAgfSxcbiAgICAgICAgcGFyc2U6IGZ1bmN0aW9uIChqc29uLCB0eXBlLCBzZXR0aW5ncykge1xuICAgICAgICAgICAgaWYgKEpzb25PYmplY3RNZXRhZGF0YS5nZXRGcm9tVHlwZSh0eXBlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBEZXNlcmlhbGl6ZXIucmVhZE9iamVjdChqc29uLCB0eXBlLCBIZWxwZXJzLm1lcmdlKGNvbmZpZ1NldHRpbmdzLCBzZXR0aW5ncyB8fCB7fSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UuYXBwbHkoSlNPTiwgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgZXhwb3J0cy5UeXBlZEpTT04gPSBUeXBlZEpTT047XG59KTtcblxufSx7fV19LHt9LFs3XSkoNylcbn0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3BhcnNlci9idW5kbGUtcGFyc2VyLmpzIl0sInNvdXJjZVJvb3QiOiIifQ==